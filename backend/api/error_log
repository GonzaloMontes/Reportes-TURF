[02-Oct-2025 12:41:53 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 12:41:53 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[02-Oct-2025 12:41:53 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 12:41:53 UTC] DEBUG getListaTickets - Summary raw: {"total_vendido":639780,"total_ganadores":181030.4999847412,"total_pagados":79787.19999694824,"total_devoluciones":0}
[02-Oct-2025 12:41:53 UTC] DEBUG getListaTickets - Resultado final: {"total_vendido":639780,"total_ganadores":181030.4999847412,"total_pagados":79787.19999694824,"total_devoluciones":0,"ganancia":559992.8000030518}
[02-Oct-2025 12:41:53 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-02"}
[02-Oct-2025 12:41:54 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 12:41:54 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[02-Oct-2025 12:41:54 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 12:41:54 UTC] DEBUG - Consulta SQL ejecutada: 
            SELECT 
                cr.fecha,
                cr.nro_caballo,
                COALESCE(SUM(dt.total_apostado), 0) as total_apostado,
                COALESCE(SUM(CASE WHEN crd.devolucion = 0 THEN dt.total_apostado ELSE 0 END), 0) as monto_a_devolver,
                COALESCE(SUM(CASE WHEN crd.devolucion = 1 THEN dt.total_apostado ELSE 0 END), 0) as monto_devuelto,
                CASE 
                    WHEN SUM(dt.total_apostado) IS NULL OR SUM(dt.total_apostado) = 0 THEN 'Sin Apuestas'
                    WHEN SUM(CASE WHEN crd.devolucion = 0 THEN 1 ELSE 0 END) > 0 
                         AND SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Parcial'
                    WHEN SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Devuelto'
                    ELSE 'Pendiente'
                END as estado_devolucion
            FROM 
                tbl_caballos_retirados_ultimo_momento cr
            LEFT JOIN 
                tbl_caballos_retirados_um_detalle crd ON cr.id_caballo_retirado_ultimo_momento = crd.id_caballo_retirado_ultimo_momento
            LEFT JOIN 
                tbl_detalle_tickets dt ON crd.id_detalle_ticket = dt.id_detalle_ticket
            WHERE 1=1
            AND cr.fecha >= :fecha_desde AND cr.fecha <= :fecha_hasta
            GROUP BY
                cr.fecha, cr.nro_caballo, cr.id_carrera
            ORDER BY
                cr.fecha DESC, cr.nro_caballo ASC
            LIMIT :limit OFFSET :offset
        
[02-Oct-2025 12:41:54 UTC] DEBUG - Parámetros: {":fecha_desde":"2025-05-01",":fecha_hasta":"2025-10-02",":limit":100,":offset":0}
[02-Oct-2025 12:41:54 UTC] DEBUG - Registros obtenidos: 16 de 16 totales
[02-Oct-2025 12:41:54 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[02-Oct-2025 12:41:54 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[02-Oct-2025 12:41:54 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[02-Oct-2025 12:41:54 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[02-Oct-2025 12:41:54 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[02-Oct-2025 12:41:54 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[02-Oct-2025 12:41:54 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[02-Oct-2025 12:41:54 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[02-Oct-2025 12:41:54 UTC] DEBUG formatearFecha - Input: '2025-07-15' (tipo: string)
[02-Oct-2025 12:41:54 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-15 -> 15/07/2025
[02-Oct-2025 12:41:54 UTC] DEBUG formatearFecha - Input: '2025-07-14' (tipo: string)
[02-Oct-2025 12:41:54 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-14 -> 14/07/2025
[02-Oct-2025 12:41:54 UTC] DEBUG formatearFecha - Input: '2025-07-11' (tipo: string)
[02-Oct-2025 12:41:54 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-11 -> 11/07/2025
[02-Oct-2025 12:41:54 UTC] DEBUG formatearFecha - Input: '2025-07-10' (tipo: string)
[02-Oct-2025 12:41:54 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-10 -> 10/07/2025
[02-Oct-2025 12:41:54 UTC] DEBUG formatearFecha - Input: '2025-07-08' (tipo: string)
[02-Oct-2025 12:41:54 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-08 -> 08/07/2025
[02-Oct-2025 12:41:54 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[02-Oct-2025 12:41:54 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[02-Oct-2025 12:41:54 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[02-Oct-2025 12:41:54 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[02-Oct-2025 12:41:54 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[02-Oct-2025 12:41:54 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[02-Oct-2025 12:41:54 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[02-Oct-2025 12:41:54 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[02-Oct-2025 12:41:54 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[02-Oct-2025 12:41:54 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[02-Oct-2025 12:41:54 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[02-Oct-2025 12:41:54 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[02-Oct-2025 12:41:54 UTC] DEBUG formatearFecha - Input: '2025-06-27' (tipo: string)
[02-Oct-2025 12:41:54 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-06-27 -> 27/06/2025
[02-Oct-2025 12:41:54 UTC] DEBUG getCaballosRetirados - Totals raw: {"total_records":16,"total_a_devolver":45310,"total_devuelto":5300,"total_general":50610}
[02-Oct-2025 12:41:54 UTC] DEBUG getCaballosRetirados - Resultado final: {"data":[{"fecha":"29\/07\/2025","nro_caballo":1,"total_apostado":2200,"monto_a_devolver":2200,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"29\/07\/2025","nro_caballo":6,"total_apostado":2000,"monto_a_devolver":2000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"17\/07\/2025","nro_caballo":1,"total_apostado":16000,"monto_a_devolver":16000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"17\/07\/2025","nro_caballo":8,"total_apostado":8000,"monto_a_devolver":8000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"15\/07\/2025","nro_caballo":1,"total_apostado":4000,"monto_a_devolver":4000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"14\/07\/2025","nro_caballo":4,"total_apostado":13000,"monto_a_devolver":13000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"11\/07\/2025","nro_caballo":4,"total_apostado":4000,"monto_a_devolver":0,"monto_devuelto":4000,"estado_devolucion":"Devuelto"},{"fecha":"10\/07\/2025","nro_caballo":7,"total_apostado":800,"monto_a_devolver":0,"monto_devuelto":800,"estado_devolucion":"Devuelto"},{"fecha":"08\/07\/2025","nro_caballo":7,"total_apostado":410,"monto_a_devolver":110,"monto_devuelto":300,"estado_devolucion":"Parcial"},{"fecha":"04\/07\/2025","nro_caballo":1,"total_apostado":100,"monto_a_devolver":0,"monto_devuelto":100,"estado_devolucion":"Devuelto"},{"fecha":"04\/07\/2025","nro_caballo":6,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"02\/07\/2025","nro_caballo":4,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"02\/07\/2025","nro_caballo":8,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"01\/07\/2025","nro_caballo":1,"total_apostado":100,"monto_a_devolver":0,"monto_devuelto":100,"estado_devolucion":"Devuelto"},{"fecha":"01\/07\/2025","nro_caballo":4,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"27\/06\/2025","nro_caballo":12,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"}],"total_records":16,"total_general":50610,"total_a_devolver":45310,"total_devuelto":5300}
[02-Oct-2025 12:41:55 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 12:41:55 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[02-Oct-2025 12:41:55 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 12:41:55 UTC] DEBUG getListaTickets - Summary raw: {"total_vendido":639780,"total_ganadores":181030.4999847412,"total_pagados":79787.19999694824,"total_devoluciones":0}
[02-Oct-2025 12:41:55 UTC] DEBUG getListaTickets - Resultado final: {"total_vendido":639780,"total_ganadores":181030.4999847412,"total_pagados":79787.19999694824,"total_devoluciones":0,"ganancia":559992.8000030518}
[02-Oct-2025 12:41:55 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-02"}
[02-Oct-2025 12:41:56 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 12:41:56 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[02-Oct-2025 12:41:56 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 12:41:56 UTC] DEBUG Tickets Anulados - Filtros recibidos: {"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-02"}
[02-Oct-2025 12:41:56 UTC] DEBUG Tickets Anulados - WHERE construido: AND STR_TO_DATE(t.fecha, '%d/%m/%Y') >= STR_TO_DATE(:fecha_desde, '%Y-%m-%d') AND STR_TO_DATE(t.fecha, '%d/%m/%Y') <= STR_TO_DATE(:fecha_hasta, '%Y-%m-%d')
[02-Oct-2025 12:41:56 UTC] DEBUG Tickets Anulados - Registros obtenidos: 12
[02-Oct-2025 12:41:56 UTC] DEBUG Tickets Anulados - Primer registro: {"nro_ticket":133,"fecha":"31\/07\/2025","hora":"10:01:20","nombre_usuario":"Agencia 24","nombre_agencia":"Morteros","total_apostado":10000}
[02-Oct-2025 12:41:56 UTC] DEBUG formatearFecha - Input: '31/07/2025' (tipo: string)
[02-Oct-2025 12:41:56 UTC] DEBUG formatearFecha - Ya en formato correcto: 31/07/2025
[02-Oct-2025 12:41:56 UTC] DEBUG formatearFecha - Input: '06/07/2025' (tipo: string)
[02-Oct-2025 12:41:56 UTC] DEBUG formatearFecha - Ya en formato correcto: 06/07/2025
[02-Oct-2025 12:41:56 UTC] DEBUG formatearFecha - Input: '05/07/2025' (tipo: string)
[02-Oct-2025 12:41:56 UTC] DEBUG formatearFecha - Ya en formato correcto: 05/07/2025
[02-Oct-2025 12:41:56 UTC] DEBUG formatearFecha - Input: '04/07/2025' (tipo: string)
[02-Oct-2025 12:41:56 UTC] DEBUG formatearFecha - Ya en formato correcto: 04/07/2025
[02-Oct-2025 12:41:56 UTC] DEBUG formatearFecha - Input: '02/07/2025' (tipo: string)
[02-Oct-2025 12:41:56 UTC] DEBUG formatearFecha - Ya en formato correcto: 02/07/2025
[02-Oct-2025 12:41:56 UTC] DEBUG formatearFecha - Input: '02/07/2025' (tipo: string)
[02-Oct-2025 12:41:56 UTC] DEBUG formatearFecha - Ya en formato correcto: 02/07/2025
[02-Oct-2025 12:41:56 UTC] DEBUG formatearFecha - Input: '02/07/2025' (tipo: string)
[02-Oct-2025 12:41:56 UTC] DEBUG formatearFecha - Ya en formato correcto: 02/07/2025
[02-Oct-2025 12:41:56 UTC] DEBUG formatearFecha - Input: '02/07/2025' (tipo: string)
[02-Oct-2025 12:41:56 UTC] DEBUG formatearFecha - Ya en formato correcto: 02/07/2025
[02-Oct-2025 12:41:56 UTC] DEBUG formatearFecha - Input: '01/07/2025' (tipo: string)
[02-Oct-2025 12:41:56 UTC] DEBUG formatearFecha - Ya en formato correcto: 01/07/2025
[02-Oct-2025 12:41:56 UTC] DEBUG formatearFecha - Input: '01/07/2025' (tipo: string)
[02-Oct-2025 12:41:56 UTC] DEBUG formatearFecha - Ya en formato correcto: 01/07/2025
[02-Oct-2025 12:41:56 UTC] DEBUG formatearFecha - Input: '01/07/2025' (tipo: string)
[02-Oct-2025 12:41:56 UTC] DEBUG formatearFecha - Ya en formato correcto: 01/07/2025
[02-Oct-2025 12:41:56 UTC] DEBUG formatearFecha - Input: '30/06/2025' (tipo: string)
[02-Oct-2025 12:41:56 UTC] DEBUG formatearFecha - Ya en formato correcto: 30/06/2025
[02-Oct-2025 12:43:34 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 12:43:34 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[02-Oct-2025 12:43:34 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 12:43:34 UTC] DEBUG Carreras - Filtros recibidos: {"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-02"}
[02-Oct-2025 12:43:34 UTC] DEBUG Carreras - WHERE SQL: WHERE STR_TO_DATE(c.fecha, '%d/%m/%Y') >= STR_TO_DATE(:fecha_desde, '%Y-%m-%d') AND STR_TO_DATE(c.fecha, '%d/%m/%Y') <= STR_TO_DATE(:fecha_hasta, '%Y-%m-%d')
[02-Oct-2025 12:43:34 UTC] DEBUG Carreras - Parámetros: {":fecha_desde":"2025-05-01",":fecha_hasta":"2025-10-02"}
[02-Oct-2025 12:43:34 UTC] DEBUG Carreras - Registros obtenidos: 52
[02-Oct-2025 12:43:34 UTC] DEBUG Carreras - Primer registro: {"numero_carrera":1,"fecha":"31\/07\/2025","nombre_hipodromo":"San Isidro","estado_carrera":"Apuesta","carrera_interna_id":52}
[02-Oct-2025 12:43:36 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 12:43:36 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[02-Oct-2025 12:43:36 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 12:43:36 UTC] DEBUG getListaTickets - Summary raw: {"total_vendido":639780,"total_ganadores":181030.4999847412,"total_pagados":79787.19999694824,"total_devoluciones":0}
[02-Oct-2025 12:43:36 UTC] DEBUG getListaTickets - Resultado final: {"total_vendido":639780,"total_ganadores":181030.4999847412,"total_pagados":79787.19999694824,"total_devoluciones":0,"ganancia":559992.8000030518}
[02-Oct-2025 12:43:36 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-02"}
[02-Oct-2025 12:52:34 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 12:52:34 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[02-Oct-2025 12:52:34 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 12:52:34 UTC] DEBUG Tickets Anulados - Filtros recibidos: {"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-02"}
[02-Oct-2025 12:52:34 UTC] DEBUG Tickets Anulados - WHERE construido: AND STR_TO_DATE(t.fecha, '%d/%m/%Y') >= STR_TO_DATE(:fecha_desde, '%Y-%m-%d') AND STR_TO_DATE(t.fecha, '%d/%m/%Y') <= STR_TO_DATE(:fecha_hasta, '%Y-%m-%d')
[02-Oct-2025 12:52:35 UTC] DEBUG Tickets Anulados - Registros obtenidos: 12
[02-Oct-2025 12:52:35 UTC] DEBUG Tickets Anulados - Primer registro: {"nro_ticket":133,"fecha":"31\/07\/2025","hora":"10:01:20","nombre_usuario":"Agencia 24","nombre_agencia":"Morteros","total_apostado":10000}
[02-Oct-2025 12:52:35 UTC] DEBUG formatearFecha - Input: '31/07/2025' (tipo: string)
[02-Oct-2025 12:52:35 UTC] DEBUG formatearFecha - Ya en formato correcto: 31/07/2025
[02-Oct-2025 12:52:35 UTC] DEBUG formatearFecha - Input: '06/07/2025' (tipo: string)
[02-Oct-2025 12:52:35 UTC] DEBUG formatearFecha - Ya en formato correcto: 06/07/2025
[02-Oct-2025 12:52:35 UTC] DEBUG formatearFecha - Input: '05/07/2025' (tipo: string)
[02-Oct-2025 12:52:35 UTC] DEBUG formatearFecha - Ya en formato correcto: 05/07/2025
[02-Oct-2025 12:52:35 UTC] DEBUG formatearFecha - Input: '04/07/2025' (tipo: string)
[02-Oct-2025 12:52:35 UTC] DEBUG formatearFecha - Ya en formato correcto: 04/07/2025
[02-Oct-2025 12:52:35 UTC] DEBUG formatearFecha - Input: '02/07/2025' (tipo: string)
[02-Oct-2025 12:52:35 UTC] DEBUG formatearFecha - Ya en formato correcto: 02/07/2025
[02-Oct-2025 12:52:35 UTC] DEBUG formatearFecha - Input: '02/07/2025' (tipo: string)
[02-Oct-2025 12:52:35 UTC] DEBUG formatearFecha - Ya en formato correcto: 02/07/2025
[02-Oct-2025 12:52:35 UTC] DEBUG formatearFecha - Input: '02/07/2025' (tipo: string)
[02-Oct-2025 12:52:35 UTC] DEBUG formatearFecha - Ya en formato correcto: 02/07/2025
[02-Oct-2025 12:52:35 UTC] DEBUG formatearFecha - Input: '02/07/2025' (tipo: string)
[02-Oct-2025 12:52:35 UTC] DEBUG formatearFecha - Ya en formato correcto: 02/07/2025
[02-Oct-2025 12:52:35 UTC] DEBUG formatearFecha - Input: '01/07/2025' (tipo: string)
[02-Oct-2025 12:52:35 UTC] DEBUG formatearFecha - Ya en formato correcto: 01/07/2025
[02-Oct-2025 12:52:35 UTC] DEBUG formatearFecha - Input: '01/07/2025' (tipo: string)
[02-Oct-2025 12:52:35 UTC] DEBUG formatearFecha - Ya en formato correcto: 01/07/2025
[02-Oct-2025 12:52:35 UTC] DEBUG formatearFecha - Input: '01/07/2025' (tipo: string)
[02-Oct-2025 12:52:35 UTC] DEBUG formatearFecha - Ya en formato correcto: 01/07/2025
[02-Oct-2025 12:52:35 UTC] DEBUG formatearFecha - Input: '30/06/2025' (tipo: string)
[02-Oct-2025 12:52:35 UTC] DEBUG formatearFecha - Ya en formato correcto: 30/06/2025
[02-Oct-2025 12:56:05 UTC] PHP Fatal error:  Uncaught Error: Call to undefined method TurfReports\Controllers\AuthController::verify() in /var/www/html/Routes/api.php:121
Stack trace:
#0 {main}
  thrown in /var/www/html/Routes/api.php on line 121
[02-Oct-2025 12:56:06 UTC] DEBUG Login - Usuario encontrado: SÍ
[02-Oct-2025 12:56:06 UTC] DEBUG Login - Login BD: carreras2024
[02-Oct-2025 12:56:06 UTC] DEBUG Login - Login enviado: carreras2024
[02-Oct-2025 12:56:06 UTC] DEBUG Login - Contraseña BD: 0192023a7bbd73250516f069df18b500
[02-Oct-2025 12:56:06 UTC] DEBUG Login - Contraseña enviada: admin123
[02-Oct-2025 12:56:06 UTC] DEBUG Login - Contraseña MD5: 0192023a7bbd73250516f069df18b500
[02-Oct-2025 12:56:06 UTC] DEBUG Login - Coinciden MD5: SÍ
[02-Oct-2025 12:56:06 UTC] DEBUG Login - id_perfil: 1 (tipo: integer)
[02-Oct-2025 12:56:06 UTC] DEBUG Login - Rol asignado: admin
[02-Oct-2025 12:56:06 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 12:56:06 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[02-Oct-2025 12:56:06 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 12:56:11 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 12:56:11 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[02-Oct-2025 12:56:11 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 12:56:11 UTC] Acceso a reporte: usuario=1, reporte=informe-por-agencia, filtros={"fecha_desde":"2025-09-02","fecha_hasta":"2025-10-02"}
[02-Oct-2025 12:56:14 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 12:56:14 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[02-Oct-2025 12:56:14 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 12:56:14 UTC] Acceso a reporte: usuario=1, reporte=informe-por-agencia, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-02"}
[02-Oct-2025 12:56:20 UTC] DEBUG Login - Usuario encontrado: SÍ
[02-Oct-2025 12:56:20 UTC] DEBUG Login - Login BD: sergio
[02-Oct-2025 12:56:20 UTC] DEBUG Login - Login enviado: sergio
[02-Oct-2025 12:56:20 UTC] DEBUG Login - Contraseña BD: b8edd54d3a1d0c046a61491b8c9dd91a
[02-Oct-2025 12:56:20 UTC] DEBUG Login - Contraseña enviada: agencia1234
[02-Oct-2025 12:56:20 UTC] DEBUG Login - Contraseña MD5: b8edd54d3a1d0c046a61491b8c9dd91a
[02-Oct-2025 12:56:20 UTC] DEBUG Login - Coinciden MD5: SÍ
[02-Oct-2025 12:56:20 UTC] DEBUG Login - id_perfil: 3 (tipo: integer)
[02-Oct-2025 12:56:20 UTC] DEBUG Login - Rol asignado: agencia
[02-Oct-2025 12:59:04 UTC] PHP Fatal error:  Uncaught Error: Call to undefined method TurfReports\Controllers\AuthController::verify() in /var/www/html/Routes/api.php:121
Stack trace:
#0 {main}
  thrown in /var/www/html/Routes/api.php on line 121
[02-Oct-2025 12:59:04 UTC] PHP Fatal error:  Uncaught Error: Call to undefined method TurfReports\Controllers\AuthController::verify() in /var/www/html/Routes/api.php:121
Stack trace:
#0 {main}
  thrown in /var/www/html/Routes/api.php on line 121
[02-Oct-2025 12:59:07 UTC] DEBUG Login - Usuario encontrado: SÍ
[02-Oct-2025 12:59:07 UTC] DEBUG Login - Login BD: carreras2024
[02-Oct-2025 12:59:07 UTC] DEBUG Login - Login enviado: carreras2024
[02-Oct-2025 12:59:07 UTC] DEBUG Login - Contraseña BD: 0192023a7bbd73250516f069df18b500
[02-Oct-2025 12:59:07 UTC] DEBUG Login - Contraseña enviada: admin123
[02-Oct-2025 12:59:07 UTC] DEBUG Login - Contraseña MD5: 0192023a7bbd73250516f069df18b500
[02-Oct-2025 12:59:07 UTC] DEBUG Login - Coinciden MD5: SÍ
[02-Oct-2025 12:59:07 UTC] DEBUG Login - id_perfil: 1 (tipo: integer)
[02-Oct-2025 12:59:07 UTC] DEBUG Login - Rol asignado: admin
[02-Oct-2025 12:59:07 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 12:59:07 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[02-Oct-2025 12:59:07 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 12:59:09 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 12:59:09 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[02-Oct-2025 12:59:09 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 12:59:09 UTC] DEBUG getListaTickets - Summary raw: {"total_vendido":null,"total_ganadores":null,"total_pagados":null,"total_devoluciones":0}
[02-Oct-2025 12:59:09 UTC] DEBUG getListaTickets - Resultado final: {"total_vendido":0,"total_ganadores":0,"total_pagados":0,"total_devoluciones":0,"ganancia":0}
[02-Oct-2025 12:59:09 UTC] DEBUG - Consulta SQL ejecutada: 
            SELECT 
                cr.fecha,
                cr.nro_caballo,
                COALESCE(SUM(dt.total_apostado), 0) as total_apostado,
                COALESCE(SUM(CASE WHEN crd.devolucion = 0 THEN dt.total_apostado ELSE 0 END), 0) as monto_a_devolver,
                COALESCE(SUM(CASE WHEN crd.devolucion = 1 THEN dt.total_apostado ELSE 0 END), 0) as monto_devuelto,
                CASE 
                    WHEN SUM(dt.total_apostado) IS NULL OR SUM(dt.total_apostado) = 0 THEN 'Sin Apuestas'
                    WHEN SUM(CASE WHEN crd.devolucion = 0 THEN 1 ELSE 0 END) > 0 
                         AND SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Parcial'
                    WHEN SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Devuelto'
                    ELSE 'Pendiente'
                END as estado_devolucion
            FROM 
                tbl_caballos_retirados_ultimo_momento cr
            LEFT JOIN 
                tbl_caballos_retirados_um_detalle crd ON cr.id_caballo_retirado_ultimo_momento = crd.id_caballo_retirado_ultimo_momento
            LEFT JOIN 
                tbl_detalle_tickets dt ON crd.id_detalle_ticket = dt.id_detalle_ticket
            WHERE 1=1
            AND cr.fecha >= :fecha_desde AND cr.fecha <= :fecha_hasta
            GROUP BY
                cr.fecha, cr.nro_caballo, cr.id_carrera
            ORDER BY
                cr.fecha DESC, cr.nro_caballo ASC
            LIMIT :limit OFFSET :offset
        
[02-Oct-2025 12:59:09 UTC] DEBUG - Parámetros: {":fecha_desde":"2025-09-02",":fecha_hasta":"2025-10-02",":limit":100,":offset":0}
[02-Oct-2025 12:59:09 UTC] DEBUG - Registros obtenidos: 0 de 0 totales
[02-Oct-2025 12:59:09 UTC] DEBUG getCaballosRetirados - Totals raw: {"total_records":0,"total_a_devolver":0,"total_devuelto":0,"total_general":0}
[02-Oct-2025 12:59:09 UTC] DEBUG getCaballosRetirados - Resultado final: {"data":[],"total_records":0,"total_general":0,"total_a_devolver":0,"total_devuelto":0}
[02-Oct-2025 12:59:09 UTC] Acceso a reporte: usuario=1, reporte=informe_parte_venta, filtros={"fecha_desde":"2025-09-02","fecha_hasta":"2025-10-02"}
[02-Oct-2025 12:59:14 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 12:59:14 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[02-Oct-2025 12:59:14 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 12:59:14 UTC] DEBUG getListaTickets - Summary raw: {"total_vendido":639780,"total_ganadores":181030.4999847412,"total_pagados":79787.19999694824,"total_devoluciones":0}
[02-Oct-2025 12:59:14 UTC] DEBUG getListaTickets - Resultado final: {"total_vendido":639780,"total_ganadores":181030.4999847412,"total_pagados":79787.19999694824,"total_devoluciones":0,"ganancia":559992.8000030518}
[02-Oct-2025 12:59:14 UTC] DEBUG - Consulta SQL ejecutada: 
            SELECT 
                cr.fecha,
                cr.nro_caballo,
                COALESCE(SUM(dt.total_apostado), 0) as total_apostado,
                COALESCE(SUM(CASE WHEN crd.devolucion = 0 THEN dt.total_apostado ELSE 0 END), 0) as monto_a_devolver,
                COALESCE(SUM(CASE WHEN crd.devolucion = 1 THEN dt.total_apostado ELSE 0 END), 0) as monto_devuelto,
                CASE 
                    WHEN SUM(dt.total_apostado) IS NULL OR SUM(dt.total_apostado) = 0 THEN 'Sin Apuestas'
                    WHEN SUM(CASE WHEN crd.devolucion = 0 THEN 1 ELSE 0 END) > 0 
                         AND SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Parcial'
                    WHEN SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Devuelto'
                    ELSE 'Pendiente'
                END as estado_devolucion
            FROM 
                tbl_caballos_retirados_ultimo_momento cr
            LEFT JOIN 
                tbl_caballos_retirados_um_detalle crd ON cr.id_caballo_retirado_ultimo_momento = crd.id_caballo_retirado_ultimo_momento
            LEFT JOIN 
                tbl_detalle_tickets dt ON crd.id_detalle_ticket = dt.id_detalle_ticket
            WHERE 1=1
            AND cr.fecha >= :fecha_desde AND cr.fecha <= :fecha_hasta
            GROUP BY
                cr.fecha, cr.nro_caballo, cr.id_carrera
            ORDER BY
                cr.fecha DESC, cr.nro_caballo ASC
            LIMIT :limit OFFSET :offset
        
[02-Oct-2025 12:59:14 UTC] DEBUG - Parámetros: {":fecha_desde":"2025-05-01",":fecha_hasta":"2025-10-02",":limit":100,":offset":0}
[02-Oct-2025 12:59:14 UTC] DEBUG - Registros obtenidos: 16 de 16 totales
[02-Oct-2025 12:59:14 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[02-Oct-2025 12:59:14 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[02-Oct-2025 12:59:14 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[02-Oct-2025 12:59:14 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[02-Oct-2025 12:59:14 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[02-Oct-2025 12:59:14 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[02-Oct-2025 12:59:14 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[02-Oct-2025 12:59:14 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[02-Oct-2025 12:59:14 UTC] DEBUG formatearFecha - Input: '2025-07-15' (tipo: string)
[02-Oct-2025 12:59:14 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-15 -> 15/07/2025
[02-Oct-2025 12:59:14 UTC] DEBUG formatearFecha - Input: '2025-07-14' (tipo: string)
[02-Oct-2025 12:59:14 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-14 -> 14/07/2025
[02-Oct-2025 12:59:14 UTC] DEBUG formatearFecha - Input: '2025-07-11' (tipo: string)
[02-Oct-2025 12:59:14 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-11 -> 11/07/2025
[02-Oct-2025 12:59:14 UTC] DEBUG formatearFecha - Input: '2025-07-10' (tipo: string)
[02-Oct-2025 12:59:14 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-10 -> 10/07/2025
[02-Oct-2025 12:59:14 UTC] DEBUG formatearFecha - Input: '2025-07-08' (tipo: string)
[02-Oct-2025 12:59:14 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-08 -> 08/07/2025
[02-Oct-2025 12:59:14 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[02-Oct-2025 12:59:14 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[02-Oct-2025 12:59:14 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[02-Oct-2025 12:59:14 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[02-Oct-2025 12:59:14 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[02-Oct-2025 12:59:14 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[02-Oct-2025 12:59:14 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[02-Oct-2025 12:59:14 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[02-Oct-2025 12:59:14 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[02-Oct-2025 12:59:14 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[02-Oct-2025 12:59:14 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[02-Oct-2025 12:59:14 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[02-Oct-2025 12:59:14 UTC] DEBUG formatearFecha - Input: '2025-06-27' (tipo: string)
[02-Oct-2025 12:59:14 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-06-27 -> 27/06/2025
[02-Oct-2025 12:59:14 UTC] DEBUG getCaballosRetirados - Totals raw: {"total_records":16,"total_a_devolver":45310,"total_devuelto":5300,"total_general":50610}
[02-Oct-2025 12:59:14 UTC] DEBUG getCaballosRetirados - Resultado final: {"data":[{"fecha":"29\/07\/2025","nro_caballo":1,"total_apostado":2200,"monto_a_devolver":2200,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"29\/07\/2025","nro_caballo":6,"total_apostado":2000,"monto_a_devolver":2000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"17\/07\/2025","nro_caballo":1,"total_apostado":16000,"monto_a_devolver":16000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"17\/07\/2025","nro_caballo":8,"total_apostado":8000,"monto_a_devolver":8000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"15\/07\/2025","nro_caballo":1,"total_apostado":4000,"monto_a_devolver":4000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"14\/07\/2025","nro_caballo":4,"total_apostado":13000,"monto_a_devolver":13000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"11\/07\/2025","nro_caballo":4,"total_apostado":4000,"monto_a_devolver":0,"monto_devuelto":4000,"estado_devolucion":"Devuelto"},{"fecha":"10\/07\/2025","nro_caballo":7,"total_apostado":800,"monto_a_devolver":0,"monto_devuelto":800,"estado_devolucion":"Devuelto"},{"fecha":"08\/07\/2025","nro_caballo":7,"total_apostado":410,"monto_a_devolver":110,"monto_devuelto":300,"estado_devolucion":"Parcial"},{"fecha":"04\/07\/2025","nro_caballo":1,"total_apostado":100,"monto_a_devolver":0,"monto_devuelto":100,"estado_devolucion":"Devuelto"},{"fecha":"04\/07\/2025","nro_caballo":6,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"02\/07\/2025","nro_caballo":4,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"02\/07\/2025","nro_caballo":8,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"01\/07\/2025","nro_caballo":1,"total_apostado":100,"monto_a_devolver":0,"monto_devuelto":100,"estado_devolucion":"Devuelto"},{"fecha":"01\/07\/2025","nro_caballo":4,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"27\/06\/2025","nro_caballo":12,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"}],"total_records":16,"total_general":50610,"total_a_devolver":45310,"total_devuelto":5300}
[02-Oct-2025 12:59:14 UTC] Acceso a reporte: usuario=1, reporte=informe_parte_venta, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-02"}
[02-Oct-2025 13:01:26 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:01:26 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[02-Oct-2025 13:01:26 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:01:26 UTC] DEBUG Tickets Anulados - Filtros recibidos: {"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-02"}
[02-Oct-2025 13:01:26 UTC] DEBUG Tickets Anulados - WHERE construido: AND STR_TO_DATE(t.fecha, '%d/%m/%Y') >= STR_TO_DATE(:fecha_desde, '%Y-%m-%d') AND STR_TO_DATE(t.fecha, '%d/%m/%Y') <= STR_TO_DATE(:fecha_hasta, '%Y-%m-%d')
[02-Oct-2025 13:01:26 UTC] DEBUG Tickets Anulados - Registros obtenidos: 12
[02-Oct-2025 13:01:26 UTC] DEBUG Tickets Anulados - Primer registro: {"nro_ticket":133,"fecha":"31\/07\/2025","hora":"10:01:20","nombre_usuario":"Agencia 24","nombre_agencia":"Morteros","total_apostado":10000}
[02-Oct-2025 13:01:26 UTC] DEBUG formatearFecha - Input: '31/07/2025' (tipo: string)
[02-Oct-2025 13:01:26 UTC] DEBUG formatearFecha - Ya en formato correcto: 31/07/2025
[02-Oct-2025 13:01:26 UTC] DEBUG formatearFecha - Input: '06/07/2025' (tipo: string)
[02-Oct-2025 13:01:26 UTC] DEBUG formatearFecha - Ya en formato correcto: 06/07/2025
[02-Oct-2025 13:01:26 UTC] DEBUG formatearFecha - Input: '05/07/2025' (tipo: string)
[02-Oct-2025 13:01:26 UTC] DEBUG formatearFecha - Ya en formato correcto: 05/07/2025
[02-Oct-2025 13:01:26 UTC] DEBUG formatearFecha - Input: '04/07/2025' (tipo: string)
[02-Oct-2025 13:01:26 UTC] DEBUG formatearFecha - Ya en formato correcto: 04/07/2025
[02-Oct-2025 13:01:26 UTC] DEBUG formatearFecha - Input: '02/07/2025' (tipo: string)
[02-Oct-2025 13:01:26 UTC] DEBUG formatearFecha - Ya en formato correcto: 02/07/2025
[02-Oct-2025 13:01:26 UTC] DEBUG formatearFecha - Input: '02/07/2025' (tipo: string)
[02-Oct-2025 13:01:26 UTC] DEBUG formatearFecha - Ya en formato correcto: 02/07/2025
[02-Oct-2025 13:01:26 UTC] DEBUG formatearFecha - Input: '02/07/2025' (tipo: string)
[02-Oct-2025 13:01:26 UTC] DEBUG formatearFecha - Ya en formato correcto: 02/07/2025
[02-Oct-2025 13:01:26 UTC] DEBUG formatearFecha - Input: '02/07/2025' (tipo: string)
[02-Oct-2025 13:01:26 UTC] DEBUG formatearFecha - Ya en formato correcto: 02/07/2025
[02-Oct-2025 13:01:26 UTC] DEBUG formatearFecha - Input: '01/07/2025' (tipo: string)
[02-Oct-2025 13:01:26 UTC] DEBUG formatearFecha - Ya en formato correcto: 01/07/2025
[02-Oct-2025 13:01:26 UTC] DEBUG formatearFecha - Input: '01/07/2025' (tipo: string)
[02-Oct-2025 13:01:26 UTC] DEBUG formatearFecha - Ya en formato correcto: 01/07/2025
[02-Oct-2025 13:01:26 UTC] DEBUG formatearFecha - Input: '01/07/2025' (tipo: string)
[02-Oct-2025 13:01:26 UTC] DEBUG formatearFecha - Ya en formato correcto: 01/07/2025
[02-Oct-2025 13:01:26 UTC] DEBUG formatearFecha - Input: '30/06/2025' (tipo: string)
[02-Oct-2025 13:01:26 UTC] DEBUG formatearFecha - Ya en formato correcto: 30/06/2025
[02-Oct-2025 13:01:38 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:01:38 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[02-Oct-2025 13:01:38 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:01:38 UTC] DEBUG getListaTickets - Summary raw: {"total_vendido":639780,"total_ganadores":181030.4999847412,"total_pagados":79787.19999694824,"total_devoluciones":0}
[02-Oct-2025 13:01:38 UTC] DEBUG getListaTickets - Resultado final: {"total_vendido":639780,"total_ganadores":181030.4999847412,"total_pagados":79787.19999694824,"total_devoluciones":0,"ganancia":559992.8000030518}
[02-Oct-2025 13:01:38 UTC] DEBUG - Consulta SQL ejecutada: 
            SELECT 
                cr.fecha,
                cr.nro_caballo,
                COALESCE(SUM(dt.total_apostado), 0) as total_apostado,
                COALESCE(SUM(CASE WHEN crd.devolucion = 0 THEN dt.total_apostado ELSE 0 END), 0) as monto_a_devolver,
                COALESCE(SUM(CASE WHEN crd.devolucion = 1 THEN dt.total_apostado ELSE 0 END), 0) as monto_devuelto,
                CASE 
                    WHEN SUM(dt.total_apostado) IS NULL OR SUM(dt.total_apostado) = 0 THEN 'Sin Apuestas'
                    WHEN SUM(CASE WHEN crd.devolucion = 0 THEN 1 ELSE 0 END) > 0 
                         AND SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Parcial'
                    WHEN SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Devuelto'
                    ELSE 'Pendiente'
                END as estado_devolucion
            FROM 
                tbl_caballos_retirados_ultimo_momento cr
            LEFT JOIN 
                tbl_caballos_retirados_um_detalle crd ON cr.id_caballo_retirado_ultimo_momento = crd.id_caballo_retirado_ultimo_momento
            LEFT JOIN 
                tbl_detalle_tickets dt ON crd.id_detalle_ticket = dt.id_detalle_ticket
            WHERE 1=1
            AND cr.fecha >= :fecha_desde AND cr.fecha <= :fecha_hasta
            GROUP BY
                cr.fecha, cr.nro_caballo, cr.id_carrera
            ORDER BY
                cr.fecha DESC, cr.nro_caballo ASC
            LIMIT :limit OFFSET :offset
        
[02-Oct-2025 13:01:38 UTC] DEBUG - Parámetros: {":fecha_desde":"2025-05-01",":fecha_hasta":"2025-10-02",":limit":100,":offset":0}
[02-Oct-2025 13:01:38 UTC] DEBUG - Registros obtenidos: 16 de 16 totales
[02-Oct-2025 13:01:38 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[02-Oct-2025 13:01:38 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[02-Oct-2025 13:01:38 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[02-Oct-2025 13:01:38 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[02-Oct-2025 13:01:38 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[02-Oct-2025 13:01:38 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[02-Oct-2025 13:01:38 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[02-Oct-2025 13:01:38 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[02-Oct-2025 13:01:38 UTC] DEBUG formatearFecha - Input: '2025-07-15' (tipo: string)
[02-Oct-2025 13:01:38 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-15 -> 15/07/2025
[02-Oct-2025 13:01:38 UTC] DEBUG formatearFecha - Input: '2025-07-14' (tipo: string)
[02-Oct-2025 13:01:38 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-14 -> 14/07/2025
[02-Oct-2025 13:01:38 UTC] DEBUG formatearFecha - Input: '2025-07-11' (tipo: string)
[02-Oct-2025 13:01:38 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-11 -> 11/07/2025
[02-Oct-2025 13:01:38 UTC] DEBUG formatearFecha - Input: '2025-07-10' (tipo: string)
[02-Oct-2025 13:01:38 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-10 -> 10/07/2025
[02-Oct-2025 13:01:38 UTC] DEBUG formatearFecha - Input: '2025-07-08' (tipo: string)
[02-Oct-2025 13:01:38 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-08 -> 08/07/2025
[02-Oct-2025 13:01:38 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[02-Oct-2025 13:01:38 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[02-Oct-2025 13:01:38 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[02-Oct-2025 13:01:38 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[02-Oct-2025 13:01:38 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[02-Oct-2025 13:01:38 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[02-Oct-2025 13:01:38 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[02-Oct-2025 13:01:38 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[02-Oct-2025 13:01:38 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[02-Oct-2025 13:01:38 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[02-Oct-2025 13:01:38 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[02-Oct-2025 13:01:38 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[02-Oct-2025 13:01:38 UTC] DEBUG formatearFecha - Input: '2025-06-27' (tipo: string)
[02-Oct-2025 13:01:38 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-06-27 -> 27/06/2025
[02-Oct-2025 13:01:38 UTC] DEBUG getCaballosRetirados - Totals raw: {"total_records":16,"total_a_devolver":45310,"total_devuelto":5300,"total_general":50610}
[02-Oct-2025 13:01:38 UTC] DEBUG getCaballosRetirados - Resultado final: {"data":[{"fecha":"29\/07\/2025","nro_caballo":1,"total_apostado":2200,"monto_a_devolver":2200,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"29\/07\/2025","nro_caballo":6,"total_apostado":2000,"monto_a_devolver":2000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"17\/07\/2025","nro_caballo":1,"total_apostado":16000,"monto_a_devolver":16000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"17\/07\/2025","nro_caballo":8,"total_apostado":8000,"monto_a_devolver":8000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"15\/07\/2025","nro_caballo":1,"total_apostado":4000,"monto_a_devolver":4000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"14\/07\/2025","nro_caballo":4,"total_apostado":13000,"monto_a_devolver":13000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"11\/07\/2025","nro_caballo":4,"total_apostado":4000,"monto_a_devolver":0,"monto_devuelto":4000,"estado_devolucion":"Devuelto"},{"fecha":"10\/07\/2025","nro_caballo":7,"total_apostado":800,"monto_a_devolver":0,"monto_devuelto":800,"estado_devolucion":"Devuelto"},{"fecha":"08\/07\/2025","nro_caballo":7,"total_apostado":410,"monto_a_devolver":110,"monto_devuelto":300,"estado_devolucion":"Parcial"},{"fecha":"04\/07\/2025","nro_caballo":1,"total_apostado":100,"monto_a_devolver":0,"monto_devuelto":100,"estado_devolucion":"Devuelto"},{"fecha":"04\/07\/2025","nro_caballo":6,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"02\/07\/2025","nro_caballo":4,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"02\/07\/2025","nro_caballo":8,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"01\/07\/2025","nro_caballo":1,"total_apostado":100,"monto_a_devolver":0,"monto_devuelto":100,"estado_devolucion":"Devuelto"},{"fecha":"01\/07\/2025","nro_caballo":4,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"27\/06\/2025","nro_caballo":12,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"}],"total_records":16,"total_general":50610,"total_a_devolver":45310,"total_devuelto":5300}
[02-Oct-2025 13:01:38 UTC] Acceso a reporte: usuario=1, reporte=informe_parte_venta, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-02"}
[02-Oct-2025 13:01:41 UTC] PHP Fatal error:  Uncaught Error: Call to undefined method TurfReports\Controllers\AuthController::verify() in /var/www/html/Routes/api.php:121
Stack trace:
#0 {main}
  thrown in /var/www/html/Routes/api.php on line 121
[02-Oct-2025 13:01:42 UTC] DEBUG Login - Usuario encontrado: SÍ
[02-Oct-2025 13:01:42 UTC] DEBUG Login - Login BD: carreras2024
[02-Oct-2025 13:01:42 UTC] DEBUG Login - Login enviado: carreras2024
[02-Oct-2025 13:01:42 UTC] DEBUG Login - Contraseña BD: 0192023a7bbd73250516f069df18b500
[02-Oct-2025 13:01:42 UTC] DEBUG Login - Contraseña enviada: admin123
[02-Oct-2025 13:01:42 UTC] DEBUG Login - Contraseña MD5: 0192023a7bbd73250516f069df18b500
[02-Oct-2025 13:01:42 UTC] DEBUG Login - Coinciden MD5: SÍ
[02-Oct-2025 13:01:42 UTC] DEBUG Login - id_perfil: 1 (tipo: integer)
[02-Oct-2025 13:01:42 UTC] DEBUG Login - Rol asignado: admin
[02-Oct-2025 13:01:42 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:01:42 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[02-Oct-2025 13:01:42 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:01:43 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:01:43 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[02-Oct-2025 13:01:43 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:01:43 UTC] DEBUG getListaTickets - Summary raw: {"total_vendido":null,"total_ganadores":null,"total_pagados":null,"total_devoluciones":0}
[02-Oct-2025 13:01:43 UTC] DEBUG getListaTickets - Resultado final: {"total_vendido":0,"total_ganadores":0,"total_pagados":0,"total_devoluciones":0,"ganancia":0}
[02-Oct-2025 13:01:43 UTC] DEBUG - Consulta SQL ejecutada: 
            SELECT 
                cr.fecha,
                cr.nro_caballo,
                COALESCE(SUM(dt.total_apostado), 0) as total_apostado,
                COALESCE(SUM(CASE WHEN crd.devolucion = 0 THEN dt.total_apostado ELSE 0 END), 0) as monto_a_devolver,
                COALESCE(SUM(CASE WHEN crd.devolucion = 1 THEN dt.total_apostado ELSE 0 END), 0) as monto_devuelto,
                CASE 
                    WHEN SUM(dt.total_apostado) IS NULL OR SUM(dt.total_apostado) = 0 THEN 'Sin Apuestas'
                    WHEN SUM(CASE WHEN crd.devolucion = 0 THEN 1 ELSE 0 END) > 0 
                         AND SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Parcial'
                    WHEN SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Devuelto'
                    ELSE 'Pendiente'
                END as estado_devolucion
            FROM 
                tbl_caballos_retirados_ultimo_momento cr
            LEFT JOIN 
                tbl_caballos_retirados_um_detalle crd ON cr.id_caballo_retirado_ultimo_momento = crd.id_caballo_retirado_ultimo_momento
            LEFT JOIN 
                tbl_detalle_tickets dt ON crd.id_detalle_ticket = dt.id_detalle_ticket
            WHERE 1=1
            AND cr.fecha >= :fecha_desde AND cr.fecha <= :fecha_hasta
            GROUP BY
                cr.fecha, cr.nro_caballo, cr.id_carrera
            ORDER BY
                cr.fecha DESC, cr.nro_caballo ASC
            LIMIT :limit OFFSET :offset
        
[02-Oct-2025 13:01:43 UTC] DEBUG - Parámetros: {":fecha_desde":"2025-09-02",":fecha_hasta":"2025-10-02",":limit":100,":offset":0}
[02-Oct-2025 13:01:43 UTC] DEBUG - Registros obtenidos: 0 de 0 totales
[02-Oct-2025 13:01:43 UTC] DEBUG getCaballosRetirados - Totals raw: {"total_records":0,"total_a_devolver":0,"total_devuelto":0,"total_general":0}
[02-Oct-2025 13:01:43 UTC] DEBUG getCaballosRetirados - Resultado final: {"data":[],"total_records":0,"total_general":0,"total_a_devolver":0,"total_devuelto":0}
[02-Oct-2025 13:01:43 UTC] Acceso a reporte: usuario=1, reporte=informe_parte_venta, filtros={"fecha_desde":"2025-09-02","fecha_hasta":"2025-10-02"}
[02-Oct-2025 13:01:47 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:01:47 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[02-Oct-2025 13:01:47 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:01:47 UTC] DEBUG getListaTickets - Summary raw: {"total_vendido":639780,"total_ganadores":181030.4999847412,"total_pagados":79787.19999694824,"total_devoluciones":0}
[02-Oct-2025 13:01:47 UTC] DEBUG getListaTickets - Resultado final: {"total_vendido":639780,"total_ganadores":181030.4999847412,"total_pagados":79787.19999694824,"total_devoluciones":0,"ganancia":559992.8000030518}
[02-Oct-2025 13:01:47 UTC] DEBUG - Consulta SQL ejecutada: 
            SELECT 
                cr.fecha,
                cr.nro_caballo,
                COALESCE(SUM(dt.total_apostado), 0) as total_apostado,
                COALESCE(SUM(CASE WHEN crd.devolucion = 0 THEN dt.total_apostado ELSE 0 END), 0) as monto_a_devolver,
                COALESCE(SUM(CASE WHEN crd.devolucion = 1 THEN dt.total_apostado ELSE 0 END), 0) as monto_devuelto,
                CASE 
                    WHEN SUM(dt.total_apostado) IS NULL OR SUM(dt.total_apostado) = 0 THEN 'Sin Apuestas'
                    WHEN SUM(CASE WHEN crd.devolucion = 0 THEN 1 ELSE 0 END) > 0 
                         AND SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Parcial'
                    WHEN SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Devuelto'
                    ELSE 'Pendiente'
                END as estado_devolucion
            FROM 
                tbl_caballos_retirados_ultimo_momento cr
            LEFT JOIN 
                tbl_caballos_retirados_um_detalle crd ON cr.id_caballo_retirado_ultimo_momento = crd.id_caballo_retirado_ultimo_momento
            LEFT JOIN 
                tbl_detalle_tickets dt ON crd.id_detalle_ticket = dt.id_detalle_ticket
            WHERE 1=1
            AND cr.fecha >= :fecha_desde AND cr.fecha <= :fecha_hasta
            GROUP BY
                cr.fecha, cr.nro_caballo, cr.id_carrera
            ORDER BY
                cr.fecha DESC, cr.nro_caballo ASC
            LIMIT :limit OFFSET :offset
        
[02-Oct-2025 13:01:47 UTC] DEBUG - Parámetros: {":fecha_desde":"2025-05-01",":fecha_hasta":"2025-10-02",":limit":100,":offset":0}
[02-Oct-2025 13:01:47 UTC] DEBUG - Registros obtenidos: 16 de 16 totales
[02-Oct-2025 13:01:47 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[02-Oct-2025 13:01:47 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[02-Oct-2025 13:01:47 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[02-Oct-2025 13:01:47 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[02-Oct-2025 13:01:47 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[02-Oct-2025 13:01:47 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[02-Oct-2025 13:01:47 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[02-Oct-2025 13:01:47 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[02-Oct-2025 13:01:47 UTC] DEBUG formatearFecha - Input: '2025-07-15' (tipo: string)
[02-Oct-2025 13:01:47 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-15 -> 15/07/2025
[02-Oct-2025 13:01:47 UTC] DEBUG formatearFecha - Input: '2025-07-14' (tipo: string)
[02-Oct-2025 13:01:47 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-14 -> 14/07/2025
[02-Oct-2025 13:01:47 UTC] DEBUG formatearFecha - Input: '2025-07-11' (tipo: string)
[02-Oct-2025 13:01:47 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-11 -> 11/07/2025
[02-Oct-2025 13:01:47 UTC] DEBUG formatearFecha - Input: '2025-07-10' (tipo: string)
[02-Oct-2025 13:01:47 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-10 -> 10/07/2025
[02-Oct-2025 13:01:47 UTC] DEBUG formatearFecha - Input: '2025-07-08' (tipo: string)
[02-Oct-2025 13:01:47 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-08 -> 08/07/2025
[02-Oct-2025 13:01:47 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[02-Oct-2025 13:01:47 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[02-Oct-2025 13:01:47 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[02-Oct-2025 13:01:47 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[02-Oct-2025 13:01:47 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[02-Oct-2025 13:01:47 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[02-Oct-2025 13:01:47 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[02-Oct-2025 13:01:47 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[02-Oct-2025 13:01:47 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[02-Oct-2025 13:01:47 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[02-Oct-2025 13:01:47 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[02-Oct-2025 13:01:47 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[02-Oct-2025 13:01:47 UTC] DEBUG formatearFecha - Input: '2025-06-27' (tipo: string)
[02-Oct-2025 13:01:47 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-06-27 -> 27/06/2025
[02-Oct-2025 13:01:47 UTC] DEBUG getCaballosRetirados - Totals raw: {"total_records":16,"total_a_devolver":45310,"total_devuelto":5300,"total_general":50610}
[02-Oct-2025 13:01:47 UTC] DEBUG getCaballosRetirados - Resultado final: {"data":[{"fecha":"29\/07\/2025","nro_caballo":1,"total_apostado":2200,"monto_a_devolver":2200,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"29\/07\/2025","nro_caballo":6,"total_apostado":2000,"monto_a_devolver":2000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"17\/07\/2025","nro_caballo":1,"total_apostado":16000,"monto_a_devolver":16000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"17\/07\/2025","nro_caballo":8,"total_apostado":8000,"monto_a_devolver":8000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"15\/07\/2025","nro_caballo":1,"total_apostado":4000,"monto_a_devolver":4000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"14\/07\/2025","nro_caballo":4,"total_apostado":13000,"monto_a_devolver":13000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"11\/07\/2025","nro_caballo":4,"total_apostado":4000,"monto_a_devolver":0,"monto_devuelto":4000,"estado_devolucion":"Devuelto"},{"fecha":"10\/07\/2025","nro_caballo":7,"total_apostado":800,"monto_a_devolver":0,"monto_devuelto":800,"estado_devolucion":"Devuelto"},{"fecha":"08\/07\/2025","nro_caballo":7,"total_apostado":410,"monto_a_devolver":110,"monto_devuelto":300,"estado_devolucion":"Parcial"},{"fecha":"04\/07\/2025","nro_caballo":1,"total_apostado":100,"monto_a_devolver":0,"monto_devuelto":100,"estado_devolucion":"Devuelto"},{"fecha":"04\/07\/2025","nro_caballo":6,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"02\/07\/2025","nro_caballo":4,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"02\/07\/2025","nro_caballo":8,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"01\/07\/2025","nro_caballo":1,"total_apostado":100,"monto_a_devolver":0,"monto_devuelto":100,"estado_devolucion":"Devuelto"},{"fecha":"01\/07\/2025","nro_caballo":4,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"27\/06\/2025","nro_caballo":12,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"}],"total_records":16,"total_general":50610,"total_a_devolver":45310,"total_devuelto":5300}
[02-Oct-2025 13:01:47 UTC] Acceso a reporte: usuario=1, reporte=informe_parte_venta, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-02"}
[02-Oct-2025 13:02:29 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:02:29 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[02-Oct-2025 13:02:29 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:02:29 UTC] DEBUG Carreras - Filtros recibidos: {"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-02"}
[02-Oct-2025 13:02:29 UTC] DEBUG Carreras - WHERE SQL: WHERE STR_TO_DATE(c.fecha, '%d/%m/%Y') >= STR_TO_DATE(:fecha_desde, '%Y-%m-%d') AND STR_TO_DATE(c.fecha, '%d/%m/%Y') <= STR_TO_DATE(:fecha_hasta, '%Y-%m-%d')
[02-Oct-2025 13:02:29 UTC] DEBUG Carreras - Parámetros: {":fecha_desde":"2025-05-01",":fecha_hasta":"2025-10-02"}
[02-Oct-2025 13:02:30 UTC] DEBUG Carreras - Registros obtenidos: 52
[02-Oct-2025 13:02:30 UTC] DEBUG Carreras - Primer registro: {"numero_carrera":1,"fecha":"31\/07\/2025","nombre_hipodromo":"San Isidro","estado_carrera":"Apuesta","carrera_interna_id":52}
[02-Oct-2025 13:02:30 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:02:30 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[02-Oct-2025 13:02:30 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:02:30 UTC] DEBUG - Consulta SQL ejecutada: 
            SELECT 
                cr.fecha,
                cr.nro_caballo,
                COALESCE(SUM(dt.total_apostado), 0) as total_apostado,
                COALESCE(SUM(CASE WHEN crd.devolucion = 0 THEN dt.total_apostado ELSE 0 END), 0) as monto_a_devolver,
                COALESCE(SUM(CASE WHEN crd.devolucion = 1 THEN dt.total_apostado ELSE 0 END), 0) as monto_devuelto,
                CASE 
                    WHEN SUM(dt.total_apostado) IS NULL OR SUM(dt.total_apostado) = 0 THEN 'Sin Apuestas'
                    WHEN SUM(CASE WHEN crd.devolucion = 0 THEN 1 ELSE 0 END) > 0 
                         AND SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Parcial'
                    WHEN SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Devuelto'
                    ELSE 'Pendiente'
                END as estado_devolucion
            FROM 
                tbl_caballos_retirados_ultimo_momento cr
            LEFT JOIN 
                tbl_caballos_retirados_um_detalle crd ON cr.id_caballo_retirado_ultimo_momento = crd.id_caballo_retirado_ultimo_momento
            LEFT JOIN 
                tbl_detalle_tickets dt ON crd.id_detalle_ticket = dt.id_detalle_ticket
            WHERE 1=1
            AND cr.fecha >= :fecha_desde AND cr.fecha <= :fecha_hasta
            GROUP BY
                cr.fecha, cr.nro_caballo, cr.id_carrera
            ORDER BY
                cr.fecha DESC, cr.nro_caballo ASC
            LIMIT :limit OFFSET :offset
        
[02-Oct-2025 13:02:30 UTC] DEBUG - Parámetros: {":fecha_desde":"2025-05-01",":fecha_hasta":"2025-10-02",":limit":100,":offset":0}
[02-Oct-2025 13:02:30 UTC] DEBUG - Registros obtenidos: 16 de 16 totales
[02-Oct-2025 13:02:30 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[02-Oct-2025 13:02:30 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[02-Oct-2025 13:02:30 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[02-Oct-2025 13:02:30 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[02-Oct-2025 13:02:30 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[02-Oct-2025 13:02:30 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[02-Oct-2025 13:02:30 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[02-Oct-2025 13:02:30 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[02-Oct-2025 13:02:30 UTC] DEBUG formatearFecha - Input: '2025-07-15' (tipo: string)
[02-Oct-2025 13:02:30 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-15 -> 15/07/2025
[02-Oct-2025 13:02:30 UTC] DEBUG formatearFecha - Input: '2025-07-14' (tipo: string)
[02-Oct-2025 13:02:30 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-14 -> 14/07/2025
[02-Oct-2025 13:02:30 UTC] DEBUG formatearFecha - Input: '2025-07-11' (tipo: string)
[02-Oct-2025 13:02:30 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-11 -> 11/07/2025
[02-Oct-2025 13:02:30 UTC] DEBUG formatearFecha - Input: '2025-07-10' (tipo: string)
[02-Oct-2025 13:02:30 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-10 -> 10/07/2025
[02-Oct-2025 13:02:30 UTC] DEBUG formatearFecha - Input: '2025-07-08' (tipo: string)
[02-Oct-2025 13:02:30 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-08 -> 08/07/2025
[02-Oct-2025 13:02:30 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[02-Oct-2025 13:02:30 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[02-Oct-2025 13:02:30 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[02-Oct-2025 13:02:30 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[02-Oct-2025 13:02:30 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[02-Oct-2025 13:02:30 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[02-Oct-2025 13:02:30 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[02-Oct-2025 13:02:30 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[02-Oct-2025 13:02:30 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[02-Oct-2025 13:02:30 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[02-Oct-2025 13:02:30 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[02-Oct-2025 13:02:30 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[02-Oct-2025 13:02:30 UTC] DEBUG formatearFecha - Input: '2025-06-27' (tipo: string)
[02-Oct-2025 13:02:30 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-06-27 -> 27/06/2025
[02-Oct-2025 13:02:30 UTC] DEBUG getCaballosRetirados - Totals raw: {"total_records":16,"total_a_devolver":45310,"total_devuelto":5300,"total_general":50610}
[02-Oct-2025 13:02:30 UTC] DEBUG getCaballosRetirados - Resultado final: {"data":[{"fecha":"29\/07\/2025","nro_caballo":1,"total_apostado":2200,"monto_a_devolver":2200,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"29\/07\/2025","nro_caballo":6,"total_apostado":2000,"monto_a_devolver":2000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"17\/07\/2025","nro_caballo":1,"total_apostado":16000,"monto_a_devolver":16000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"17\/07\/2025","nro_caballo":8,"total_apostado":8000,"monto_a_devolver":8000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"15\/07\/2025","nro_caballo":1,"total_apostado":4000,"monto_a_devolver":4000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"14\/07\/2025","nro_caballo":4,"total_apostado":13000,"monto_a_devolver":13000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"11\/07\/2025","nro_caballo":4,"total_apostado":4000,"monto_a_devolver":0,"monto_devuelto":4000,"estado_devolucion":"Devuelto"},{"fecha":"10\/07\/2025","nro_caballo":7,"total_apostado":800,"monto_a_devolver":0,"monto_devuelto":800,"estado_devolucion":"Devuelto"},{"fecha":"08\/07\/2025","nro_caballo":7,"total_apostado":410,"monto_a_devolver":110,"monto_devuelto":300,"estado_devolucion":"Parcial"},{"fecha":"04\/07\/2025","nro_caballo":1,"total_apostado":100,"monto_a_devolver":0,"monto_devuelto":100,"estado_devolucion":"Devuelto"},{"fecha":"04\/07\/2025","nro_caballo":6,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"02\/07\/2025","nro_caballo":4,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"02\/07\/2025","nro_caballo":8,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"01\/07\/2025","nro_caballo":1,"total_apostado":100,"monto_a_devolver":0,"monto_devuelto":100,"estado_devolucion":"Devuelto"},{"fecha":"01\/07\/2025","nro_caballo":4,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"27\/06\/2025","nro_caballo":12,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"}],"total_records":16,"total_general":50610,"total_a_devolver":45310,"total_devuelto":5300}
[02-Oct-2025 13:02:33 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:02:33 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[02-Oct-2025 13:02:33 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:02:33 UTC] DEBUG Tickets Anulados - Filtros recibidos: {"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-02"}
[02-Oct-2025 13:02:33 UTC] DEBUG Tickets Anulados - WHERE construido: AND STR_TO_DATE(t.fecha, '%d/%m/%Y') >= STR_TO_DATE(:fecha_desde, '%Y-%m-%d') AND STR_TO_DATE(t.fecha, '%d/%m/%Y') <= STR_TO_DATE(:fecha_hasta, '%Y-%m-%d')
[02-Oct-2025 13:02:33 UTC] DEBUG Tickets Anulados - Registros obtenidos: 12
[02-Oct-2025 13:02:33 UTC] DEBUG Tickets Anulados - Primer registro: {"nro_ticket":133,"fecha":"31\/07\/2025","hora":"10:01:20","nombre_usuario":"Agencia 24","nombre_agencia":"Morteros","total_apostado":10000}
[02-Oct-2025 13:02:33 UTC] DEBUG formatearFecha - Input: '31/07/2025' (tipo: string)
[02-Oct-2025 13:02:33 UTC] DEBUG formatearFecha - Ya en formato correcto: 31/07/2025
[02-Oct-2025 13:02:33 UTC] DEBUG formatearFecha - Input: '06/07/2025' (tipo: string)
[02-Oct-2025 13:02:33 UTC] DEBUG formatearFecha - Ya en formato correcto: 06/07/2025
[02-Oct-2025 13:02:33 UTC] DEBUG formatearFecha - Input: '05/07/2025' (tipo: string)
[02-Oct-2025 13:02:33 UTC] DEBUG formatearFecha - Ya en formato correcto: 05/07/2025
[02-Oct-2025 13:02:33 UTC] DEBUG formatearFecha - Input: '04/07/2025' (tipo: string)
[02-Oct-2025 13:02:33 UTC] DEBUG formatearFecha - Ya en formato correcto: 04/07/2025
[02-Oct-2025 13:02:33 UTC] DEBUG formatearFecha - Input: '02/07/2025' (tipo: string)
[02-Oct-2025 13:02:33 UTC] DEBUG formatearFecha - Ya en formato correcto: 02/07/2025
[02-Oct-2025 13:02:33 UTC] DEBUG formatearFecha - Input: '02/07/2025' (tipo: string)
[02-Oct-2025 13:02:33 UTC] DEBUG formatearFecha - Ya en formato correcto: 02/07/2025
[02-Oct-2025 13:02:33 UTC] DEBUG formatearFecha - Input: '02/07/2025' (tipo: string)
[02-Oct-2025 13:02:33 UTC] DEBUG formatearFecha - Ya en formato correcto: 02/07/2025
[02-Oct-2025 13:02:33 UTC] DEBUG formatearFecha - Input: '02/07/2025' (tipo: string)
[02-Oct-2025 13:02:33 UTC] DEBUG formatearFecha - Ya en formato correcto: 02/07/2025
[02-Oct-2025 13:02:33 UTC] DEBUG formatearFecha - Input: '01/07/2025' (tipo: string)
[02-Oct-2025 13:02:33 UTC] DEBUG formatearFecha - Ya en formato correcto: 01/07/2025
[02-Oct-2025 13:02:33 UTC] DEBUG formatearFecha - Input: '01/07/2025' (tipo: string)
[02-Oct-2025 13:02:33 UTC] DEBUG formatearFecha - Ya en formato correcto: 01/07/2025
[02-Oct-2025 13:02:33 UTC] DEBUG formatearFecha - Input: '01/07/2025' (tipo: string)
[02-Oct-2025 13:02:33 UTC] DEBUG formatearFecha - Ya en formato correcto: 01/07/2025
[02-Oct-2025 13:02:33 UTC] DEBUG formatearFecha - Input: '30/06/2025' (tipo: string)
[02-Oct-2025 13:02:33 UTC] DEBUG formatearFecha - Ya en formato correcto: 30/06/2025
[02-Oct-2025 13:02:38 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:02:38 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[02-Oct-2025 13:02:38 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:02:38 UTC] DEBUG getListaTickets - Summary raw: {"total_vendido":639780,"total_ganadores":181030.4999847412,"total_pagados":79787.19999694824,"total_devoluciones":0}
[02-Oct-2025 13:02:38 UTC] DEBUG getListaTickets - Resultado final: {"total_vendido":639780,"total_ganadores":181030.4999847412,"total_pagados":79787.19999694824,"total_devoluciones":0,"ganancia":559992.8000030518}
[02-Oct-2025 13:02:38 UTC] DEBUG - Consulta SQL ejecutada: 
            SELECT 
                cr.fecha,
                cr.nro_caballo,
                COALESCE(SUM(dt.total_apostado), 0) as total_apostado,
                COALESCE(SUM(CASE WHEN crd.devolucion = 0 THEN dt.total_apostado ELSE 0 END), 0) as monto_a_devolver,
                COALESCE(SUM(CASE WHEN crd.devolucion = 1 THEN dt.total_apostado ELSE 0 END), 0) as monto_devuelto,
                CASE 
                    WHEN SUM(dt.total_apostado) IS NULL OR SUM(dt.total_apostado) = 0 THEN 'Sin Apuestas'
                    WHEN SUM(CASE WHEN crd.devolucion = 0 THEN 1 ELSE 0 END) > 0 
                         AND SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Parcial'
                    WHEN SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Devuelto'
                    ELSE 'Pendiente'
                END as estado_devolucion
            FROM 
                tbl_caballos_retirados_ultimo_momento cr
            LEFT JOIN 
                tbl_caballos_retirados_um_detalle crd ON cr.id_caballo_retirado_ultimo_momento = crd.id_caballo_retirado_ultimo_momento
            LEFT JOIN 
                tbl_detalle_tickets dt ON crd.id_detalle_ticket = dt.id_detalle_ticket
            WHERE 1=1
            AND cr.fecha >= :fecha_desde AND cr.fecha <= :fecha_hasta
            GROUP BY
                cr.fecha, cr.nro_caballo, cr.id_carrera
            ORDER BY
                cr.fecha DESC, cr.nro_caballo ASC
            LIMIT :limit OFFSET :offset
        
[02-Oct-2025 13:02:38 UTC] DEBUG - Parámetros: {":fecha_desde":"2025-05-01",":fecha_hasta":"2025-10-02",":limit":100,":offset":0}
[02-Oct-2025 13:02:38 UTC] DEBUG - Registros obtenidos: 16 de 16 totales
[02-Oct-2025 13:02:38 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[02-Oct-2025 13:02:38 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[02-Oct-2025 13:02:38 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[02-Oct-2025 13:02:38 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[02-Oct-2025 13:02:38 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[02-Oct-2025 13:02:38 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[02-Oct-2025 13:02:38 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[02-Oct-2025 13:02:38 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[02-Oct-2025 13:02:38 UTC] DEBUG formatearFecha - Input: '2025-07-15' (tipo: string)
[02-Oct-2025 13:02:38 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-15 -> 15/07/2025
[02-Oct-2025 13:02:38 UTC] DEBUG formatearFecha - Input: '2025-07-14' (tipo: string)
[02-Oct-2025 13:02:38 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-14 -> 14/07/2025
[02-Oct-2025 13:02:38 UTC] DEBUG formatearFecha - Input: '2025-07-11' (tipo: string)
[02-Oct-2025 13:02:38 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-11 -> 11/07/2025
[02-Oct-2025 13:02:38 UTC] DEBUG formatearFecha - Input: '2025-07-10' (tipo: string)
[02-Oct-2025 13:02:38 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-10 -> 10/07/2025
[02-Oct-2025 13:02:38 UTC] DEBUG formatearFecha - Input: '2025-07-08' (tipo: string)
[02-Oct-2025 13:02:38 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-08 -> 08/07/2025
[02-Oct-2025 13:02:38 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[02-Oct-2025 13:02:38 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[02-Oct-2025 13:02:38 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[02-Oct-2025 13:02:38 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[02-Oct-2025 13:02:38 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[02-Oct-2025 13:02:38 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[02-Oct-2025 13:02:38 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[02-Oct-2025 13:02:38 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[02-Oct-2025 13:02:38 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[02-Oct-2025 13:02:38 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[02-Oct-2025 13:02:38 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[02-Oct-2025 13:02:38 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[02-Oct-2025 13:02:38 UTC] DEBUG formatearFecha - Input: '2025-06-27' (tipo: string)
[02-Oct-2025 13:02:38 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-06-27 -> 27/06/2025
[02-Oct-2025 13:02:38 UTC] DEBUG getCaballosRetirados - Totals raw: {"total_records":16,"total_a_devolver":45310,"total_devuelto":5300,"total_general":50610}
[02-Oct-2025 13:02:38 UTC] DEBUG getCaballosRetirados - Resultado final: {"data":[{"fecha":"29\/07\/2025","nro_caballo":1,"total_apostado":2200,"monto_a_devolver":2200,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"29\/07\/2025","nro_caballo":6,"total_apostado":2000,"monto_a_devolver":2000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"17\/07\/2025","nro_caballo":1,"total_apostado":16000,"monto_a_devolver":16000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"17\/07\/2025","nro_caballo":8,"total_apostado":8000,"monto_a_devolver":8000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"15\/07\/2025","nro_caballo":1,"total_apostado":4000,"monto_a_devolver":4000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"14\/07\/2025","nro_caballo":4,"total_apostado":13000,"monto_a_devolver":13000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"11\/07\/2025","nro_caballo":4,"total_apostado":4000,"monto_a_devolver":0,"monto_devuelto":4000,"estado_devolucion":"Devuelto"},{"fecha":"10\/07\/2025","nro_caballo":7,"total_apostado":800,"monto_a_devolver":0,"monto_devuelto":800,"estado_devolucion":"Devuelto"},{"fecha":"08\/07\/2025","nro_caballo":7,"total_apostado":410,"monto_a_devolver":110,"monto_devuelto":300,"estado_devolucion":"Parcial"},{"fecha":"04\/07\/2025","nro_caballo":1,"total_apostado":100,"monto_a_devolver":0,"monto_devuelto":100,"estado_devolucion":"Devuelto"},{"fecha":"04\/07\/2025","nro_caballo":6,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"02\/07\/2025","nro_caballo":4,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"02\/07\/2025","nro_caballo":8,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"01\/07\/2025","nro_caballo":1,"total_apostado":100,"monto_a_devolver":0,"monto_devuelto":100,"estado_devolucion":"Devuelto"},{"fecha":"01\/07\/2025","nro_caballo":4,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"27\/06\/2025","nro_caballo":12,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"}],"total_records":16,"total_general":50610,"total_a_devolver":45310,"total_devuelto":5300}
[02-Oct-2025 13:02:38 UTC] Acceso a reporte: usuario=1, reporte=informe_parte_venta, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-02"}
[02-Oct-2025 13:03:03 UTC] PHP Fatal error:  Uncaught Error: Call to undefined method TurfReports\Controllers\AuthController::verify() in /var/www/html/Routes/api.php:121
Stack trace:
#0 {main}
  thrown in /var/www/html/Routes/api.php on line 121
[02-Oct-2025 13:03:04 UTC] DEBUG Login - Usuario encontrado: SÍ
[02-Oct-2025 13:03:04 UTC] DEBUG Login - Login BD: carreras2024
[02-Oct-2025 13:03:04 UTC] DEBUG Login - Login enviado: carreras2024
[02-Oct-2025 13:03:04 UTC] DEBUG Login - Contraseña BD: 0192023a7bbd73250516f069df18b500
[02-Oct-2025 13:03:04 UTC] DEBUG Login - Contraseña enviada: admin123
[02-Oct-2025 13:03:04 UTC] DEBUG Login - Contraseña MD5: 0192023a7bbd73250516f069df18b500
[02-Oct-2025 13:03:04 UTC] DEBUG Login - Coinciden MD5: SÍ
[02-Oct-2025 13:03:04 UTC] DEBUG Login - id_perfil: 1 (tipo: integer)
[02-Oct-2025 13:03:04 UTC] DEBUG Login - Rol asignado: admin
[02-Oct-2025 13:03:04 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:03:04 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[02-Oct-2025 13:03:04 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:03:06 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:03:06 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[02-Oct-2025 13:03:06 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:03:06 UTC] DEBUG getListaTickets - Summary raw: {"total_vendido":null,"total_ganadores":null,"total_pagados":null,"total_devoluciones":0}
[02-Oct-2025 13:03:06 UTC] DEBUG getListaTickets - Resultado final: {"total_vendido":0,"total_ganadores":0,"total_pagados":0,"total_devoluciones":0,"ganancia":0}
[02-Oct-2025 13:03:06 UTC] DEBUG - Consulta SQL ejecutada: 
            SELECT 
                cr.fecha,
                cr.nro_caballo,
                COALESCE(SUM(dt.total_apostado), 0) as total_apostado,
                COALESCE(SUM(CASE WHEN crd.devolucion = 0 THEN dt.total_apostado ELSE 0 END), 0) as monto_a_devolver,
                COALESCE(SUM(CASE WHEN crd.devolucion = 1 THEN dt.total_apostado ELSE 0 END), 0) as monto_devuelto,
                CASE 
                    WHEN SUM(dt.total_apostado) IS NULL OR SUM(dt.total_apostado) = 0 THEN 'Sin Apuestas'
                    WHEN SUM(CASE WHEN crd.devolucion = 0 THEN 1 ELSE 0 END) > 0 
                         AND SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Parcial'
                    WHEN SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Devuelto'
                    ELSE 'Pendiente'
                END as estado_devolucion
            FROM 
                tbl_caballos_retirados_ultimo_momento cr
            LEFT JOIN 
                tbl_caballos_retirados_um_detalle crd ON cr.id_caballo_retirado_ultimo_momento = crd.id_caballo_retirado_ultimo_momento
            LEFT JOIN 
                tbl_detalle_tickets dt ON crd.id_detalle_ticket = dt.id_detalle_ticket
            WHERE 1=1
            AND cr.fecha >= :fecha_desde AND cr.fecha <= :fecha_hasta
            GROUP BY
                cr.fecha, cr.nro_caballo, cr.id_carrera
            ORDER BY
                cr.fecha DESC, cr.nro_caballo ASC
            LIMIT :limit OFFSET :offset
        
[02-Oct-2025 13:03:06 UTC] DEBUG - Parámetros: {":fecha_desde":"2025-09-02",":fecha_hasta":"2025-10-02",":limit":100,":offset":0}
[02-Oct-2025 13:03:06 UTC] DEBUG - Registros obtenidos: 0 de 0 totales
[02-Oct-2025 13:03:06 UTC] DEBUG getCaballosRetirados - Totals raw: {"total_records":0,"total_a_devolver":0,"total_devuelto":0,"total_general":0}
[02-Oct-2025 13:03:06 UTC] DEBUG getCaballosRetirados - Resultado final: {"data":[],"total_records":0,"total_general":0,"total_a_devolver":0,"total_devuelto":0}
[02-Oct-2025 13:03:06 UTC] Acceso a reporte: usuario=1, reporte=informe_parte_venta, filtros={"fecha_desde":"2025-09-02","fecha_hasta":"2025-10-02"}
[02-Oct-2025 13:03:09 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:03:09 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[02-Oct-2025 13:03:09 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:03:09 UTC] DEBUG getListaTickets - Summary raw: {"total_vendido":639780,"total_ganadores":181030.4999847412,"total_pagados":79787.19999694824,"total_devoluciones":0}
[02-Oct-2025 13:03:09 UTC] DEBUG getListaTickets - Resultado final: {"total_vendido":639780,"total_ganadores":181030.4999847412,"total_pagados":79787.19999694824,"total_devoluciones":0,"ganancia":559992.8000030518}
[02-Oct-2025 13:03:09 UTC] DEBUG - Consulta SQL ejecutada: 
            SELECT 
                cr.fecha,
                cr.nro_caballo,
                COALESCE(SUM(dt.total_apostado), 0) as total_apostado,
                COALESCE(SUM(CASE WHEN crd.devolucion = 0 THEN dt.total_apostado ELSE 0 END), 0) as monto_a_devolver,
                COALESCE(SUM(CASE WHEN crd.devolucion = 1 THEN dt.total_apostado ELSE 0 END), 0) as monto_devuelto,
                CASE 
                    WHEN SUM(dt.total_apostado) IS NULL OR SUM(dt.total_apostado) = 0 THEN 'Sin Apuestas'
                    WHEN SUM(CASE WHEN crd.devolucion = 0 THEN 1 ELSE 0 END) > 0 
                         AND SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Parcial'
                    WHEN SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Devuelto'
                    ELSE 'Pendiente'
                END as estado_devolucion
            FROM 
                tbl_caballos_retirados_ultimo_momento cr
            LEFT JOIN 
                tbl_caballos_retirados_um_detalle crd ON cr.id_caballo_retirado_ultimo_momento = crd.id_caballo_retirado_ultimo_momento
            LEFT JOIN 
                tbl_detalle_tickets dt ON crd.id_detalle_ticket = dt.id_detalle_ticket
            WHERE 1=1
            AND cr.fecha >= :fecha_desde AND cr.fecha <= :fecha_hasta
            GROUP BY
                cr.fecha, cr.nro_caballo, cr.id_carrera
            ORDER BY
                cr.fecha DESC, cr.nro_caballo ASC
            LIMIT :limit OFFSET :offset
        
[02-Oct-2025 13:03:09 UTC] DEBUG - Parámetros: {":fecha_desde":"2025-05-01",":fecha_hasta":"2025-10-02",":limit":100,":offset":0}
[02-Oct-2025 13:03:09 UTC] DEBUG - Registros obtenidos: 16 de 16 totales
[02-Oct-2025 13:03:09 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[02-Oct-2025 13:03:09 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[02-Oct-2025 13:03:09 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[02-Oct-2025 13:03:09 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[02-Oct-2025 13:03:09 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[02-Oct-2025 13:03:09 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[02-Oct-2025 13:03:09 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[02-Oct-2025 13:03:09 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[02-Oct-2025 13:03:09 UTC] DEBUG formatearFecha - Input: '2025-07-15' (tipo: string)
[02-Oct-2025 13:03:09 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-15 -> 15/07/2025
[02-Oct-2025 13:03:09 UTC] DEBUG formatearFecha - Input: '2025-07-14' (tipo: string)
[02-Oct-2025 13:03:09 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-14 -> 14/07/2025
[02-Oct-2025 13:03:09 UTC] DEBUG formatearFecha - Input: '2025-07-11' (tipo: string)
[02-Oct-2025 13:03:09 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-11 -> 11/07/2025
[02-Oct-2025 13:03:09 UTC] DEBUG formatearFecha - Input: '2025-07-10' (tipo: string)
[02-Oct-2025 13:03:09 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-10 -> 10/07/2025
[02-Oct-2025 13:03:09 UTC] DEBUG formatearFecha - Input: '2025-07-08' (tipo: string)
[02-Oct-2025 13:03:09 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-08 -> 08/07/2025
[02-Oct-2025 13:03:09 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[02-Oct-2025 13:03:09 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[02-Oct-2025 13:03:09 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[02-Oct-2025 13:03:09 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[02-Oct-2025 13:03:09 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[02-Oct-2025 13:03:09 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[02-Oct-2025 13:03:09 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[02-Oct-2025 13:03:09 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[02-Oct-2025 13:03:09 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[02-Oct-2025 13:03:09 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[02-Oct-2025 13:03:09 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[02-Oct-2025 13:03:09 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[02-Oct-2025 13:03:09 UTC] DEBUG formatearFecha - Input: '2025-06-27' (tipo: string)
[02-Oct-2025 13:03:09 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-06-27 -> 27/06/2025
[02-Oct-2025 13:03:09 UTC] DEBUG getCaballosRetirados - Totals raw: {"total_records":16,"total_a_devolver":45310,"total_devuelto":5300,"total_general":50610}
[02-Oct-2025 13:03:09 UTC] DEBUG getCaballosRetirados - Resultado final: {"data":[{"fecha":"29\/07\/2025","nro_caballo":1,"total_apostado":2200,"monto_a_devolver":2200,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"29\/07\/2025","nro_caballo":6,"total_apostado":2000,"monto_a_devolver":2000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"17\/07\/2025","nro_caballo":1,"total_apostado":16000,"monto_a_devolver":16000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"17\/07\/2025","nro_caballo":8,"total_apostado":8000,"monto_a_devolver":8000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"15\/07\/2025","nro_caballo":1,"total_apostado":4000,"monto_a_devolver":4000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"14\/07\/2025","nro_caballo":4,"total_apostado":13000,"monto_a_devolver":13000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"11\/07\/2025","nro_caballo":4,"total_apostado":4000,"monto_a_devolver":0,"monto_devuelto":4000,"estado_devolucion":"Devuelto"},{"fecha":"10\/07\/2025","nro_caballo":7,"total_apostado":800,"monto_a_devolver":0,"monto_devuelto":800,"estado_devolucion":"Devuelto"},{"fecha":"08\/07\/2025","nro_caballo":7,"total_apostado":410,"monto_a_devolver":110,"monto_devuelto":300,"estado_devolucion":"Parcial"},{"fecha":"04\/07\/2025","nro_caballo":1,"total_apostado":100,"monto_a_devolver":0,"monto_devuelto":100,"estado_devolucion":"Devuelto"},{"fecha":"04\/07\/2025","nro_caballo":6,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"02\/07\/2025","nro_caballo":4,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"02\/07\/2025","nro_caballo":8,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"01\/07\/2025","nro_caballo":1,"total_apostado":100,"monto_a_devolver":0,"monto_devuelto":100,"estado_devolucion":"Devuelto"},{"fecha":"01\/07\/2025","nro_caballo":4,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"27\/06\/2025","nro_caballo":12,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"}],"total_records":16,"total_general":50610,"total_a_devolver":45310,"total_devuelto":5300}
[02-Oct-2025 13:03:09 UTC] Acceso a reporte: usuario=1, reporte=informe_parte_venta, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-02"}
[02-Oct-2025 13:03:37 UTC] PHP Fatal error:  Uncaught Error: Call to undefined method TurfReports\Controllers\AuthController::verify() in /var/www/html/Routes/api.php:121
Stack trace:
#0 {main}
  thrown in /var/www/html/Routes/api.php on line 121
[02-Oct-2025 13:03:38 UTC] DEBUG Login - Usuario encontrado: SÍ
[02-Oct-2025 13:03:38 UTC] DEBUG Login - Login BD: carreras2024
[02-Oct-2025 13:03:38 UTC] DEBUG Login - Login enviado: carreras2024
[02-Oct-2025 13:03:38 UTC] DEBUG Login - Contraseña BD: 0192023a7bbd73250516f069df18b500
[02-Oct-2025 13:03:38 UTC] DEBUG Login - Contraseña enviada: admin123
[02-Oct-2025 13:03:38 UTC] DEBUG Login - Contraseña MD5: 0192023a7bbd73250516f069df18b500
[02-Oct-2025 13:03:38 UTC] DEBUG Login - Coinciden MD5: SÍ
[02-Oct-2025 13:03:38 UTC] DEBUG Login - id_perfil: 1 (tipo: integer)
[02-Oct-2025 13:03:38 UTC] DEBUG Login - Rol asignado: admin
[02-Oct-2025 13:03:38 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:03:38 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[02-Oct-2025 13:03:38 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:03:39 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:03:39 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[02-Oct-2025 13:03:39 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:03:39 UTC] DEBUG getListaTickets - Summary raw: {"total_vendido":null,"total_ganadores":null,"total_pagados":null,"total_devoluciones":0}
[02-Oct-2025 13:03:39 UTC] DEBUG getListaTickets - Resultado final: {"total_vendido":0,"total_ganadores":0,"total_pagados":0,"total_devoluciones":0,"ganancia":0}
[02-Oct-2025 13:03:39 UTC] DEBUG - Consulta SQL ejecutada: 
            SELECT 
                cr.fecha,
                cr.nro_caballo,
                COALESCE(SUM(dt.total_apostado), 0) as total_apostado,
                COALESCE(SUM(CASE WHEN crd.devolucion = 0 THEN dt.total_apostado ELSE 0 END), 0) as monto_a_devolver,
                COALESCE(SUM(CASE WHEN crd.devolucion = 1 THEN dt.total_apostado ELSE 0 END), 0) as monto_devuelto,
                CASE 
                    WHEN SUM(dt.total_apostado) IS NULL OR SUM(dt.total_apostado) = 0 THEN 'Sin Apuestas'
                    WHEN SUM(CASE WHEN crd.devolucion = 0 THEN 1 ELSE 0 END) > 0 
                         AND SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Parcial'
                    WHEN SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Devuelto'
                    ELSE 'Pendiente'
                END as estado_devolucion
            FROM 
                tbl_caballos_retirados_ultimo_momento cr
            LEFT JOIN 
                tbl_caballos_retirados_um_detalle crd ON cr.id_caballo_retirado_ultimo_momento = crd.id_caballo_retirado_ultimo_momento
            LEFT JOIN 
                tbl_detalle_tickets dt ON crd.id_detalle_ticket = dt.id_detalle_ticket
            WHERE 1=1
            AND cr.fecha >= :fecha_desde AND cr.fecha <= :fecha_hasta
            GROUP BY
                cr.fecha, cr.nro_caballo, cr.id_carrera
            ORDER BY
                cr.fecha DESC, cr.nro_caballo ASC
            LIMIT :limit OFFSET :offset
        
[02-Oct-2025 13:03:39 UTC] DEBUG - Parámetros: {":fecha_desde":"2025-09-02",":fecha_hasta":"2025-10-02",":limit":100,":offset":0}
[02-Oct-2025 13:03:39 UTC] DEBUG - Registros obtenidos: 0 de 0 totales
[02-Oct-2025 13:03:39 UTC] DEBUG getCaballosRetirados - Totals raw: {"total_records":0,"total_a_devolver":0,"total_devuelto":0,"total_general":0}
[02-Oct-2025 13:03:39 UTC] DEBUG getCaballosRetirados - Resultado final: {"data":[],"total_records":0,"total_general":0,"total_a_devolver":0,"total_devuelto":0}
[02-Oct-2025 13:03:39 UTC] Acceso a reporte: usuario=1, reporte=informe_parte_venta, filtros={"fecha_desde":"2025-09-02","fecha_hasta":"2025-10-02"}
[02-Oct-2025 13:03:43 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:03:43 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[02-Oct-2025 13:03:43 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:03:43 UTC] DEBUG getListaTickets - Summary raw: {"total_vendido":639780,"total_ganadores":181030.4999847412,"total_pagados":79787.19999694824,"total_devoluciones":0}
[02-Oct-2025 13:03:43 UTC] DEBUG getListaTickets - Resultado final: {"total_vendido":639780,"total_ganadores":181030.4999847412,"total_pagados":79787.19999694824,"total_devoluciones":0,"ganancia":559992.8000030518}
[02-Oct-2025 13:03:43 UTC] DEBUG - Consulta SQL ejecutada: 
            SELECT 
                cr.fecha,
                cr.nro_caballo,
                COALESCE(SUM(dt.total_apostado), 0) as total_apostado,
                COALESCE(SUM(CASE WHEN crd.devolucion = 0 THEN dt.total_apostado ELSE 0 END), 0) as monto_a_devolver,
                COALESCE(SUM(CASE WHEN crd.devolucion = 1 THEN dt.total_apostado ELSE 0 END), 0) as monto_devuelto,
                CASE 
                    WHEN SUM(dt.total_apostado) IS NULL OR SUM(dt.total_apostado) = 0 THEN 'Sin Apuestas'
                    WHEN SUM(CASE WHEN crd.devolucion = 0 THEN 1 ELSE 0 END) > 0 
                         AND SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Parcial'
                    WHEN SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Devuelto'
                    ELSE 'Pendiente'
                END as estado_devolucion
            FROM 
                tbl_caballos_retirados_ultimo_momento cr
            LEFT JOIN 
                tbl_caballos_retirados_um_detalle crd ON cr.id_caballo_retirado_ultimo_momento = crd.id_caballo_retirado_ultimo_momento
            LEFT JOIN 
                tbl_detalle_tickets dt ON crd.id_detalle_ticket = dt.id_detalle_ticket
            WHERE 1=1
            AND cr.fecha >= :fecha_desde AND cr.fecha <= :fecha_hasta
            GROUP BY
                cr.fecha, cr.nro_caballo, cr.id_carrera
            ORDER BY
                cr.fecha DESC, cr.nro_caballo ASC
            LIMIT :limit OFFSET :offset
        
[02-Oct-2025 13:03:43 UTC] DEBUG - Parámetros: {":fecha_desde":"2025-05-01",":fecha_hasta":"2025-10-02",":limit":100,":offset":0}
[02-Oct-2025 13:03:43 UTC] DEBUG - Registros obtenidos: 16 de 16 totales
[02-Oct-2025 13:03:43 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[02-Oct-2025 13:03:43 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[02-Oct-2025 13:03:43 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[02-Oct-2025 13:03:43 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[02-Oct-2025 13:03:43 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[02-Oct-2025 13:03:43 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[02-Oct-2025 13:03:43 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[02-Oct-2025 13:03:43 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[02-Oct-2025 13:03:43 UTC] DEBUG formatearFecha - Input: '2025-07-15' (tipo: string)
[02-Oct-2025 13:03:43 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-15 -> 15/07/2025
[02-Oct-2025 13:03:43 UTC] DEBUG formatearFecha - Input: '2025-07-14' (tipo: string)
[02-Oct-2025 13:03:43 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-14 -> 14/07/2025
[02-Oct-2025 13:03:43 UTC] DEBUG formatearFecha - Input: '2025-07-11' (tipo: string)
[02-Oct-2025 13:03:43 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-11 -> 11/07/2025
[02-Oct-2025 13:03:43 UTC] DEBUG formatearFecha - Input: '2025-07-10' (tipo: string)
[02-Oct-2025 13:03:43 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-10 -> 10/07/2025
[02-Oct-2025 13:03:43 UTC] DEBUG formatearFecha - Input: '2025-07-08' (tipo: string)
[02-Oct-2025 13:03:43 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-08 -> 08/07/2025
[02-Oct-2025 13:03:43 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[02-Oct-2025 13:03:43 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[02-Oct-2025 13:03:43 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[02-Oct-2025 13:03:43 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[02-Oct-2025 13:03:43 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[02-Oct-2025 13:03:43 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[02-Oct-2025 13:03:43 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[02-Oct-2025 13:03:43 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[02-Oct-2025 13:03:43 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[02-Oct-2025 13:03:43 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[02-Oct-2025 13:03:43 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[02-Oct-2025 13:03:43 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[02-Oct-2025 13:03:43 UTC] DEBUG formatearFecha - Input: '2025-06-27' (tipo: string)
[02-Oct-2025 13:03:43 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-06-27 -> 27/06/2025
[02-Oct-2025 13:03:43 UTC] DEBUG getCaballosRetirados - Totals raw: {"total_records":16,"total_a_devolver":45310,"total_devuelto":5300,"total_general":50610}
[02-Oct-2025 13:03:43 UTC] DEBUG getCaballosRetirados - Resultado final: {"data":[{"fecha":"29\/07\/2025","nro_caballo":1,"total_apostado":2200,"monto_a_devolver":2200,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"29\/07\/2025","nro_caballo":6,"total_apostado":2000,"monto_a_devolver":2000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"17\/07\/2025","nro_caballo":1,"total_apostado":16000,"monto_a_devolver":16000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"17\/07\/2025","nro_caballo":8,"total_apostado":8000,"monto_a_devolver":8000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"15\/07\/2025","nro_caballo":1,"total_apostado":4000,"monto_a_devolver":4000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"14\/07\/2025","nro_caballo":4,"total_apostado":13000,"monto_a_devolver":13000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"11\/07\/2025","nro_caballo":4,"total_apostado":4000,"monto_a_devolver":0,"monto_devuelto":4000,"estado_devolucion":"Devuelto"},{"fecha":"10\/07\/2025","nro_caballo":7,"total_apostado":800,"monto_a_devolver":0,"monto_devuelto":800,"estado_devolucion":"Devuelto"},{"fecha":"08\/07\/2025","nro_caballo":7,"total_apostado":410,"monto_a_devolver":110,"monto_devuelto":300,"estado_devolucion":"Parcial"},{"fecha":"04\/07\/2025","nro_caballo":1,"total_apostado":100,"monto_a_devolver":0,"monto_devuelto":100,"estado_devolucion":"Devuelto"},{"fecha":"04\/07\/2025","nro_caballo":6,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"02\/07\/2025","nro_caballo":4,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"02\/07\/2025","nro_caballo":8,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"01\/07\/2025","nro_caballo":1,"total_apostado":100,"monto_a_devolver":0,"monto_devuelto":100,"estado_devolucion":"Devuelto"},{"fecha":"01\/07\/2025","nro_caballo":4,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"27\/06\/2025","nro_caballo":12,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"}],"total_records":16,"total_general":50610,"total_a_devolver":45310,"total_devuelto":5300}
[02-Oct-2025 13:03:43 UTC] Acceso a reporte: usuario=1, reporte=informe_parte_venta, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-02"}
[02-Oct-2025 13:04:37 UTC] PHP Fatal error:  Uncaught Error: Call to undefined method TurfReports\Controllers\AuthController::verify() in /var/www/html/Routes/api.php:121
Stack trace:
#0 {main}
  thrown in /var/www/html/Routes/api.php on line 121
[02-Oct-2025 13:04:37 UTC] DEBUG Login - Usuario encontrado: SÍ
[02-Oct-2025 13:04:37 UTC] DEBUG Login - Login BD: carreras2024
[02-Oct-2025 13:04:37 UTC] DEBUG Login - Login enviado: carreras2024
[02-Oct-2025 13:04:37 UTC] DEBUG Login - Contraseña BD: 0192023a7bbd73250516f069df18b500
[02-Oct-2025 13:04:37 UTC] DEBUG Login - Contraseña enviada: admin123
[02-Oct-2025 13:04:37 UTC] DEBUG Login - Contraseña MD5: 0192023a7bbd73250516f069df18b500
[02-Oct-2025 13:04:37 UTC] DEBUG Login - Coinciden MD5: SÍ
[02-Oct-2025 13:04:37 UTC] DEBUG Login - id_perfil: 1 (tipo: integer)
[02-Oct-2025 13:04:37 UTC] DEBUG Login - Rol asignado: admin
[02-Oct-2025 13:04:37 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:04:37 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[02-Oct-2025 13:04:37 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:04:38 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:04:38 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[02-Oct-2025 13:04:38 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:04:38 UTC] DEBUG getListaTickets - Summary raw: {"total_vendido":null,"total_ganadores":null,"total_pagados":null,"total_devoluciones":0}
[02-Oct-2025 13:04:38 UTC] DEBUG getListaTickets - Resultado final: {"total_vendido":0,"total_ganadores":0,"total_pagados":0,"total_devoluciones":0,"ganancia":0}
[02-Oct-2025 13:04:38 UTC] DEBUG - Consulta SQL ejecutada: 
            SELECT 
                cr.fecha,
                cr.nro_caballo,
                COALESCE(SUM(dt.total_apostado), 0) as total_apostado,
                COALESCE(SUM(CASE WHEN crd.devolucion = 0 THEN dt.total_apostado ELSE 0 END), 0) as monto_a_devolver,
                COALESCE(SUM(CASE WHEN crd.devolucion = 1 THEN dt.total_apostado ELSE 0 END), 0) as monto_devuelto,
                CASE 
                    WHEN SUM(dt.total_apostado) IS NULL OR SUM(dt.total_apostado) = 0 THEN 'Sin Apuestas'
                    WHEN SUM(CASE WHEN crd.devolucion = 0 THEN 1 ELSE 0 END) > 0 
                         AND SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Parcial'
                    WHEN SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Devuelto'
                    ELSE 'Pendiente'
                END as estado_devolucion
            FROM 
                tbl_caballos_retirados_ultimo_momento cr
            LEFT JOIN 
                tbl_caballos_retirados_um_detalle crd ON cr.id_caballo_retirado_ultimo_momento = crd.id_caballo_retirado_ultimo_momento
            LEFT JOIN 
                tbl_detalle_tickets dt ON crd.id_detalle_ticket = dt.id_detalle_ticket
            WHERE 1=1
            AND cr.fecha >= :fecha_desde AND cr.fecha <= :fecha_hasta
            GROUP BY
                cr.fecha, cr.nro_caballo, cr.id_carrera
            ORDER BY
                cr.fecha DESC, cr.nro_caballo ASC
            LIMIT :limit OFFSET :offset
        
[02-Oct-2025 13:04:38 UTC] DEBUG - Parámetros: {":fecha_desde":"2025-09-02",":fecha_hasta":"2025-10-02",":limit":100,":offset":0}
[02-Oct-2025 13:04:38 UTC] DEBUG - Registros obtenidos: 0 de 0 totales
[02-Oct-2025 13:04:38 UTC] DEBUG getCaballosRetirados - Totals raw: {"total_records":0,"total_a_devolver":0,"total_devuelto":0,"total_general":0}
[02-Oct-2025 13:04:38 UTC] DEBUG getCaballosRetirados - Resultado final: {"data":[],"total_records":0,"total_general":0,"total_a_devolver":0,"total_devuelto":0}
[02-Oct-2025 13:04:38 UTC] Acceso a reporte: usuario=1, reporte=informe_parte_venta, filtros={"fecha_desde":"2025-09-02","fecha_hasta":"2025-10-02"}
[02-Oct-2025 13:04:42 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:04:42 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[02-Oct-2025 13:04:42 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:04:42 UTC] DEBUG getListaTickets - Summary raw: {"total_vendido":639780,"total_ganadores":181030.4999847412,"total_pagados":79787.19999694824,"total_devoluciones":0}
[02-Oct-2025 13:04:42 UTC] DEBUG getListaTickets - Resultado final: {"total_vendido":639780,"total_ganadores":181030.4999847412,"total_pagados":79787.19999694824,"total_devoluciones":0,"ganancia":559992.8000030518}
[02-Oct-2025 13:04:42 UTC] DEBUG - Consulta SQL ejecutada: 
            SELECT 
                cr.fecha,
                cr.nro_caballo,
                COALESCE(SUM(dt.total_apostado), 0) as total_apostado,
                COALESCE(SUM(CASE WHEN crd.devolucion = 0 THEN dt.total_apostado ELSE 0 END), 0) as monto_a_devolver,
                COALESCE(SUM(CASE WHEN crd.devolucion = 1 THEN dt.total_apostado ELSE 0 END), 0) as monto_devuelto,
                CASE 
                    WHEN SUM(dt.total_apostado) IS NULL OR SUM(dt.total_apostado) = 0 THEN 'Sin Apuestas'
                    WHEN SUM(CASE WHEN crd.devolucion = 0 THEN 1 ELSE 0 END) > 0 
                         AND SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Parcial'
                    WHEN SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Devuelto'
                    ELSE 'Pendiente'
                END as estado_devolucion
            FROM 
                tbl_caballos_retirados_ultimo_momento cr
            LEFT JOIN 
                tbl_caballos_retirados_um_detalle crd ON cr.id_caballo_retirado_ultimo_momento = crd.id_caballo_retirado_ultimo_momento
            LEFT JOIN 
                tbl_detalle_tickets dt ON crd.id_detalle_ticket = dt.id_detalle_ticket
            WHERE 1=1
            AND cr.fecha >= :fecha_desde AND cr.fecha <= :fecha_hasta
            GROUP BY
                cr.fecha, cr.nro_caballo, cr.id_carrera
            ORDER BY
                cr.fecha DESC, cr.nro_caballo ASC
            LIMIT :limit OFFSET :offset
        
[02-Oct-2025 13:04:42 UTC] DEBUG - Parámetros: {":fecha_desde":"2025-05-01",":fecha_hasta":"2025-10-02",":limit":100,":offset":0}
[02-Oct-2025 13:04:42 UTC] DEBUG - Registros obtenidos: 16 de 16 totales
[02-Oct-2025 13:04:42 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[02-Oct-2025 13:04:42 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[02-Oct-2025 13:04:42 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[02-Oct-2025 13:04:42 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[02-Oct-2025 13:04:42 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[02-Oct-2025 13:04:42 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[02-Oct-2025 13:04:42 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[02-Oct-2025 13:04:42 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[02-Oct-2025 13:04:42 UTC] DEBUG formatearFecha - Input: '2025-07-15' (tipo: string)
[02-Oct-2025 13:04:42 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-15 -> 15/07/2025
[02-Oct-2025 13:04:42 UTC] DEBUG formatearFecha - Input: '2025-07-14' (tipo: string)
[02-Oct-2025 13:04:42 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-14 -> 14/07/2025
[02-Oct-2025 13:04:42 UTC] DEBUG formatearFecha - Input: '2025-07-11' (tipo: string)
[02-Oct-2025 13:04:42 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-11 -> 11/07/2025
[02-Oct-2025 13:04:42 UTC] DEBUG formatearFecha - Input: '2025-07-10' (tipo: string)
[02-Oct-2025 13:04:42 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-10 -> 10/07/2025
[02-Oct-2025 13:04:42 UTC] DEBUG formatearFecha - Input: '2025-07-08' (tipo: string)
[02-Oct-2025 13:04:42 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-08 -> 08/07/2025
[02-Oct-2025 13:04:42 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[02-Oct-2025 13:04:42 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[02-Oct-2025 13:04:42 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[02-Oct-2025 13:04:42 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[02-Oct-2025 13:04:42 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[02-Oct-2025 13:04:42 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[02-Oct-2025 13:04:42 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[02-Oct-2025 13:04:42 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[02-Oct-2025 13:04:42 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[02-Oct-2025 13:04:42 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[02-Oct-2025 13:04:42 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[02-Oct-2025 13:04:42 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[02-Oct-2025 13:04:42 UTC] DEBUG formatearFecha - Input: '2025-06-27' (tipo: string)
[02-Oct-2025 13:04:42 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-06-27 -> 27/06/2025
[02-Oct-2025 13:04:42 UTC] DEBUG getCaballosRetirados - Totals raw: {"total_records":16,"total_a_devolver":45310,"total_devuelto":5300,"total_general":50610}
[02-Oct-2025 13:04:42 UTC] DEBUG getCaballosRetirados - Resultado final: {"data":[{"fecha":"29\/07\/2025","nro_caballo":1,"total_apostado":2200,"monto_a_devolver":2200,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"29\/07\/2025","nro_caballo":6,"total_apostado":2000,"monto_a_devolver":2000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"17\/07\/2025","nro_caballo":1,"total_apostado":16000,"monto_a_devolver":16000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"17\/07\/2025","nro_caballo":8,"total_apostado":8000,"monto_a_devolver":8000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"15\/07\/2025","nro_caballo":1,"total_apostado":4000,"monto_a_devolver":4000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"14\/07\/2025","nro_caballo":4,"total_apostado":13000,"monto_a_devolver":13000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"11\/07\/2025","nro_caballo":4,"total_apostado":4000,"monto_a_devolver":0,"monto_devuelto":4000,"estado_devolucion":"Devuelto"},{"fecha":"10\/07\/2025","nro_caballo":7,"total_apostado":800,"monto_a_devolver":0,"monto_devuelto":800,"estado_devolucion":"Devuelto"},{"fecha":"08\/07\/2025","nro_caballo":7,"total_apostado":410,"monto_a_devolver":110,"monto_devuelto":300,"estado_devolucion":"Parcial"},{"fecha":"04\/07\/2025","nro_caballo":1,"total_apostado":100,"monto_a_devolver":0,"monto_devuelto":100,"estado_devolucion":"Devuelto"},{"fecha":"04\/07\/2025","nro_caballo":6,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"02\/07\/2025","nro_caballo":4,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"02\/07\/2025","nro_caballo":8,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"01\/07\/2025","nro_caballo":1,"total_apostado":100,"monto_a_devolver":0,"monto_devuelto":100,"estado_devolucion":"Devuelto"},{"fecha":"01\/07\/2025","nro_caballo":4,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"27\/06\/2025","nro_caballo":12,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"}],"total_records":16,"total_general":50610,"total_a_devolver":45310,"total_devuelto":5300}
[02-Oct-2025 13:04:42 UTC] Acceso a reporte: usuario=1, reporte=informe_parte_venta, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-02"}
[02-Oct-2025 13:05:02 UTC] PHP Fatal error:  Uncaught Error: Call to undefined method TurfReports\Controllers\AuthController::verify() in /var/www/html/Routes/api.php:121
Stack trace:
#0 {main}
  thrown in /var/www/html/Routes/api.php on line 121
[02-Oct-2025 13:05:04 UTC] DEBUG Login - Usuario encontrado: SÍ
[02-Oct-2025 13:05:04 UTC] DEBUG Login - Login BD: carreras2024
[02-Oct-2025 13:05:04 UTC] DEBUG Login - Login enviado: carreras2024
[02-Oct-2025 13:05:04 UTC] DEBUG Login - Contraseña BD: 0192023a7bbd73250516f069df18b500
[02-Oct-2025 13:05:04 UTC] DEBUG Login - Contraseña enviada: admin123
[02-Oct-2025 13:05:04 UTC] DEBUG Login - Contraseña MD5: 0192023a7bbd73250516f069df18b500
[02-Oct-2025 13:05:04 UTC] DEBUG Login - Coinciden MD5: SÍ
[02-Oct-2025 13:05:04 UTC] DEBUG Login - id_perfil: 1 (tipo: integer)
[02-Oct-2025 13:05:04 UTC] DEBUG Login - Rol asignado: admin
[02-Oct-2025 13:05:04 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:05:04 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[02-Oct-2025 13:05:04 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:05:05 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:05:05 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[02-Oct-2025 13:05:05 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:05:05 UTC] DEBUG getListaTickets - Summary raw: {"total_vendido":null,"total_ganadores":null,"total_pagados":null,"total_devoluciones":0}
[02-Oct-2025 13:05:05 UTC] DEBUG getListaTickets - Resultado final: {"total_vendido":0,"total_ganadores":0,"total_pagados":0,"total_devoluciones":0,"ganancia":0}
[02-Oct-2025 13:05:05 UTC] DEBUG - Consulta SQL ejecutada: 
            SELECT 
                cr.fecha,
                cr.nro_caballo,
                COALESCE(SUM(dt.total_apostado), 0) as total_apostado,
                COALESCE(SUM(CASE WHEN crd.devolucion = 0 THEN dt.total_apostado ELSE 0 END), 0) as monto_a_devolver,
                COALESCE(SUM(CASE WHEN crd.devolucion = 1 THEN dt.total_apostado ELSE 0 END), 0) as monto_devuelto,
                CASE 
                    WHEN SUM(dt.total_apostado) IS NULL OR SUM(dt.total_apostado) = 0 THEN 'Sin Apuestas'
                    WHEN SUM(CASE WHEN crd.devolucion = 0 THEN 1 ELSE 0 END) > 0 
                         AND SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Parcial'
                    WHEN SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Devuelto'
                    ELSE 'Pendiente'
                END as estado_devolucion
            FROM 
                tbl_caballos_retirados_ultimo_momento cr
            LEFT JOIN 
                tbl_caballos_retirados_um_detalle crd ON cr.id_caballo_retirado_ultimo_momento = crd.id_caballo_retirado_ultimo_momento
            LEFT JOIN 
                tbl_detalle_tickets dt ON crd.id_detalle_ticket = dt.id_detalle_ticket
            WHERE 1=1
            AND cr.fecha >= :fecha_desde AND cr.fecha <= :fecha_hasta
            GROUP BY
                cr.fecha, cr.nro_caballo, cr.id_carrera
            ORDER BY
                cr.fecha DESC, cr.nro_caballo ASC
            LIMIT :limit OFFSET :offset
        
[02-Oct-2025 13:05:05 UTC] DEBUG - Parámetros: {":fecha_desde":"2025-09-02",":fecha_hasta":"2025-10-02",":limit":100,":offset":0}
[02-Oct-2025 13:05:05 UTC] DEBUG - Registros obtenidos: 0 de 0 totales
[02-Oct-2025 13:05:05 UTC] DEBUG getCaballosRetirados - Totals raw: {"total_records":0,"total_a_devolver":0,"total_devuelto":0,"total_general":0}
[02-Oct-2025 13:05:05 UTC] DEBUG getCaballosRetirados - Resultado final: {"data":[],"total_records":0,"total_general":0,"total_a_devolver":0,"total_devuelto":0}
[02-Oct-2025 13:05:05 UTC] Acceso a reporte: usuario=1, reporte=informe_parte_venta, filtros={"fecha_desde":"2025-09-02","fecha_hasta":"2025-10-02"}
[02-Oct-2025 13:05:08 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:05:08 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[02-Oct-2025 13:05:08 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:05:08 UTC] DEBUG getListaTickets - Summary raw: {"total_vendido":639780,"total_ganadores":181030.4999847412,"total_pagados":79787.19999694824,"total_devoluciones":0}
[02-Oct-2025 13:05:08 UTC] DEBUG getListaTickets - Resultado final: {"total_vendido":639780,"total_ganadores":181030.4999847412,"total_pagados":79787.19999694824,"total_devoluciones":0,"ganancia":559992.8000030518}
[02-Oct-2025 13:05:08 UTC] DEBUG - Consulta SQL ejecutada: 
            SELECT 
                cr.fecha,
                cr.nro_caballo,
                COALESCE(SUM(dt.total_apostado), 0) as total_apostado,
                COALESCE(SUM(CASE WHEN crd.devolucion = 0 THEN dt.total_apostado ELSE 0 END), 0) as monto_a_devolver,
                COALESCE(SUM(CASE WHEN crd.devolucion = 1 THEN dt.total_apostado ELSE 0 END), 0) as monto_devuelto,
                CASE 
                    WHEN SUM(dt.total_apostado) IS NULL OR SUM(dt.total_apostado) = 0 THEN 'Sin Apuestas'
                    WHEN SUM(CASE WHEN crd.devolucion = 0 THEN 1 ELSE 0 END) > 0 
                         AND SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Parcial'
                    WHEN SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Devuelto'
                    ELSE 'Pendiente'
                END as estado_devolucion
            FROM 
                tbl_caballos_retirados_ultimo_momento cr
            LEFT JOIN 
                tbl_caballos_retirados_um_detalle crd ON cr.id_caballo_retirado_ultimo_momento = crd.id_caballo_retirado_ultimo_momento
            LEFT JOIN 
                tbl_detalle_tickets dt ON crd.id_detalle_ticket = dt.id_detalle_ticket
            WHERE 1=1
            AND cr.fecha >= :fecha_desde AND cr.fecha <= :fecha_hasta
            GROUP BY
                cr.fecha, cr.nro_caballo, cr.id_carrera
            ORDER BY
                cr.fecha DESC, cr.nro_caballo ASC
            LIMIT :limit OFFSET :offset
        
[02-Oct-2025 13:05:08 UTC] DEBUG - Parámetros: {":fecha_desde":"2025-05-01",":fecha_hasta":"2025-10-02",":limit":100,":offset":0}
[02-Oct-2025 13:05:08 UTC] DEBUG - Registros obtenidos: 16 de 16 totales
[02-Oct-2025 13:05:08 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[02-Oct-2025 13:05:08 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[02-Oct-2025 13:05:08 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[02-Oct-2025 13:05:08 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[02-Oct-2025 13:05:08 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[02-Oct-2025 13:05:08 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[02-Oct-2025 13:05:08 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[02-Oct-2025 13:05:08 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[02-Oct-2025 13:05:08 UTC] DEBUG formatearFecha - Input: '2025-07-15' (tipo: string)
[02-Oct-2025 13:05:08 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-15 -> 15/07/2025
[02-Oct-2025 13:05:08 UTC] DEBUG formatearFecha - Input: '2025-07-14' (tipo: string)
[02-Oct-2025 13:05:08 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-14 -> 14/07/2025
[02-Oct-2025 13:05:08 UTC] DEBUG formatearFecha - Input: '2025-07-11' (tipo: string)
[02-Oct-2025 13:05:08 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-11 -> 11/07/2025
[02-Oct-2025 13:05:08 UTC] DEBUG formatearFecha - Input: '2025-07-10' (tipo: string)
[02-Oct-2025 13:05:08 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-10 -> 10/07/2025
[02-Oct-2025 13:05:08 UTC] DEBUG formatearFecha - Input: '2025-07-08' (tipo: string)
[02-Oct-2025 13:05:08 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-08 -> 08/07/2025
[02-Oct-2025 13:05:08 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[02-Oct-2025 13:05:08 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[02-Oct-2025 13:05:08 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[02-Oct-2025 13:05:08 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[02-Oct-2025 13:05:08 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[02-Oct-2025 13:05:08 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[02-Oct-2025 13:05:08 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[02-Oct-2025 13:05:08 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[02-Oct-2025 13:05:08 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[02-Oct-2025 13:05:08 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[02-Oct-2025 13:05:08 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[02-Oct-2025 13:05:08 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[02-Oct-2025 13:05:08 UTC] DEBUG formatearFecha - Input: '2025-06-27' (tipo: string)
[02-Oct-2025 13:05:08 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-06-27 -> 27/06/2025
[02-Oct-2025 13:05:08 UTC] DEBUG getCaballosRetirados - Totals raw: {"total_records":16,"total_a_devolver":45310,"total_devuelto":5300,"total_general":50610}
[02-Oct-2025 13:05:08 UTC] DEBUG getCaballosRetirados - Resultado final: {"data":[{"fecha":"29\/07\/2025","nro_caballo":1,"total_apostado":2200,"monto_a_devolver":2200,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"29\/07\/2025","nro_caballo":6,"total_apostado":2000,"monto_a_devolver":2000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"17\/07\/2025","nro_caballo":1,"total_apostado":16000,"monto_a_devolver":16000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"17\/07\/2025","nro_caballo":8,"total_apostado":8000,"monto_a_devolver":8000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"15\/07\/2025","nro_caballo":1,"total_apostado":4000,"monto_a_devolver":4000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"14\/07\/2025","nro_caballo":4,"total_apostado":13000,"monto_a_devolver":13000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"11\/07\/2025","nro_caballo":4,"total_apostado":4000,"monto_a_devolver":0,"monto_devuelto":4000,"estado_devolucion":"Devuelto"},{"fecha":"10\/07\/2025","nro_caballo":7,"total_apostado":800,"monto_a_devolver":0,"monto_devuelto":800,"estado_devolucion":"Devuelto"},{"fecha":"08\/07\/2025","nro_caballo":7,"total_apostado":410,"monto_a_devolver":110,"monto_devuelto":300,"estado_devolucion":"Parcial"},{"fecha":"04\/07\/2025","nro_caballo":1,"total_apostado":100,"monto_a_devolver":0,"monto_devuelto":100,"estado_devolucion":"Devuelto"},{"fecha":"04\/07\/2025","nro_caballo":6,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"02\/07\/2025","nro_caballo":4,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"02\/07\/2025","nro_caballo":8,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"01\/07\/2025","nro_caballo":1,"total_apostado":100,"monto_a_devolver":0,"monto_devuelto":100,"estado_devolucion":"Devuelto"},{"fecha":"01\/07\/2025","nro_caballo":4,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"27\/06\/2025","nro_caballo":12,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"}],"total_records":16,"total_general":50610,"total_a_devolver":45310,"total_devuelto":5300}
[02-Oct-2025 13:05:08 UTC] Acceso a reporte: usuario=1, reporte=informe_parte_venta, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-02"}
[02-Oct-2025 13:05:59 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:05:59 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[02-Oct-2025 13:05:59 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:05:59 UTC] Acceso a reporte: usuario=1, reporte=informe-por-agencia, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-02"}
[02-Oct-2025 13:06:54 UTC] PHP Fatal error:  Uncaught Error: Call to undefined method TurfReports\Controllers\AuthController::verify() in /var/www/html/Routes/api.php:121
Stack trace:
#0 {main}
  thrown in /var/www/html/Routes/api.php on line 121
[02-Oct-2025 13:06:55 UTC] DEBUG Login - Usuario encontrado: SÍ
[02-Oct-2025 13:06:55 UTC] DEBUG Login - Login BD: carreras2024
[02-Oct-2025 13:06:55 UTC] DEBUG Login - Login enviado: carreras2024
[02-Oct-2025 13:06:55 UTC] DEBUG Login - Contraseña BD: 0192023a7bbd73250516f069df18b500
[02-Oct-2025 13:06:55 UTC] DEBUG Login - Contraseña enviada: admin123
[02-Oct-2025 13:06:55 UTC] DEBUG Login - Contraseña MD5: 0192023a7bbd73250516f069df18b500
[02-Oct-2025 13:06:55 UTC] DEBUG Login - Coinciden MD5: SÍ
[02-Oct-2025 13:06:55 UTC] DEBUG Login - id_perfil: 1 (tipo: integer)
[02-Oct-2025 13:06:55 UTC] DEBUG Login - Rol asignado: admin
[02-Oct-2025 13:06:55 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:06:55 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[02-Oct-2025 13:06:55 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:06:56 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:06:56 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[02-Oct-2025 13:06:56 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:06:56 UTC] DEBUG getListaTickets - Summary raw: {"total_vendido":null,"total_ganadores":null,"total_pagados":null,"total_devoluciones":0}
[02-Oct-2025 13:06:56 UTC] DEBUG getListaTickets - Resultado final: {"total_vendido":0,"total_ganadores":0,"total_pagados":0,"total_devoluciones":0,"ganancia":0}
[02-Oct-2025 13:06:56 UTC] DEBUG - Consulta SQL ejecutada: 
            SELECT 
                cr.fecha,
                cr.nro_caballo,
                COALESCE(SUM(dt.total_apostado), 0) as total_apostado,
                COALESCE(SUM(CASE WHEN crd.devolucion = 0 THEN dt.total_apostado ELSE 0 END), 0) as monto_a_devolver,
                COALESCE(SUM(CASE WHEN crd.devolucion = 1 THEN dt.total_apostado ELSE 0 END), 0) as monto_devuelto,
                CASE 
                    WHEN SUM(dt.total_apostado) IS NULL OR SUM(dt.total_apostado) = 0 THEN 'Sin Apuestas'
                    WHEN SUM(CASE WHEN crd.devolucion = 0 THEN 1 ELSE 0 END) > 0 
                         AND SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Parcial'
                    WHEN SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Devuelto'
                    ELSE 'Pendiente'
                END as estado_devolucion
            FROM 
                tbl_caballos_retirados_ultimo_momento cr
            LEFT JOIN 
                tbl_caballos_retirados_um_detalle crd ON cr.id_caballo_retirado_ultimo_momento = crd.id_caballo_retirado_ultimo_momento
            LEFT JOIN 
                tbl_detalle_tickets dt ON crd.id_detalle_ticket = dt.id_detalle_ticket
            WHERE 1=1
            AND cr.fecha >= :fecha_desde AND cr.fecha <= :fecha_hasta
            GROUP BY
                cr.fecha, cr.nro_caballo, cr.id_carrera
            ORDER BY
                cr.fecha DESC, cr.nro_caballo ASC
            LIMIT :limit OFFSET :offset
        
[02-Oct-2025 13:06:56 UTC] DEBUG - Parámetros: {":fecha_desde":"2025-09-02",":fecha_hasta":"2025-10-02",":limit":100,":offset":0}
[02-Oct-2025 13:06:56 UTC] DEBUG - Registros obtenidos: 0 de 0 totales
[02-Oct-2025 13:06:56 UTC] DEBUG getCaballosRetirados - Totals raw: {"total_records":0,"total_a_devolver":0,"total_devuelto":0,"total_general":0}
[02-Oct-2025 13:06:56 UTC] DEBUG getCaballosRetirados - Resultado final: {"data":[],"total_records":0,"total_general":0,"total_a_devolver":0,"total_devuelto":0}
[02-Oct-2025 13:06:56 UTC] Acceso a reporte: usuario=1, reporte=informe_parte_venta, filtros={"fecha_desde":"2025-09-02","fecha_hasta":"2025-10-02"}
[02-Oct-2025 13:07:01 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:07:01 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[02-Oct-2025 13:07:01 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:07:01 UTC] DEBUG getListaTickets - Summary raw: {"total_vendido":639780,"total_ganadores":181030.4999847412,"total_pagados":79787.19999694824,"total_devoluciones":0}
[02-Oct-2025 13:07:01 UTC] DEBUG getListaTickets - Resultado final: {"total_vendido":639780,"total_ganadores":181030.4999847412,"total_pagados":79787.19999694824,"total_devoluciones":0,"ganancia":559992.8000030518}
[02-Oct-2025 13:07:01 UTC] DEBUG - Consulta SQL ejecutada: 
            SELECT 
                cr.fecha,
                cr.nro_caballo,
                COALESCE(SUM(dt.total_apostado), 0) as total_apostado,
                COALESCE(SUM(CASE WHEN crd.devolucion = 0 THEN dt.total_apostado ELSE 0 END), 0) as monto_a_devolver,
                COALESCE(SUM(CASE WHEN crd.devolucion = 1 THEN dt.total_apostado ELSE 0 END), 0) as monto_devuelto,
                CASE 
                    WHEN SUM(dt.total_apostado) IS NULL OR SUM(dt.total_apostado) = 0 THEN 'Sin Apuestas'
                    WHEN SUM(CASE WHEN crd.devolucion = 0 THEN 1 ELSE 0 END) > 0 
                         AND SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Parcial'
                    WHEN SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Devuelto'
                    ELSE 'Pendiente'
                END as estado_devolucion
            FROM 
                tbl_caballos_retirados_ultimo_momento cr
            LEFT JOIN 
                tbl_caballos_retirados_um_detalle crd ON cr.id_caballo_retirado_ultimo_momento = crd.id_caballo_retirado_ultimo_momento
            LEFT JOIN 
                tbl_detalle_tickets dt ON crd.id_detalle_ticket = dt.id_detalle_ticket
            WHERE 1=1
            AND cr.fecha >= :fecha_desde AND cr.fecha <= :fecha_hasta
            GROUP BY
                cr.fecha, cr.nro_caballo, cr.id_carrera
            ORDER BY
                cr.fecha DESC, cr.nro_caballo ASC
            LIMIT :limit OFFSET :offset
        
[02-Oct-2025 13:07:01 UTC] DEBUG - Parámetros: {":fecha_desde":"2025-05-01",":fecha_hasta":"2025-10-02",":limit":100,":offset":0}
[02-Oct-2025 13:07:01 UTC] DEBUG - Registros obtenidos: 16 de 16 totales
[02-Oct-2025 13:07:01 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[02-Oct-2025 13:07:01 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[02-Oct-2025 13:07:01 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[02-Oct-2025 13:07:01 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[02-Oct-2025 13:07:01 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[02-Oct-2025 13:07:01 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[02-Oct-2025 13:07:01 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[02-Oct-2025 13:07:01 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[02-Oct-2025 13:07:01 UTC] DEBUG formatearFecha - Input: '2025-07-15' (tipo: string)
[02-Oct-2025 13:07:01 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-15 -> 15/07/2025
[02-Oct-2025 13:07:01 UTC] DEBUG formatearFecha - Input: '2025-07-14' (tipo: string)
[02-Oct-2025 13:07:01 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-14 -> 14/07/2025
[02-Oct-2025 13:07:01 UTC] DEBUG formatearFecha - Input: '2025-07-11' (tipo: string)
[02-Oct-2025 13:07:01 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-11 -> 11/07/2025
[02-Oct-2025 13:07:01 UTC] DEBUG formatearFecha - Input: '2025-07-10' (tipo: string)
[02-Oct-2025 13:07:01 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-10 -> 10/07/2025
[02-Oct-2025 13:07:01 UTC] DEBUG formatearFecha - Input: '2025-07-08' (tipo: string)
[02-Oct-2025 13:07:01 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-08 -> 08/07/2025
[02-Oct-2025 13:07:01 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[02-Oct-2025 13:07:01 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[02-Oct-2025 13:07:01 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[02-Oct-2025 13:07:01 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[02-Oct-2025 13:07:01 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[02-Oct-2025 13:07:01 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[02-Oct-2025 13:07:01 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[02-Oct-2025 13:07:01 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[02-Oct-2025 13:07:01 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[02-Oct-2025 13:07:01 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[02-Oct-2025 13:07:01 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[02-Oct-2025 13:07:01 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[02-Oct-2025 13:07:01 UTC] DEBUG formatearFecha - Input: '2025-06-27' (tipo: string)
[02-Oct-2025 13:07:01 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-06-27 -> 27/06/2025
[02-Oct-2025 13:07:01 UTC] DEBUG getCaballosRetirados - Totals raw: {"total_records":16,"total_a_devolver":45310,"total_devuelto":5300,"total_general":50610}
[02-Oct-2025 13:07:01 UTC] DEBUG getCaballosRetirados - Resultado final: {"data":[{"fecha":"29\/07\/2025","nro_caballo":1,"total_apostado":2200,"monto_a_devolver":2200,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"29\/07\/2025","nro_caballo":6,"total_apostado":2000,"monto_a_devolver":2000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"17\/07\/2025","nro_caballo":1,"total_apostado":16000,"monto_a_devolver":16000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"17\/07\/2025","nro_caballo":8,"total_apostado":8000,"monto_a_devolver":8000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"15\/07\/2025","nro_caballo":1,"total_apostado":4000,"monto_a_devolver":4000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"14\/07\/2025","nro_caballo":4,"total_apostado":13000,"monto_a_devolver":13000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"11\/07\/2025","nro_caballo":4,"total_apostado":4000,"monto_a_devolver":0,"monto_devuelto":4000,"estado_devolucion":"Devuelto"},{"fecha":"10\/07\/2025","nro_caballo":7,"total_apostado":800,"monto_a_devolver":0,"monto_devuelto":800,"estado_devolucion":"Devuelto"},{"fecha":"08\/07\/2025","nro_caballo":7,"total_apostado":410,"monto_a_devolver":110,"monto_devuelto":300,"estado_devolucion":"Parcial"},{"fecha":"04\/07\/2025","nro_caballo":1,"total_apostado":100,"monto_a_devolver":0,"monto_devuelto":100,"estado_devolucion":"Devuelto"},{"fecha":"04\/07\/2025","nro_caballo":6,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"02\/07\/2025","nro_caballo":4,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"02\/07\/2025","nro_caballo":8,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"01\/07\/2025","nro_caballo":1,"total_apostado":100,"monto_a_devolver":0,"monto_devuelto":100,"estado_devolucion":"Devuelto"},{"fecha":"01\/07\/2025","nro_caballo":4,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"27\/06\/2025","nro_caballo":12,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"}],"total_records":16,"total_general":50610,"total_a_devolver":45310,"total_devuelto":5300}
[02-Oct-2025 13:07:01 UTC] Acceso a reporte: usuario=1, reporte=informe_parte_venta, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-02"}
[02-Oct-2025 13:07:02 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:07:02 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[02-Oct-2025 13:07:02 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:07:02 UTC] DEBUG Tickets Anulados - Filtros recibidos: {"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-02"}
[02-Oct-2025 13:07:02 UTC] DEBUG Tickets Anulados - WHERE construido: AND STR_TO_DATE(t.fecha, '%d/%m/%Y') >= STR_TO_DATE(:fecha_desde, '%Y-%m-%d') AND STR_TO_DATE(t.fecha, '%d/%m/%Y') <= STR_TO_DATE(:fecha_hasta, '%Y-%m-%d')
[02-Oct-2025 13:07:02 UTC] DEBUG Tickets Anulados - Registros obtenidos: 12
[02-Oct-2025 13:07:02 UTC] DEBUG Tickets Anulados - Primer registro: {"nro_ticket":133,"fecha":"31\/07\/2025","hora":"10:01:20","nombre_usuario":"Agencia 24","nombre_agencia":"Morteros","total_apostado":10000}
[02-Oct-2025 13:07:02 UTC] DEBUG formatearFecha - Input: '31/07/2025' (tipo: string)
[02-Oct-2025 13:07:02 UTC] DEBUG formatearFecha - Ya en formato correcto: 31/07/2025
[02-Oct-2025 13:07:02 UTC] DEBUG formatearFecha - Input: '06/07/2025' (tipo: string)
[02-Oct-2025 13:07:02 UTC] DEBUG formatearFecha - Ya en formato correcto: 06/07/2025
[02-Oct-2025 13:07:02 UTC] DEBUG formatearFecha - Input: '05/07/2025' (tipo: string)
[02-Oct-2025 13:07:02 UTC] DEBUG formatearFecha - Ya en formato correcto: 05/07/2025
[02-Oct-2025 13:07:02 UTC] DEBUG formatearFecha - Input: '04/07/2025' (tipo: string)
[02-Oct-2025 13:07:02 UTC] DEBUG formatearFecha - Ya en formato correcto: 04/07/2025
[02-Oct-2025 13:07:02 UTC] DEBUG formatearFecha - Input: '02/07/2025' (tipo: string)
[02-Oct-2025 13:07:02 UTC] DEBUG formatearFecha - Ya en formato correcto: 02/07/2025
[02-Oct-2025 13:07:02 UTC] DEBUG formatearFecha - Input: '02/07/2025' (tipo: string)
[02-Oct-2025 13:07:02 UTC] DEBUG formatearFecha - Ya en formato correcto: 02/07/2025
[02-Oct-2025 13:07:02 UTC] DEBUG formatearFecha - Input: '02/07/2025' (tipo: string)
[02-Oct-2025 13:07:02 UTC] DEBUG formatearFecha - Ya en formato correcto: 02/07/2025
[02-Oct-2025 13:07:02 UTC] DEBUG formatearFecha - Input: '02/07/2025' (tipo: string)
[02-Oct-2025 13:07:02 UTC] DEBUG formatearFecha - Ya en formato correcto: 02/07/2025
[02-Oct-2025 13:07:02 UTC] DEBUG formatearFecha - Input: '01/07/2025' (tipo: string)
[02-Oct-2025 13:07:02 UTC] DEBUG formatearFecha - Ya en formato correcto: 01/07/2025
[02-Oct-2025 13:07:02 UTC] DEBUG formatearFecha - Input: '01/07/2025' (tipo: string)
[02-Oct-2025 13:07:02 UTC] DEBUG formatearFecha - Ya en formato correcto: 01/07/2025
[02-Oct-2025 13:07:02 UTC] DEBUG formatearFecha - Input: '01/07/2025' (tipo: string)
[02-Oct-2025 13:07:02 UTC] DEBUG formatearFecha - Ya en formato correcto: 01/07/2025
[02-Oct-2025 13:07:02 UTC] DEBUG formatearFecha - Input: '30/06/2025' (tipo: string)
[02-Oct-2025 13:07:02 UTC] DEBUG formatearFecha - Ya en formato correcto: 30/06/2025
[02-Oct-2025 13:07:03 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:07:03 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[02-Oct-2025 13:07:03 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:07:03 UTC] DEBUG Carreras - Filtros recibidos: {"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-02"}
[02-Oct-2025 13:07:03 UTC] DEBUG Carreras - WHERE SQL: WHERE STR_TO_DATE(c.fecha, '%d/%m/%Y') >= STR_TO_DATE(:fecha_desde, '%Y-%m-%d') AND STR_TO_DATE(c.fecha, '%d/%m/%Y') <= STR_TO_DATE(:fecha_hasta, '%Y-%m-%d')
[02-Oct-2025 13:07:03 UTC] DEBUG Carreras - Parámetros: {":fecha_desde":"2025-05-01",":fecha_hasta":"2025-10-02"}
[02-Oct-2025 13:07:03 UTC] DEBUG Carreras - Registros obtenidos: 52
[02-Oct-2025 13:07:03 UTC] DEBUG Carreras - Primer registro: {"numero_carrera":1,"fecha":"31\/07\/2025","nombre_hipodromo":"San Isidro","estado_carrera":"Apuesta","carrera_interna_id":52}
[02-Oct-2025 13:07:04 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:07:04 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[02-Oct-2025 13:07:04 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:07:04 UTC] DEBUG - Consulta SQL ejecutada: 
            SELECT 
                cr.fecha,
                cr.nro_caballo,
                COALESCE(SUM(dt.total_apostado), 0) as total_apostado,
                COALESCE(SUM(CASE WHEN crd.devolucion = 0 THEN dt.total_apostado ELSE 0 END), 0) as monto_a_devolver,
                COALESCE(SUM(CASE WHEN crd.devolucion = 1 THEN dt.total_apostado ELSE 0 END), 0) as monto_devuelto,
                CASE 
                    WHEN SUM(dt.total_apostado) IS NULL OR SUM(dt.total_apostado) = 0 THEN 'Sin Apuestas'
                    WHEN SUM(CASE WHEN crd.devolucion = 0 THEN 1 ELSE 0 END) > 0 
                         AND SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Parcial'
                    WHEN SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Devuelto'
                    ELSE 'Pendiente'
                END as estado_devolucion
            FROM 
                tbl_caballos_retirados_ultimo_momento cr
            LEFT JOIN 
                tbl_caballos_retirados_um_detalle crd ON cr.id_caballo_retirado_ultimo_momento = crd.id_caballo_retirado_ultimo_momento
            LEFT JOIN 
                tbl_detalle_tickets dt ON crd.id_detalle_ticket = dt.id_detalle_ticket
            WHERE 1=1
            AND cr.fecha >= :fecha_desde AND cr.fecha <= :fecha_hasta
            GROUP BY
                cr.fecha, cr.nro_caballo, cr.id_carrera
            ORDER BY
                cr.fecha DESC, cr.nro_caballo ASC
            LIMIT :limit OFFSET :offset
        
[02-Oct-2025 13:07:04 UTC] DEBUG - Parámetros: {":fecha_desde":"2025-05-01",":fecha_hasta":"2025-10-02",":limit":100,":offset":0}
[02-Oct-2025 13:07:04 UTC] DEBUG - Registros obtenidos: 16 de 16 totales
[02-Oct-2025 13:07:04 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[02-Oct-2025 13:07:04 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[02-Oct-2025 13:07:04 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[02-Oct-2025 13:07:04 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[02-Oct-2025 13:07:04 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[02-Oct-2025 13:07:04 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[02-Oct-2025 13:07:04 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[02-Oct-2025 13:07:04 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[02-Oct-2025 13:07:04 UTC] DEBUG formatearFecha - Input: '2025-07-15' (tipo: string)
[02-Oct-2025 13:07:04 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-15 -> 15/07/2025
[02-Oct-2025 13:07:04 UTC] DEBUG formatearFecha - Input: '2025-07-14' (tipo: string)
[02-Oct-2025 13:07:04 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-14 -> 14/07/2025
[02-Oct-2025 13:07:04 UTC] DEBUG formatearFecha - Input: '2025-07-11' (tipo: string)
[02-Oct-2025 13:07:04 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-11 -> 11/07/2025
[02-Oct-2025 13:07:04 UTC] DEBUG formatearFecha - Input: '2025-07-10' (tipo: string)
[02-Oct-2025 13:07:04 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-10 -> 10/07/2025
[02-Oct-2025 13:07:04 UTC] DEBUG formatearFecha - Input: '2025-07-08' (tipo: string)
[02-Oct-2025 13:07:04 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-08 -> 08/07/2025
[02-Oct-2025 13:07:04 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[02-Oct-2025 13:07:04 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[02-Oct-2025 13:07:04 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[02-Oct-2025 13:07:04 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[02-Oct-2025 13:07:04 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[02-Oct-2025 13:07:04 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[02-Oct-2025 13:07:04 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[02-Oct-2025 13:07:04 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[02-Oct-2025 13:07:04 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[02-Oct-2025 13:07:04 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[02-Oct-2025 13:07:04 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[02-Oct-2025 13:07:04 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[02-Oct-2025 13:07:04 UTC] DEBUG formatearFecha - Input: '2025-06-27' (tipo: string)
[02-Oct-2025 13:07:04 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-06-27 -> 27/06/2025
[02-Oct-2025 13:07:04 UTC] DEBUG getCaballosRetirados - Totals raw: {"total_records":16,"total_a_devolver":45310,"total_devuelto":5300,"total_general":50610}
[02-Oct-2025 13:07:04 UTC] DEBUG getCaballosRetirados - Resultado final: {"data":[{"fecha":"29\/07\/2025","nro_caballo":1,"total_apostado":2200,"monto_a_devolver":2200,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"29\/07\/2025","nro_caballo":6,"total_apostado":2000,"monto_a_devolver":2000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"17\/07\/2025","nro_caballo":1,"total_apostado":16000,"monto_a_devolver":16000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"17\/07\/2025","nro_caballo":8,"total_apostado":8000,"monto_a_devolver":8000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"15\/07\/2025","nro_caballo":1,"total_apostado":4000,"monto_a_devolver":4000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"14\/07\/2025","nro_caballo":4,"total_apostado":13000,"monto_a_devolver":13000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"11\/07\/2025","nro_caballo":4,"total_apostado":4000,"monto_a_devolver":0,"monto_devuelto":4000,"estado_devolucion":"Devuelto"},{"fecha":"10\/07\/2025","nro_caballo":7,"total_apostado":800,"monto_a_devolver":0,"monto_devuelto":800,"estado_devolucion":"Devuelto"},{"fecha":"08\/07\/2025","nro_caballo":7,"total_apostado":410,"monto_a_devolver":110,"monto_devuelto":300,"estado_devolucion":"Parcial"},{"fecha":"04\/07\/2025","nro_caballo":1,"total_apostado":100,"monto_a_devolver":0,"monto_devuelto":100,"estado_devolucion":"Devuelto"},{"fecha":"04\/07\/2025","nro_caballo":6,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"02\/07\/2025","nro_caballo":4,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"02\/07\/2025","nro_caballo":8,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"01\/07\/2025","nro_caballo":1,"total_apostado":100,"monto_a_devolver":0,"monto_devuelto":100,"estado_devolucion":"Devuelto"},{"fecha":"01\/07\/2025","nro_caballo":4,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"27\/06\/2025","nro_caballo":12,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"}],"total_records":16,"total_general":50610,"total_a_devolver":45310,"total_devuelto":5300}
[02-Oct-2025 13:07:04 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:07:04 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[02-Oct-2025 13:07:04 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:07:04 UTC] DEBUG getListaTickets - Summary raw: {"total_vendido":639780,"total_ganadores":181030.4999847412,"total_pagados":79787.19999694824,"total_devoluciones":0}
[02-Oct-2025 13:07:04 UTC] DEBUG getListaTickets - Resultado final: {"total_vendido":639780,"total_ganadores":181030.4999847412,"total_pagados":79787.19999694824,"total_devoluciones":0,"ganancia":559992.8000030518}
[02-Oct-2025 13:07:04 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-02"}
[02-Oct-2025 13:07:16 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:07:16 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[02-Oct-2025 13:07:16 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:07:16 UTC] DEBUG - Consulta SQL ejecutada: 
            SELECT 
                cr.fecha,
                cr.nro_caballo,
                COALESCE(SUM(dt.total_apostado), 0) as total_apostado,
                COALESCE(SUM(CASE WHEN crd.devolucion = 0 THEN dt.total_apostado ELSE 0 END), 0) as monto_a_devolver,
                COALESCE(SUM(CASE WHEN crd.devolucion = 1 THEN dt.total_apostado ELSE 0 END), 0) as monto_devuelto,
                CASE 
                    WHEN SUM(dt.total_apostado) IS NULL OR SUM(dt.total_apostado) = 0 THEN 'Sin Apuestas'
                    WHEN SUM(CASE WHEN crd.devolucion = 0 THEN 1 ELSE 0 END) > 0 
                         AND SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Parcial'
                    WHEN SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Devuelto'
                    ELSE 'Pendiente'
                END as estado_devolucion
            FROM 
                tbl_caballos_retirados_ultimo_momento cr
            LEFT JOIN 
                tbl_caballos_retirados_um_detalle crd ON cr.id_caballo_retirado_ultimo_momento = crd.id_caballo_retirado_ultimo_momento
            LEFT JOIN 
                tbl_detalle_tickets dt ON crd.id_detalle_ticket = dt.id_detalle_ticket
            WHERE 1=1
            AND cr.fecha >= :fecha_desde AND cr.fecha <= :fecha_hasta
            GROUP BY
                cr.fecha, cr.nro_caballo, cr.id_carrera
            ORDER BY
                cr.fecha DESC, cr.nro_caballo ASC
            LIMIT :limit OFFSET :offset
        
[02-Oct-2025 13:07:16 UTC] DEBUG - Parámetros: {":fecha_desde":"2025-05-01",":fecha_hasta":"2025-10-02",":limit":100,":offset":0}
[02-Oct-2025 13:07:16 UTC] DEBUG - Registros obtenidos: 16 de 16 totales
[02-Oct-2025 13:07:16 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[02-Oct-2025 13:07:16 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[02-Oct-2025 13:07:16 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[02-Oct-2025 13:07:16 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[02-Oct-2025 13:07:16 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[02-Oct-2025 13:07:16 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[02-Oct-2025 13:07:16 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[02-Oct-2025 13:07:16 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[02-Oct-2025 13:07:16 UTC] DEBUG formatearFecha - Input: '2025-07-15' (tipo: string)
[02-Oct-2025 13:07:16 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-15 -> 15/07/2025
[02-Oct-2025 13:07:16 UTC] DEBUG formatearFecha - Input: '2025-07-14' (tipo: string)
[02-Oct-2025 13:07:16 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-14 -> 14/07/2025
[02-Oct-2025 13:07:16 UTC] DEBUG formatearFecha - Input: '2025-07-11' (tipo: string)
[02-Oct-2025 13:07:16 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-11 -> 11/07/2025
[02-Oct-2025 13:07:16 UTC] DEBUG formatearFecha - Input: '2025-07-10' (tipo: string)
[02-Oct-2025 13:07:16 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-10 -> 10/07/2025
[02-Oct-2025 13:07:16 UTC] DEBUG formatearFecha - Input: '2025-07-08' (tipo: string)
[02-Oct-2025 13:07:16 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-08 -> 08/07/2025
[02-Oct-2025 13:07:16 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[02-Oct-2025 13:07:16 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[02-Oct-2025 13:07:16 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[02-Oct-2025 13:07:16 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[02-Oct-2025 13:07:16 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[02-Oct-2025 13:07:16 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[02-Oct-2025 13:07:16 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[02-Oct-2025 13:07:16 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[02-Oct-2025 13:07:16 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[02-Oct-2025 13:07:16 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[02-Oct-2025 13:07:16 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[02-Oct-2025 13:07:16 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[02-Oct-2025 13:07:16 UTC] DEBUG formatearFecha - Input: '2025-06-27' (tipo: string)
[02-Oct-2025 13:07:16 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-06-27 -> 27/06/2025
[02-Oct-2025 13:07:16 UTC] DEBUG getCaballosRetirados - Totals raw: {"total_records":16,"total_a_devolver":45310,"total_devuelto":5300,"total_general":50610}
[02-Oct-2025 13:07:16 UTC] DEBUG getCaballosRetirados - Resultado final: {"data":[{"fecha":"29\/07\/2025","nro_caballo":1,"total_apostado":2200,"monto_a_devolver":2200,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"29\/07\/2025","nro_caballo":6,"total_apostado":2000,"monto_a_devolver":2000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"17\/07\/2025","nro_caballo":1,"total_apostado":16000,"monto_a_devolver":16000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"17\/07\/2025","nro_caballo":8,"total_apostado":8000,"monto_a_devolver":8000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"15\/07\/2025","nro_caballo":1,"total_apostado":4000,"monto_a_devolver":4000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"14\/07\/2025","nro_caballo":4,"total_apostado":13000,"monto_a_devolver":13000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"11\/07\/2025","nro_caballo":4,"total_apostado":4000,"monto_a_devolver":0,"monto_devuelto":4000,"estado_devolucion":"Devuelto"},{"fecha":"10\/07\/2025","nro_caballo":7,"total_apostado":800,"monto_a_devolver":0,"monto_devuelto":800,"estado_devolucion":"Devuelto"},{"fecha":"08\/07\/2025","nro_caballo":7,"total_apostado":410,"monto_a_devolver":110,"monto_devuelto":300,"estado_devolucion":"Parcial"},{"fecha":"04\/07\/2025","nro_caballo":1,"total_apostado":100,"monto_a_devolver":0,"monto_devuelto":100,"estado_devolucion":"Devuelto"},{"fecha":"04\/07\/2025","nro_caballo":6,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"02\/07\/2025","nro_caballo":4,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"02\/07\/2025","nro_caballo":8,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"01\/07\/2025","nro_caballo":1,"total_apostado":100,"monto_a_devolver":0,"monto_devuelto":100,"estado_devolucion":"Devuelto"},{"fecha":"01\/07\/2025","nro_caballo":4,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"27\/06\/2025","nro_caballo":12,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"}],"total_records":16,"total_general":50610,"total_a_devolver":45310,"total_devuelto":5300}
[02-Oct-2025 13:07:16 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:07:16 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[02-Oct-2025 13:07:16 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:07:16 UTC] DEBUG Carreras - Filtros recibidos: {"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-02"}
[02-Oct-2025 13:07:16 UTC] DEBUG Carreras - WHERE SQL: WHERE STR_TO_DATE(c.fecha, '%d/%m/%Y') >= STR_TO_DATE(:fecha_desde, '%Y-%m-%d') AND STR_TO_DATE(c.fecha, '%d/%m/%Y') <= STR_TO_DATE(:fecha_hasta, '%Y-%m-%d')
[02-Oct-2025 13:07:16 UTC] DEBUG Carreras - Parámetros: {":fecha_desde":"2025-05-01",":fecha_hasta":"2025-10-02"}
[02-Oct-2025 13:07:16 UTC] DEBUG Carreras - Registros obtenidos: 52
[02-Oct-2025 13:07:16 UTC] DEBUG Carreras - Primer registro: {"numero_carrera":1,"fecha":"31\/07\/2025","nombre_hipodromo":"San Isidro","estado_carrera":"Apuesta","carrera_interna_id":52}
[02-Oct-2025 13:07:18 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:07:18 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[02-Oct-2025 13:07:18 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:07:18 UTC] DEBUG getListaTickets - Summary raw: {"total_vendido":639780,"total_ganadores":181030.4999847412,"total_pagados":79787.19999694824,"total_devoluciones":0}
[02-Oct-2025 13:07:18 UTC] DEBUG getListaTickets - Resultado final: {"total_vendido":639780,"total_ganadores":181030.4999847412,"total_pagados":79787.19999694824,"total_devoluciones":0,"ganancia":559992.8000030518}
[02-Oct-2025 13:07:18 UTC] DEBUG - Consulta SQL ejecutada: 
            SELECT 
                cr.fecha,
                cr.nro_caballo,
                COALESCE(SUM(dt.total_apostado), 0) as total_apostado,
                COALESCE(SUM(CASE WHEN crd.devolucion = 0 THEN dt.total_apostado ELSE 0 END), 0) as monto_a_devolver,
                COALESCE(SUM(CASE WHEN crd.devolucion = 1 THEN dt.total_apostado ELSE 0 END), 0) as monto_devuelto,
                CASE 
                    WHEN SUM(dt.total_apostado) IS NULL OR SUM(dt.total_apostado) = 0 THEN 'Sin Apuestas'
                    WHEN SUM(CASE WHEN crd.devolucion = 0 THEN 1 ELSE 0 END) > 0 
                         AND SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Parcial'
                    WHEN SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Devuelto'
                    ELSE 'Pendiente'
                END as estado_devolucion
            FROM 
                tbl_caballos_retirados_ultimo_momento cr
            LEFT JOIN 
                tbl_caballos_retirados_um_detalle crd ON cr.id_caballo_retirado_ultimo_momento = crd.id_caballo_retirado_ultimo_momento
            LEFT JOIN 
                tbl_detalle_tickets dt ON crd.id_detalle_ticket = dt.id_detalle_ticket
            WHERE 1=1
            AND cr.fecha >= :fecha_desde AND cr.fecha <= :fecha_hasta
            GROUP BY
                cr.fecha, cr.nro_caballo, cr.id_carrera
            ORDER BY
                cr.fecha DESC, cr.nro_caballo ASC
            LIMIT :limit OFFSET :offset
        
[02-Oct-2025 13:07:18 UTC] DEBUG - Parámetros: {":fecha_desde":"2025-05-01",":fecha_hasta":"2025-10-02",":limit":100,":offset":0}
[02-Oct-2025 13:07:18 UTC] DEBUG - Registros obtenidos: 16 de 16 totales
[02-Oct-2025 13:07:18 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[02-Oct-2025 13:07:18 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[02-Oct-2025 13:07:18 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[02-Oct-2025 13:07:18 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[02-Oct-2025 13:07:18 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[02-Oct-2025 13:07:18 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[02-Oct-2025 13:07:18 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[02-Oct-2025 13:07:18 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[02-Oct-2025 13:07:18 UTC] DEBUG formatearFecha - Input: '2025-07-15' (tipo: string)
[02-Oct-2025 13:07:18 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-15 -> 15/07/2025
[02-Oct-2025 13:07:18 UTC] DEBUG formatearFecha - Input: '2025-07-14' (tipo: string)
[02-Oct-2025 13:07:18 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-14 -> 14/07/2025
[02-Oct-2025 13:07:18 UTC] DEBUG formatearFecha - Input: '2025-07-11' (tipo: string)
[02-Oct-2025 13:07:18 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-11 -> 11/07/2025
[02-Oct-2025 13:07:18 UTC] DEBUG formatearFecha - Input: '2025-07-10' (tipo: string)
[02-Oct-2025 13:07:18 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-10 -> 10/07/2025
[02-Oct-2025 13:07:18 UTC] DEBUG formatearFecha - Input: '2025-07-08' (tipo: string)
[02-Oct-2025 13:07:18 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-08 -> 08/07/2025
[02-Oct-2025 13:07:18 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[02-Oct-2025 13:07:18 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[02-Oct-2025 13:07:18 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[02-Oct-2025 13:07:18 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[02-Oct-2025 13:07:18 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[02-Oct-2025 13:07:18 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[02-Oct-2025 13:07:18 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[02-Oct-2025 13:07:18 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[02-Oct-2025 13:07:18 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[02-Oct-2025 13:07:18 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[02-Oct-2025 13:07:18 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[02-Oct-2025 13:07:18 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[02-Oct-2025 13:07:18 UTC] DEBUG formatearFecha - Input: '2025-06-27' (tipo: string)
[02-Oct-2025 13:07:18 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-06-27 -> 27/06/2025
[02-Oct-2025 13:07:18 UTC] DEBUG getCaballosRetirados - Totals raw: {"total_records":16,"total_a_devolver":45310,"total_devuelto":5300,"total_general":50610}
[02-Oct-2025 13:07:18 UTC] DEBUG getCaballosRetirados - Resultado final: {"data":[{"fecha":"29\/07\/2025","nro_caballo":1,"total_apostado":2200,"monto_a_devolver":2200,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"29\/07\/2025","nro_caballo":6,"total_apostado":2000,"monto_a_devolver":2000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"17\/07\/2025","nro_caballo":1,"total_apostado":16000,"monto_a_devolver":16000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"17\/07\/2025","nro_caballo":8,"total_apostado":8000,"monto_a_devolver":8000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"15\/07\/2025","nro_caballo":1,"total_apostado":4000,"monto_a_devolver":4000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"14\/07\/2025","nro_caballo":4,"total_apostado":13000,"monto_a_devolver":13000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"11\/07\/2025","nro_caballo":4,"total_apostado":4000,"monto_a_devolver":0,"monto_devuelto":4000,"estado_devolucion":"Devuelto"},{"fecha":"10\/07\/2025","nro_caballo":7,"total_apostado":800,"monto_a_devolver":0,"monto_devuelto":800,"estado_devolucion":"Devuelto"},{"fecha":"08\/07\/2025","nro_caballo":7,"total_apostado":410,"monto_a_devolver":110,"monto_devuelto":300,"estado_devolucion":"Parcial"},{"fecha":"04\/07\/2025","nro_caballo":1,"total_apostado":100,"monto_a_devolver":0,"monto_devuelto":100,"estado_devolucion":"Devuelto"},{"fecha":"04\/07\/2025","nro_caballo":6,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"02\/07\/2025","nro_caballo":4,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"02\/07\/2025","nro_caballo":8,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"01\/07\/2025","nro_caballo":1,"total_apostado":100,"monto_a_devolver":0,"monto_devuelto":100,"estado_devolucion":"Devuelto"},{"fecha":"01\/07\/2025","nro_caballo":4,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"27\/06\/2025","nro_caballo":12,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"}],"total_records":16,"total_general":50610,"total_a_devolver":45310,"total_devuelto":5300}
[02-Oct-2025 13:07:18 UTC] Acceso a reporte: usuario=1, reporte=informe_parte_venta, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-02"}
[02-Oct-2025 13:07:20 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:07:20 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[02-Oct-2025 13:07:20 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:07:20 UTC] DEBUG Carreras - Filtros recibidos: {"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-02"}
[02-Oct-2025 13:07:20 UTC] DEBUG Carreras - WHERE SQL: WHERE STR_TO_DATE(c.fecha, '%d/%m/%Y') >= STR_TO_DATE(:fecha_desde, '%Y-%m-%d') AND STR_TO_DATE(c.fecha, '%d/%m/%Y') <= STR_TO_DATE(:fecha_hasta, '%Y-%m-%d')
[02-Oct-2025 13:07:20 UTC] DEBUG Carreras - Parámetros: {":fecha_desde":"2025-05-01",":fecha_hasta":"2025-10-02"}
[02-Oct-2025 13:07:20 UTC] DEBUG Carreras - Registros obtenidos: 52
[02-Oct-2025 13:07:20 UTC] DEBUG Carreras - Primer registro: {"numero_carrera":1,"fecha":"31\/07\/2025","nombre_hipodromo":"San Isidro","estado_carrera":"Apuesta","carrera_interna_id":52}
[02-Oct-2025 13:07:21 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:07:21 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[02-Oct-2025 13:07:21 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:07:21 UTC] DEBUG - Consulta SQL ejecutada: 
            SELECT 
                cr.fecha,
                cr.nro_caballo,
                COALESCE(SUM(dt.total_apostado), 0) as total_apostado,
                COALESCE(SUM(CASE WHEN crd.devolucion = 0 THEN dt.total_apostado ELSE 0 END), 0) as monto_a_devolver,
                COALESCE(SUM(CASE WHEN crd.devolucion = 1 THEN dt.total_apostado ELSE 0 END), 0) as monto_devuelto,
                CASE 
                    WHEN SUM(dt.total_apostado) IS NULL OR SUM(dt.total_apostado) = 0 THEN 'Sin Apuestas'
                    WHEN SUM(CASE WHEN crd.devolucion = 0 THEN 1 ELSE 0 END) > 0 
                         AND SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Parcial'
                    WHEN SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Devuelto'
                    ELSE 'Pendiente'
                END as estado_devolucion
            FROM 
                tbl_caballos_retirados_ultimo_momento cr
            LEFT JOIN 
                tbl_caballos_retirados_um_detalle crd ON cr.id_caballo_retirado_ultimo_momento = crd.id_caballo_retirado_ultimo_momento
            LEFT JOIN 
                tbl_detalle_tickets dt ON crd.id_detalle_ticket = dt.id_detalle_ticket
            WHERE 1=1
            AND cr.fecha >= :fecha_desde AND cr.fecha <= :fecha_hasta
            GROUP BY
                cr.fecha, cr.nro_caballo, cr.id_carrera
            ORDER BY
                cr.fecha DESC, cr.nro_caballo ASC
            LIMIT :limit OFFSET :offset
        
[02-Oct-2025 13:07:21 UTC] DEBUG - Parámetros: {":fecha_desde":"2025-05-01",":fecha_hasta":"2025-10-02",":limit":100,":offset":0}
[02-Oct-2025 13:07:21 UTC] DEBUG - Registros obtenidos: 16 de 16 totales
[02-Oct-2025 13:07:21 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[02-Oct-2025 13:07:21 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[02-Oct-2025 13:07:21 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[02-Oct-2025 13:07:21 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[02-Oct-2025 13:07:21 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[02-Oct-2025 13:07:21 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[02-Oct-2025 13:07:21 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[02-Oct-2025 13:07:21 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[02-Oct-2025 13:07:21 UTC] DEBUG formatearFecha - Input: '2025-07-15' (tipo: string)
[02-Oct-2025 13:07:21 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-15 -> 15/07/2025
[02-Oct-2025 13:07:21 UTC] DEBUG formatearFecha - Input: '2025-07-14' (tipo: string)
[02-Oct-2025 13:07:21 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-14 -> 14/07/2025
[02-Oct-2025 13:07:21 UTC] DEBUG formatearFecha - Input: '2025-07-11' (tipo: string)
[02-Oct-2025 13:07:21 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-11 -> 11/07/2025
[02-Oct-2025 13:07:21 UTC] DEBUG formatearFecha - Input: '2025-07-10' (tipo: string)
[02-Oct-2025 13:07:21 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-10 -> 10/07/2025
[02-Oct-2025 13:07:21 UTC] DEBUG formatearFecha - Input: '2025-07-08' (tipo: string)
[02-Oct-2025 13:07:21 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-08 -> 08/07/2025
[02-Oct-2025 13:07:21 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[02-Oct-2025 13:07:21 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[02-Oct-2025 13:07:21 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[02-Oct-2025 13:07:21 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[02-Oct-2025 13:07:21 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[02-Oct-2025 13:07:21 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[02-Oct-2025 13:07:21 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[02-Oct-2025 13:07:21 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[02-Oct-2025 13:07:21 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[02-Oct-2025 13:07:21 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[02-Oct-2025 13:07:21 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[02-Oct-2025 13:07:21 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[02-Oct-2025 13:07:21 UTC] DEBUG formatearFecha - Input: '2025-06-27' (tipo: string)
[02-Oct-2025 13:07:21 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-06-27 -> 27/06/2025
[02-Oct-2025 13:07:21 UTC] DEBUG getCaballosRetirados - Totals raw: {"total_records":16,"total_a_devolver":45310,"total_devuelto":5300,"total_general":50610}
[02-Oct-2025 13:07:21 UTC] DEBUG getCaballosRetirados - Resultado final: {"data":[{"fecha":"29\/07\/2025","nro_caballo":1,"total_apostado":2200,"monto_a_devolver":2200,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"29\/07\/2025","nro_caballo":6,"total_apostado":2000,"monto_a_devolver":2000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"17\/07\/2025","nro_caballo":1,"total_apostado":16000,"monto_a_devolver":16000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"17\/07\/2025","nro_caballo":8,"total_apostado":8000,"monto_a_devolver":8000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"15\/07\/2025","nro_caballo":1,"total_apostado":4000,"monto_a_devolver":4000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"14\/07\/2025","nro_caballo":4,"total_apostado":13000,"monto_a_devolver":13000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"11\/07\/2025","nro_caballo":4,"total_apostado":4000,"monto_a_devolver":0,"monto_devuelto":4000,"estado_devolucion":"Devuelto"},{"fecha":"10\/07\/2025","nro_caballo":7,"total_apostado":800,"monto_a_devolver":0,"monto_devuelto":800,"estado_devolucion":"Devuelto"},{"fecha":"08\/07\/2025","nro_caballo":7,"total_apostado":410,"monto_a_devolver":110,"monto_devuelto":300,"estado_devolucion":"Parcial"},{"fecha":"04\/07\/2025","nro_caballo":1,"total_apostado":100,"monto_a_devolver":0,"monto_devuelto":100,"estado_devolucion":"Devuelto"},{"fecha":"04\/07\/2025","nro_caballo":6,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"02\/07\/2025","nro_caballo":4,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"02\/07\/2025","nro_caballo":8,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"01\/07\/2025","nro_caballo":1,"total_apostado":100,"monto_a_devolver":0,"monto_devuelto":100,"estado_devolucion":"Devuelto"},{"fecha":"01\/07\/2025","nro_caballo":4,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"27\/06\/2025","nro_caballo":12,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"}],"total_records":16,"total_general":50610,"total_a_devolver":45310,"total_devuelto":5300}
[02-Oct-2025 13:07:21 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:07:21 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[02-Oct-2025 13:07:21 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:07:21 UTC] DEBUG Tickets Anulados - Filtros recibidos: {"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-02"}
[02-Oct-2025 13:07:21 UTC] DEBUG Tickets Anulados - WHERE construido: AND STR_TO_DATE(t.fecha, '%d/%m/%Y') >= STR_TO_DATE(:fecha_desde, '%Y-%m-%d') AND STR_TO_DATE(t.fecha, '%d/%m/%Y') <= STR_TO_DATE(:fecha_hasta, '%Y-%m-%d')
[02-Oct-2025 13:07:22 UTC] DEBUG Tickets Anulados - Registros obtenidos: 12
[02-Oct-2025 13:07:22 UTC] DEBUG Tickets Anulados - Primer registro: {"nro_ticket":133,"fecha":"31\/07\/2025","hora":"10:01:20","nombre_usuario":"Agencia 24","nombre_agencia":"Morteros","total_apostado":10000}
[02-Oct-2025 13:07:22 UTC] DEBUG formatearFecha - Input: '31/07/2025' (tipo: string)
[02-Oct-2025 13:07:22 UTC] DEBUG formatearFecha - Ya en formato correcto: 31/07/2025
[02-Oct-2025 13:07:22 UTC] DEBUG formatearFecha - Input: '06/07/2025' (tipo: string)
[02-Oct-2025 13:07:22 UTC] DEBUG formatearFecha - Ya en formato correcto: 06/07/2025
[02-Oct-2025 13:07:22 UTC] DEBUG formatearFecha - Input: '05/07/2025' (tipo: string)
[02-Oct-2025 13:07:22 UTC] DEBUG formatearFecha - Ya en formato correcto: 05/07/2025
[02-Oct-2025 13:07:22 UTC] DEBUG formatearFecha - Input: '04/07/2025' (tipo: string)
[02-Oct-2025 13:07:22 UTC] DEBUG formatearFecha - Ya en formato correcto: 04/07/2025
[02-Oct-2025 13:07:22 UTC] DEBUG formatearFecha - Input: '02/07/2025' (tipo: string)
[02-Oct-2025 13:07:22 UTC] DEBUG formatearFecha - Ya en formato correcto: 02/07/2025
[02-Oct-2025 13:07:22 UTC] DEBUG formatearFecha - Input: '02/07/2025' (tipo: string)
[02-Oct-2025 13:07:22 UTC] DEBUG formatearFecha - Ya en formato correcto: 02/07/2025
[02-Oct-2025 13:07:22 UTC] DEBUG formatearFecha - Input: '02/07/2025' (tipo: string)
[02-Oct-2025 13:07:22 UTC] DEBUG formatearFecha - Ya en formato correcto: 02/07/2025
[02-Oct-2025 13:07:22 UTC] DEBUG formatearFecha - Input: '02/07/2025' (tipo: string)
[02-Oct-2025 13:07:22 UTC] DEBUG formatearFecha - Ya en formato correcto: 02/07/2025
[02-Oct-2025 13:07:22 UTC] DEBUG formatearFecha - Input: '01/07/2025' (tipo: string)
[02-Oct-2025 13:07:22 UTC] DEBUG formatearFecha - Ya en formato correcto: 01/07/2025
[02-Oct-2025 13:07:22 UTC] DEBUG formatearFecha - Input: '01/07/2025' (tipo: string)
[02-Oct-2025 13:07:22 UTC] DEBUG formatearFecha - Ya en formato correcto: 01/07/2025
[02-Oct-2025 13:07:22 UTC] DEBUG formatearFecha - Input: '01/07/2025' (tipo: string)
[02-Oct-2025 13:07:22 UTC] DEBUG formatearFecha - Ya en formato correcto: 01/07/2025
[02-Oct-2025 13:07:22 UTC] DEBUG formatearFecha - Input: '30/06/2025' (tipo: string)
[02-Oct-2025 13:07:22 UTC] DEBUG formatearFecha - Ya en formato correcto: 30/06/2025
[02-Oct-2025 13:07:59 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:07:59 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[02-Oct-2025 13:07:59 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:07:59 UTC] DEBUG - Consulta SQL ejecutada: 
            SELECT 
                cr.fecha,
                cr.nro_caballo,
                COALESCE(SUM(dt.total_apostado), 0) as total_apostado,
                COALESCE(SUM(CASE WHEN crd.devolucion = 0 THEN dt.total_apostado ELSE 0 END), 0) as monto_a_devolver,
                COALESCE(SUM(CASE WHEN crd.devolucion = 1 THEN dt.total_apostado ELSE 0 END), 0) as monto_devuelto,
                CASE 
                    WHEN SUM(dt.total_apostado) IS NULL OR SUM(dt.total_apostado) = 0 THEN 'Sin Apuestas'
                    WHEN SUM(CASE WHEN crd.devolucion = 0 THEN 1 ELSE 0 END) > 0 
                         AND SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Parcial'
                    WHEN SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Devuelto'
                    ELSE 'Pendiente'
                END as estado_devolucion
            FROM 
                tbl_caballos_retirados_ultimo_momento cr
            LEFT JOIN 
                tbl_caballos_retirados_um_detalle crd ON cr.id_caballo_retirado_ultimo_momento = crd.id_caballo_retirado_ultimo_momento
            LEFT JOIN 
                tbl_detalle_tickets dt ON crd.id_detalle_ticket = dt.id_detalle_ticket
            WHERE 1=1
            AND cr.fecha >= :fecha_desde AND cr.fecha <= :fecha_hasta
            GROUP BY
                cr.fecha, cr.nro_caballo, cr.id_carrera
            ORDER BY
                cr.fecha DESC, cr.nro_caballo ASC
            LIMIT :limit OFFSET :offset
        
[02-Oct-2025 13:07:59 UTC] DEBUG - Parámetros: {":fecha_desde":"2025-05-01",":fecha_hasta":"2025-10-02",":limit":100,":offset":0}
[02-Oct-2025 13:07:59 UTC] DEBUG - Registros obtenidos: 16 de 16 totales
[02-Oct-2025 13:07:59 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[02-Oct-2025 13:07:59 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[02-Oct-2025 13:07:59 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[02-Oct-2025 13:07:59 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[02-Oct-2025 13:07:59 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[02-Oct-2025 13:07:59 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[02-Oct-2025 13:07:59 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[02-Oct-2025 13:07:59 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[02-Oct-2025 13:07:59 UTC] DEBUG formatearFecha - Input: '2025-07-15' (tipo: string)
[02-Oct-2025 13:07:59 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-15 -> 15/07/2025
[02-Oct-2025 13:07:59 UTC] DEBUG formatearFecha - Input: '2025-07-14' (tipo: string)
[02-Oct-2025 13:07:59 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-14 -> 14/07/2025
[02-Oct-2025 13:07:59 UTC] DEBUG formatearFecha - Input: '2025-07-11' (tipo: string)
[02-Oct-2025 13:07:59 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-11 -> 11/07/2025
[02-Oct-2025 13:07:59 UTC] DEBUG formatearFecha - Input: '2025-07-10' (tipo: string)
[02-Oct-2025 13:07:59 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-10 -> 10/07/2025
[02-Oct-2025 13:07:59 UTC] DEBUG formatearFecha - Input: '2025-07-08' (tipo: string)
[02-Oct-2025 13:07:59 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-08 -> 08/07/2025
[02-Oct-2025 13:07:59 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[02-Oct-2025 13:07:59 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[02-Oct-2025 13:07:59 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[02-Oct-2025 13:07:59 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[02-Oct-2025 13:07:59 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[02-Oct-2025 13:07:59 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[02-Oct-2025 13:07:59 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[02-Oct-2025 13:07:59 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[02-Oct-2025 13:07:59 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[02-Oct-2025 13:07:59 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[02-Oct-2025 13:07:59 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[02-Oct-2025 13:07:59 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[02-Oct-2025 13:07:59 UTC] DEBUG formatearFecha - Input: '2025-06-27' (tipo: string)
[02-Oct-2025 13:07:59 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-06-27 -> 27/06/2025
[02-Oct-2025 13:07:59 UTC] DEBUG getCaballosRetirados - Totals raw: {"total_records":16,"total_a_devolver":45310,"total_devuelto":5300,"total_general":50610}
[02-Oct-2025 13:07:59 UTC] DEBUG getCaballosRetirados - Resultado final: {"data":[{"fecha":"29\/07\/2025","nro_caballo":1,"total_apostado":2200,"monto_a_devolver":2200,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"29\/07\/2025","nro_caballo":6,"total_apostado":2000,"monto_a_devolver":2000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"17\/07\/2025","nro_caballo":1,"total_apostado":16000,"monto_a_devolver":16000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"17\/07\/2025","nro_caballo":8,"total_apostado":8000,"monto_a_devolver":8000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"15\/07\/2025","nro_caballo":1,"total_apostado":4000,"monto_a_devolver":4000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"14\/07\/2025","nro_caballo":4,"total_apostado":13000,"monto_a_devolver":13000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"11\/07\/2025","nro_caballo":4,"total_apostado":4000,"monto_a_devolver":0,"monto_devuelto":4000,"estado_devolucion":"Devuelto"},{"fecha":"10\/07\/2025","nro_caballo":7,"total_apostado":800,"monto_a_devolver":0,"monto_devuelto":800,"estado_devolucion":"Devuelto"},{"fecha":"08\/07\/2025","nro_caballo":7,"total_apostado":410,"monto_a_devolver":110,"monto_devuelto":300,"estado_devolucion":"Parcial"},{"fecha":"04\/07\/2025","nro_caballo":1,"total_apostado":100,"monto_a_devolver":0,"monto_devuelto":100,"estado_devolucion":"Devuelto"},{"fecha":"04\/07\/2025","nro_caballo":6,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"02\/07\/2025","nro_caballo":4,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"02\/07\/2025","nro_caballo":8,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"01\/07\/2025","nro_caballo":1,"total_apostado":100,"monto_a_devolver":0,"monto_devuelto":100,"estado_devolucion":"Devuelto"},{"fecha":"01\/07\/2025","nro_caballo":4,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"27\/06\/2025","nro_caballo":12,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"}],"total_records":16,"total_general":50610,"total_a_devolver":45310,"total_devuelto":5300}
[02-Oct-2025 13:08:00 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:08:00 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[02-Oct-2025 13:08:00 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:08:00 UTC] DEBUG - Consulta SQL ejecutada: 
            SELECT 
                cr.fecha,
                cr.nro_caballo,
                COALESCE(SUM(dt.total_apostado), 0) as total_apostado,
                COALESCE(SUM(CASE WHEN crd.devolucion = 0 THEN dt.total_apostado ELSE 0 END), 0) as monto_a_devolver,
                COALESCE(SUM(CASE WHEN crd.devolucion = 1 THEN dt.total_apostado ELSE 0 END), 0) as monto_devuelto,
                CASE 
                    WHEN SUM(dt.total_apostado) IS NULL OR SUM(dt.total_apostado) = 0 THEN 'Sin Apuestas'
                    WHEN SUM(CASE WHEN crd.devolucion = 0 THEN 1 ELSE 0 END) > 0 
                         AND SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Parcial'
                    WHEN SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Devuelto'
                    ELSE 'Pendiente'
                END as estado_devolucion
            FROM 
                tbl_caballos_retirados_ultimo_momento cr
            LEFT JOIN 
                tbl_caballos_retirados_um_detalle crd ON cr.id_caballo_retirado_ultimo_momento = crd.id_caballo_retirado_ultimo_momento
            LEFT JOIN 
                tbl_detalle_tickets dt ON crd.id_detalle_ticket = dt.id_detalle_ticket
            WHERE 1=1
            AND cr.fecha >= :fecha_desde AND cr.fecha <= :fecha_hasta
            GROUP BY
                cr.fecha, cr.nro_caballo, cr.id_carrera
            ORDER BY
                cr.fecha DESC, cr.nro_caballo ASC
            LIMIT :limit OFFSET :offset
        
[02-Oct-2025 13:08:00 UTC] DEBUG - Parámetros: {":fecha_desde":"2025-05-01",":fecha_hasta":"2025-10-02",":limit":100,":offset":0}
[02-Oct-2025 13:08:00 UTC] DEBUG - Registros obtenidos: 16 de 16 totales
[02-Oct-2025 13:08:00 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[02-Oct-2025 13:08:00 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[02-Oct-2025 13:08:00 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[02-Oct-2025 13:08:00 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[02-Oct-2025 13:08:00 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[02-Oct-2025 13:08:00 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[02-Oct-2025 13:08:00 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[02-Oct-2025 13:08:00 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[02-Oct-2025 13:08:00 UTC] DEBUG formatearFecha - Input: '2025-07-15' (tipo: string)
[02-Oct-2025 13:08:00 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-15 -> 15/07/2025
[02-Oct-2025 13:08:00 UTC] DEBUG formatearFecha - Input: '2025-07-14' (tipo: string)
[02-Oct-2025 13:08:00 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-14 -> 14/07/2025
[02-Oct-2025 13:08:00 UTC] DEBUG formatearFecha - Input: '2025-07-11' (tipo: string)
[02-Oct-2025 13:08:00 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-11 -> 11/07/2025
[02-Oct-2025 13:08:00 UTC] DEBUG formatearFecha - Input: '2025-07-10' (tipo: string)
[02-Oct-2025 13:08:00 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-10 -> 10/07/2025
[02-Oct-2025 13:08:00 UTC] DEBUG formatearFecha - Input: '2025-07-08' (tipo: string)
[02-Oct-2025 13:08:00 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-08 -> 08/07/2025
[02-Oct-2025 13:08:00 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[02-Oct-2025 13:08:00 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[02-Oct-2025 13:08:00 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[02-Oct-2025 13:08:00 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[02-Oct-2025 13:08:00 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[02-Oct-2025 13:08:00 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[02-Oct-2025 13:08:00 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[02-Oct-2025 13:08:00 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[02-Oct-2025 13:08:00 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[02-Oct-2025 13:08:00 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[02-Oct-2025 13:08:00 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[02-Oct-2025 13:08:00 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[02-Oct-2025 13:08:00 UTC] DEBUG formatearFecha - Input: '2025-06-27' (tipo: string)
[02-Oct-2025 13:08:00 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-06-27 -> 27/06/2025
[02-Oct-2025 13:08:00 UTC] DEBUG getCaballosRetirados - Totals raw: {"total_records":16,"total_a_devolver":45310,"total_devuelto":5300,"total_general":50610}
[02-Oct-2025 13:08:00 UTC] DEBUG getCaballosRetirados - Resultado final: {"data":[{"fecha":"29\/07\/2025","nro_caballo":1,"total_apostado":2200,"monto_a_devolver":2200,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"29\/07\/2025","nro_caballo":6,"total_apostado":2000,"monto_a_devolver":2000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"17\/07\/2025","nro_caballo":1,"total_apostado":16000,"monto_a_devolver":16000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"17\/07\/2025","nro_caballo":8,"total_apostado":8000,"monto_a_devolver":8000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"15\/07\/2025","nro_caballo":1,"total_apostado":4000,"monto_a_devolver":4000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"14\/07\/2025","nro_caballo":4,"total_apostado":13000,"monto_a_devolver":13000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"11\/07\/2025","nro_caballo":4,"total_apostado":4000,"monto_a_devolver":0,"monto_devuelto":4000,"estado_devolucion":"Devuelto"},{"fecha":"10\/07\/2025","nro_caballo":7,"total_apostado":800,"monto_a_devolver":0,"monto_devuelto":800,"estado_devolucion":"Devuelto"},{"fecha":"08\/07\/2025","nro_caballo":7,"total_apostado":410,"monto_a_devolver":110,"monto_devuelto":300,"estado_devolucion":"Parcial"},{"fecha":"04\/07\/2025","nro_caballo":1,"total_apostado":100,"monto_a_devolver":0,"monto_devuelto":100,"estado_devolucion":"Devuelto"},{"fecha":"04\/07\/2025","nro_caballo":6,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"02\/07\/2025","nro_caballo":4,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"02\/07\/2025","nro_caballo":8,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"01\/07\/2025","nro_caballo":1,"total_apostado":100,"monto_a_devolver":0,"monto_devuelto":100,"estado_devolucion":"Devuelto"},{"fecha":"01\/07\/2025","nro_caballo":4,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"27\/06\/2025","nro_caballo":12,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"}],"total_records":16,"total_general":50610,"total_a_devolver":45310,"total_devuelto":5300}
[02-Oct-2025 13:08:01 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:08:01 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[02-Oct-2025 13:08:01 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:08:01 UTC] DEBUG Tickets Anulados - Filtros recibidos: {"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-02"}
[02-Oct-2025 13:08:01 UTC] DEBUG Tickets Anulados - WHERE construido: AND STR_TO_DATE(t.fecha, '%d/%m/%Y') >= STR_TO_DATE(:fecha_desde, '%Y-%m-%d') AND STR_TO_DATE(t.fecha, '%d/%m/%Y') <= STR_TO_DATE(:fecha_hasta, '%Y-%m-%d')
[02-Oct-2025 13:08:01 UTC] DEBUG Tickets Anulados - Registros obtenidos: 12
[02-Oct-2025 13:08:01 UTC] DEBUG Tickets Anulados - Primer registro: {"nro_ticket":133,"fecha":"31\/07\/2025","hora":"10:01:20","nombre_usuario":"Agencia 24","nombre_agencia":"Morteros","total_apostado":10000}
[02-Oct-2025 13:08:01 UTC] DEBUG formatearFecha - Input: '31/07/2025' (tipo: string)
[02-Oct-2025 13:08:01 UTC] DEBUG formatearFecha - Ya en formato correcto: 31/07/2025
[02-Oct-2025 13:08:01 UTC] DEBUG formatearFecha - Input: '06/07/2025' (tipo: string)
[02-Oct-2025 13:08:01 UTC] DEBUG formatearFecha - Ya en formato correcto: 06/07/2025
[02-Oct-2025 13:08:01 UTC] DEBUG formatearFecha - Input: '05/07/2025' (tipo: string)
[02-Oct-2025 13:08:01 UTC] DEBUG formatearFecha - Ya en formato correcto: 05/07/2025
[02-Oct-2025 13:08:01 UTC] DEBUG formatearFecha - Input: '04/07/2025' (tipo: string)
[02-Oct-2025 13:08:01 UTC] DEBUG formatearFecha - Ya en formato correcto: 04/07/2025
[02-Oct-2025 13:08:01 UTC] DEBUG formatearFecha - Input: '02/07/2025' (tipo: string)
[02-Oct-2025 13:08:01 UTC] DEBUG formatearFecha - Ya en formato correcto: 02/07/2025
[02-Oct-2025 13:08:01 UTC] DEBUG formatearFecha - Input: '02/07/2025' (tipo: string)
[02-Oct-2025 13:08:01 UTC] DEBUG formatearFecha - Ya en formato correcto: 02/07/2025
[02-Oct-2025 13:08:01 UTC] DEBUG formatearFecha - Input: '02/07/2025' (tipo: string)
[02-Oct-2025 13:08:01 UTC] DEBUG formatearFecha - Ya en formato correcto: 02/07/2025
[02-Oct-2025 13:08:01 UTC] DEBUG formatearFecha - Input: '02/07/2025' (tipo: string)
[02-Oct-2025 13:08:01 UTC] DEBUG formatearFecha - Ya en formato correcto: 02/07/2025
[02-Oct-2025 13:08:01 UTC] DEBUG formatearFecha - Input: '01/07/2025' (tipo: string)
[02-Oct-2025 13:08:01 UTC] DEBUG formatearFecha - Ya en formato correcto: 01/07/2025
[02-Oct-2025 13:08:01 UTC] DEBUG formatearFecha - Input: '01/07/2025' (tipo: string)
[02-Oct-2025 13:08:01 UTC] DEBUG formatearFecha - Ya en formato correcto: 01/07/2025
[02-Oct-2025 13:08:01 UTC] DEBUG formatearFecha - Input: '01/07/2025' (tipo: string)
[02-Oct-2025 13:08:01 UTC] DEBUG formatearFecha - Ya en formato correcto: 01/07/2025
[02-Oct-2025 13:08:01 UTC] DEBUG formatearFecha - Input: '30/06/2025' (tipo: string)
[02-Oct-2025 13:08:01 UTC] DEBUG formatearFecha - Ya en formato correcto: 30/06/2025
[02-Oct-2025 13:08:50 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:08:50 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[02-Oct-2025 13:08:50 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:08:50 UTC] DEBUG getListaTickets - Summary raw: {"total_vendido":639780,"total_ganadores":181030.4999847412,"total_pagados":79787.19999694824,"total_devoluciones":0}
[02-Oct-2025 13:08:50 UTC] DEBUG getListaTickets - Resultado final: {"total_vendido":639780,"total_ganadores":181030.4999847412,"total_pagados":79787.19999694824,"total_devoluciones":0,"ganancia":559992.8000030518}
[02-Oct-2025 13:08:50 UTC] DEBUG - Consulta SQL ejecutada: 
            SELECT 
                cr.fecha,
                cr.nro_caballo,
                COALESCE(SUM(dt.total_apostado), 0) as total_apostado,
                COALESCE(SUM(CASE WHEN crd.devolucion = 0 THEN dt.total_apostado ELSE 0 END), 0) as monto_a_devolver,
                COALESCE(SUM(CASE WHEN crd.devolucion = 1 THEN dt.total_apostado ELSE 0 END), 0) as monto_devuelto,
                CASE 
                    WHEN SUM(dt.total_apostado) IS NULL OR SUM(dt.total_apostado) = 0 THEN 'Sin Apuestas'
                    WHEN SUM(CASE WHEN crd.devolucion = 0 THEN 1 ELSE 0 END) > 0 
                         AND SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Parcial'
                    WHEN SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Devuelto'
                    ELSE 'Pendiente'
                END as estado_devolucion
            FROM 
                tbl_caballos_retirados_ultimo_momento cr
            LEFT JOIN 
                tbl_caballos_retirados_um_detalle crd ON cr.id_caballo_retirado_ultimo_momento = crd.id_caballo_retirado_ultimo_momento
            LEFT JOIN 
                tbl_detalle_tickets dt ON crd.id_detalle_ticket = dt.id_detalle_ticket
            WHERE 1=1
            AND cr.fecha >= :fecha_desde AND cr.fecha <= :fecha_hasta
            GROUP BY
                cr.fecha, cr.nro_caballo, cr.id_carrera
            ORDER BY
                cr.fecha DESC, cr.nro_caballo ASC
            LIMIT :limit OFFSET :offset
        
[02-Oct-2025 13:08:50 UTC] DEBUG - Parámetros: {":fecha_desde":"2025-05-01",":fecha_hasta":"2025-10-02",":limit":100,":offset":0}
[02-Oct-2025 13:08:50 UTC] DEBUG - Registros obtenidos: 16 de 16 totales
[02-Oct-2025 13:08:50 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[02-Oct-2025 13:08:50 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[02-Oct-2025 13:08:50 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[02-Oct-2025 13:08:50 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[02-Oct-2025 13:08:50 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[02-Oct-2025 13:08:50 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[02-Oct-2025 13:08:50 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[02-Oct-2025 13:08:50 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[02-Oct-2025 13:08:50 UTC] DEBUG formatearFecha - Input: '2025-07-15' (tipo: string)
[02-Oct-2025 13:08:50 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-15 -> 15/07/2025
[02-Oct-2025 13:08:50 UTC] DEBUG formatearFecha - Input: '2025-07-14' (tipo: string)
[02-Oct-2025 13:08:50 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-14 -> 14/07/2025
[02-Oct-2025 13:08:50 UTC] DEBUG formatearFecha - Input: '2025-07-11' (tipo: string)
[02-Oct-2025 13:08:50 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-11 -> 11/07/2025
[02-Oct-2025 13:08:50 UTC] DEBUG formatearFecha - Input: '2025-07-10' (tipo: string)
[02-Oct-2025 13:08:50 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-10 -> 10/07/2025
[02-Oct-2025 13:08:50 UTC] DEBUG formatearFecha - Input: '2025-07-08' (tipo: string)
[02-Oct-2025 13:08:50 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-08 -> 08/07/2025
[02-Oct-2025 13:08:50 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[02-Oct-2025 13:08:50 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[02-Oct-2025 13:08:50 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[02-Oct-2025 13:08:50 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[02-Oct-2025 13:08:50 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[02-Oct-2025 13:08:50 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[02-Oct-2025 13:08:50 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[02-Oct-2025 13:08:50 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[02-Oct-2025 13:08:50 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[02-Oct-2025 13:08:50 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[02-Oct-2025 13:08:50 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[02-Oct-2025 13:08:50 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[02-Oct-2025 13:08:50 UTC] DEBUG formatearFecha - Input: '2025-06-27' (tipo: string)
[02-Oct-2025 13:08:50 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-06-27 -> 27/06/2025
[02-Oct-2025 13:08:50 UTC] DEBUG getCaballosRetirados - Totals raw: {"total_records":16,"total_a_devolver":45310,"total_devuelto":5300,"total_general":50610}
[02-Oct-2025 13:08:50 UTC] DEBUG getCaballosRetirados - Resultado final: {"data":[{"fecha":"29\/07\/2025","nro_caballo":1,"total_apostado":2200,"monto_a_devolver":2200,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"29\/07\/2025","nro_caballo":6,"total_apostado":2000,"monto_a_devolver":2000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"17\/07\/2025","nro_caballo":1,"total_apostado":16000,"monto_a_devolver":16000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"17\/07\/2025","nro_caballo":8,"total_apostado":8000,"monto_a_devolver":8000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"15\/07\/2025","nro_caballo":1,"total_apostado":4000,"monto_a_devolver":4000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"14\/07\/2025","nro_caballo":4,"total_apostado":13000,"monto_a_devolver":13000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"11\/07\/2025","nro_caballo":4,"total_apostado":4000,"monto_a_devolver":0,"monto_devuelto":4000,"estado_devolucion":"Devuelto"},{"fecha":"10\/07\/2025","nro_caballo":7,"total_apostado":800,"monto_a_devolver":0,"monto_devuelto":800,"estado_devolucion":"Devuelto"},{"fecha":"08\/07\/2025","nro_caballo":7,"total_apostado":410,"monto_a_devolver":110,"monto_devuelto":300,"estado_devolucion":"Parcial"},{"fecha":"04\/07\/2025","nro_caballo":1,"total_apostado":100,"monto_a_devolver":0,"monto_devuelto":100,"estado_devolucion":"Devuelto"},{"fecha":"04\/07\/2025","nro_caballo":6,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"02\/07\/2025","nro_caballo":4,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"02\/07\/2025","nro_caballo":8,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"01\/07\/2025","nro_caballo":1,"total_apostado":100,"monto_a_devolver":0,"monto_devuelto":100,"estado_devolucion":"Devuelto"},{"fecha":"01\/07\/2025","nro_caballo":4,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"27\/06\/2025","nro_caballo":12,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"}],"total_records":16,"total_general":50610,"total_a_devolver":45310,"total_devuelto":5300}
[02-Oct-2025 13:08:50 UTC] Acceso a reporte: usuario=1, reporte=informe_parte_venta, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-02"}
[02-Oct-2025 13:09:59 UTC] PHP Fatal error:  Uncaught Error: Call to undefined method TurfReports\Controllers\AuthController::verify() in /var/www/html/Routes/api.php:121
Stack trace:
#0 {main}
  thrown in /var/www/html/Routes/api.php on line 121
[02-Oct-2025 13:10:00 UTC] DEBUG Login - Usuario encontrado: SÍ
[02-Oct-2025 13:10:00 UTC] DEBUG Login - Login BD: carreras2024
[02-Oct-2025 13:10:00 UTC] DEBUG Login - Login enviado: carreras2024
[02-Oct-2025 13:10:00 UTC] DEBUG Login - Contraseña BD: 0192023a7bbd73250516f069df18b500
[02-Oct-2025 13:10:00 UTC] DEBUG Login - Contraseña enviada: admin123
[02-Oct-2025 13:10:00 UTC] DEBUG Login - Contraseña MD5: 0192023a7bbd73250516f069df18b500
[02-Oct-2025 13:10:00 UTC] DEBUG Login - Coinciden MD5: SÍ
[02-Oct-2025 13:10:00 UTC] DEBUG Login - id_perfil: 1 (tipo: integer)
[02-Oct-2025 13:10:00 UTC] DEBUG Login - Rol asignado: admin
[02-Oct-2025 13:10:00 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:10:00 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[02-Oct-2025 13:10:00 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:10:01 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:10:01 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[02-Oct-2025 13:10:01 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:10:01 UTC] DEBUG getListaTickets - Summary raw: {"total_vendido":null,"total_ganadores":null,"total_pagados":null,"total_devoluciones":0}
[02-Oct-2025 13:10:01 UTC] DEBUG getListaTickets - Resultado final: {"total_vendido":0,"total_ganadores":0,"total_pagados":0,"total_devoluciones":0,"ganancia":0}
[02-Oct-2025 13:10:01 UTC] DEBUG Tickets Anulados - Filtros recibidos: {"fecha_desde":"2025-09-02","fecha_hasta":"2025-10-02"}
[02-Oct-2025 13:10:01 UTC] DEBUG Tickets Anulados - WHERE construido: AND STR_TO_DATE(t.fecha, '%d/%m/%Y') >= STR_TO_DATE(:fecha_desde, '%Y-%m-%d') AND STR_TO_DATE(t.fecha, '%d/%m/%Y') <= STR_TO_DATE(:fecha_hasta, '%Y-%m-%d')
[02-Oct-2025 13:10:01 UTC] DEBUG Tickets Anulados - Registros obtenidos: 0
[02-Oct-2025 13:10:01 UTC] DEBUG - Consulta SQL ejecutada: 
            SELECT 
                cr.fecha,
                cr.nro_caballo,
                COALESCE(SUM(dt.total_apostado), 0) as total_apostado,
                COALESCE(SUM(CASE WHEN crd.devolucion = 0 THEN dt.total_apostado ELSE 0 END), 0) as monto_a_devolver,
                COALESCE(SUM(CASE WHEN crd.devolucion = 1 THEN dt.total_apostado ELSE 0 END), 0) as monto_devuelto,
                CASE 
                    WHEN SUM(dt.total_apostado) IS NULL OR SUM(dt.total_apostado) = 0 THEN 'Sin Apuestas'
                    WHEN SUM(CASE WHEN crd.devolucion = 0 THEN 1 ELSE 0 END) > 0 
                         AND SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Parcial'
                    WHEN SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Devuelto'
                    ELSE 'Pendiente'
                END as estado_devolucion
            FROM 
                tbl_caballos_retirados_ultimo_momento cr
            LEFT JOIN 
                tbl_caballos_retirados_um_detalle crd ON cr.id_caballo_retirado_ultimo_momento = crd.id_caballo_retirado_ultimo_momento
            LEFT JOIN 
                tbl_detalle_tickets dt ON crd.id_detalle_ticket = dt.id_detalle_ticket
            WHERE 1=1
            AND cr.fecha >= :fecha_desde AND cr.fecha <= :fecha_hasta
            GROUP BY
                cr.fecha, cr.nro_caballo, cr.id_carrera
            ORDER BY
                cr.fecha DESC, cr.nro_caballo ASC
            LIMIT :limit OFFSET :offset
        
[02-Oct-2025 13:10:01 UTC] DEBUG - Parámetros: {":fecha_desde":"2025-09-02",":fecha_hasta":"2025-10-02",":limit":100,":offset":0}
[02-Oct-2025 13:10:01 UTC] DEBUG - Registros obtenidos: 0 de 0 totales
[02-Oct-2025 13:10:01 UTC] DEBUG getCaballosRetirados - Totals raw: {"total_records":0,"total_a_devolver":0,"total_devuelto":0,"total_general":0}
[02-Oct-2025 13:10:01 UTC] DEBUG getCaballosRetirados - Resultado final: {"data":[],"total_records":0,"total_general":0,"total_a_devolver":0,"total_devuelto":0}
[02-Oct-2025 13:10:01 UTC] Acceso a reporte: usuario=1, reporte=informe_parte_venta, filtros={"fecha_desde":"2025-09-02","fecha_hasta":"2025-10-02"}
[02-Oct-2025 13:10:07 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:10:07 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[02-Oct-2025 13:10:07 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:10:07 UTC] DEBUG getListaTickets - Summary raw: {"total_vendido":639780,"total_ganadores":181030.4999847412,"total_pagados":79787.19999694824,"total_devoluciones":0}
[02-Oct-2025 13:10:07 UTC] DEBUG getListaTickets - Resultado final: {"total_vendido":639780,"total_ganadores":181030.4999847412,"total_pagados":79787.19999694824,"total_devoluciones":0,"ganancia":559992.8000030518}
[02-Oct-2025 13:10:07 UTC] DEBUG Tickets Anulados - Filtros recibidos: {"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-02"}
[02-Oct-2025 13:10:07 UTC] DEBUG Tickets Anulados - WHERE construido: AND STR_TO_DATE(t.fecha, '%d/%m/%Y') >= STR_TO_DATE(:fecha_desde, '%Y-%m-%d') AND STR_TO_DATE(t.fecha, '%d/%m/%Y') <= STR_TO_DATE(:fecha_hasta, '%Y-%m-%d')
[02-Oct-2025 13:10:07 UTC] DEBUG Tickets Anulados - Registros obtenidos: 12
[02-Oct-2025 13:10:07 UTC] DEBUG Tickets Anulados - Primer registro: {"nro_ticket":133,"fecha":"31\/07\/2025","hora":"10:01:20","nombre_usuario":"Agencia 24","nombre_agencia":"Morteros","total_apostado":10000}
[02-Oct-2025 13:10:07 UTC] DEBUG formatearFecha - Input: '31/07/2025' (tipo: string)
[02-Oct-2025 13:10:07 UTC] DEBUG formatearFecha - Ya en formato correcto: 31/07/2025
[02-Oct-2025 13:10:07 UTC] DEBUG formatearFecha - Input: '06/07/2025' (tipo: string)
[02-Oct-2025 13:10:07 UTC] DEBUG formatearFecha - Ya en formato correcto: 06/07/2025
[02-Oct-2025 13:10:07 UTC] DEBUG formatearFecha - Input: '05/07/2025' (tipo: string)
[02-Oct-2025 13:10:07 UTC] DEBUG formatearFecha - Ya en formato correcto: 05/07/2025
[02-Oct-2025 13:10:07 UTC] DEBUG formatearFecha - Input: '04/07/2025' (tipo: string)
[02-Oct-2025 13:10:07 UTC] DEBUG formatearFecha - Ya en formato correcto: 04/07/2025
[02-Oct-2025 13:10:07 UTC] DEBUG formatearFecha - Input: '02/07/2025' (tipo: string)
[02-Oct-2025 13:10:07 UTC] DEBUG formatearFecha - Ya en formato correcto: 02/07/2025
[02-Oct-2025 13:10:07 UTC] DEBUG formatearFecha - Input: '02/07/2025' (tipo: string)
[02-Oct-2025 13:10:07 UTC] DEBUG formatearFecha - Ya en formato correcto: 02/07/2025
[02-Oct-2025 13:10:07 UTC] DEBUG formatearFecha - Input: '02/07/2025' (tipo: string)
[02-Oct-2025 13:10:07 UTC] DEBUG formatearFecha - Ya en formato correcto: 02/07/2025
[02-Oct-2025 13:10:07 UTC] DEBUG formatearFecha - Input: '02/07/2025' (tipo: string)
[02-Oct-2025 13:10:07 UTC] DEBUG formatearFecha - Ya en formato correcto: 02/07/2025
[02-Oct-2025 13:10:07 UTC] DEBUG formatearFecha - Input: '01/07/2025' (tipo: string)
[02-Oct-2025 13:10:07 UTC] DEBUG formatearFecha - Ya en formato correcto: 01/07/2025
[02-Oct-2025 13:10:07 UTC] DEBUG formatearFecha - Input: '01/07/2025' (tipo: string)
[02-Oct-2025 13:10:07 UTC] DEBUG formatearFecha - Ya en formato correcto: 01/07/2025
[02-Oct-2025 13:10:07 UTC] DEBUG formatearFecha - Input: '01/07/2025' (tipo: string)
[02-Oct-2025 13:10:07 UTC] DEBUG formatearFecha - Ya en formato correcto: 01/07/2025
[02-Oct-2025 13:10:07 UTC] DEBUG formatearFecha - Input: '30/06/2025' (tipo: string)
[02-Oct-2025 13:10:07 UTC] DEBUG formatearFecha - Ya en formato correcto: 30/06/2025
[02-Oct-2025 13:10:07 UTC] DEBUG - Consulta SQL ejecutada: 
            SELECT 
                cr.fecha,
                cr.nro_caballo,
                COALESCE(SUM(dt.total_apostado), 0) as total_apostado,
                COALESCE(SUM(CASE WHEN crd.devolucion = 0 THEN dt.total_apostado ELSE 0 END), 0) as monto_a_devolver,
                COALESCE(SUM(CASE WHEN crd.devolucion = 1 THEN dt.total_apostado ELSE 0 END), 0) as monto_devuelto,
                CASE 
                    WHEN SUM(dt.total_apostado) IS NULL OR SUM(dt.total_apostado) = 0 THEN 'Sin Apuestas'
                    WHEN SUM(CASE WHEN crd.devolucion = 0 THEN 1 ELSE 0 END) > 0 
                         AND SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Parcial'
                    WHEN SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Devuelto'
                    ELSE 'Pendiente'
                END as estado_devolucion
            FROM 
                tbl_caballos_retirados_ultimo_momento cr
            LEFT JOIN 
                tbl_caballos_retirados_um_detalle crd ON cr.id_caballo_retirado_ultimo_momento = crd.id_caballo_retirado_ultimo_momento
            LEFT JOIN 
                tbl_detalle_tickets dt ON crd.id_detalle_ticket = dt.id_detalle_ticket
            WHERE 1=1
            AND cr.fecha >= :fecha_desde AND cr.fecha <= :fecha_hasta
            GROUP BY
                cr.fecha, cr.nro_caballo, cr.id_carrera
            ORDER BY
                cr.fecha DESC, cr.nro_caballo ASC
            LIMIT :limit OFFSET :offset
        
[02-Oct-2025 13:10:07 UTC] DEBUG - Parámetros: {":fecha_desde":"2025-05-01",":fecha_hasta":"2025-10-02",":limit":100,":offset":0}
[02-Oct-2025 13:10:07 UTC] DEBUG - Registros obtenidos: 16 de 16 totales
[02-Oct-2025 13:10:07 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[02-Oct-2025 13:10:07 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[02-Oct-2025 13:10:07 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[02-Oct-2025 13:10:07 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[02-Oct-2025 13:10:07 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[02-Oct-2025 13:10:07 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[02-Oct-2025 13:10:07 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[02-Oct-2025 13:10:07 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[02-Oct-2025 13:10:07 UTC] DEBUG formatearFecha - Input: '2025-07-15' (tipo: string)
[02-Oct-2025 13:10:07 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-15 -> 15/07/2025
[02-Oct-2025 13:10:07 UTC] DEBUG formatearFecha - Input: '2025-07-14' (tipo: string)
[02-Oct-2025 13:10:07 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-14 -> 14/07/2025
[02-Oct-2025 13:10:07 UTC] DEBUG formatearFecha - Input: '2025-07-11' (tipo: string)
[02-Oct-2025 13:10:07 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-11 -> 11/07/2025
[02-Oct-2025 13:10:07 UTC] DEBUG formatearFecha - Input: '2025-07-10' (tipo: string)
[02-Oct-2025 13:10:07 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-10 -> 10/07/2025
[02-Oct-2025 13:10:07 UTC] DEBUG formatearFecha - Input: '2025-07-08' (tipo: string)
[02-Oct-2025 13:10:07 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-08 -> 08/07/2025
[02-Oct-2025 13:10:07 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[02-Oct-2025 13:10:07 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[02-Oct-2025 13:10:07 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[02-Oct-2025 13:10:07 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[02-Oct-2025 13:10:07 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[02-Oct-2025 13:10:07 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[02-Oct-2025 13:10:07 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[02-Oct-2025 13:10:07 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[02-Oct-2025 13:10:07 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[02-Oct-2025 13:10:07 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[02-Oct-2025 13:10:07 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[02-Oct-2025 13:10:07 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[02-Oct-2025 13:10:07 UTC] DEBUG formatearFecha - Input: '2025-06-27' (tipo: string)
[02-Oct-2025 13:10:07 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-06-27 -> 27/06/2025
[02-Oct-2025 13:10:07 UTC] DEBUG getCaballosRetirados - Totals raw: {"total_records":16,"total_a_devolver":45310,"total_devuelto":5300,"total_general":50610}
[02-Oct-2025 13:10:07 UTC] DEBUG getCaballosRetirados - Resultado final: {"data":[{"fecha":"29\/07\/2025","nro_caballo":1,"total_apostado":2200,"monto_a_devolver":2200,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"29\/07\/2025","nro_caballo":6,"total_apostado":2000,"monto_a_devolver":2000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"17\/07\/2025","nro_caballo":1,"total_apostado":16000,"monto_a_devolver":16000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"17\/07\/2025","nro_caballo":8,"total_apostado":8000,"monto_a_devolver":8000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"15\/07\/2025","nro_caballo":1,"total_apostado":4000,"monto_a_devolver":4000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"14\/07\/2025","nro_caballo":4,"total_apostado":13000,"monto_a_devolver":13000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"11\/07\/2025","nro_caballo":4,"total_apostado":4000,"monto_a_devolver":0,"monto_devuelto":4000,"estado_devolucion":"Devuelto"},{"fecha":"10\/07\/2025","nro_caballo":7,"total_apostado":800,"monto_a_devolver":0,"monto_devuelto":800,"estado_devolucion":"Devuelto"},{"fecha":"08\/07\/2025","nro_caballo":7,"total_apostado":410,"monto_a_devolver":110,"monto_devuelto":300,"estado_devolucion":"Parcial"},{"fecha":"04\/07\/2025","nro_caballo":1,"total_apostado":100,"monto_a_devolver":0,"monto_devuelto":100,"estado_devolucion":"Devuelto"},{"fecha":"04\/07\/2025","nro_caballo":6,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"02\/07\/2025","nro_caballo":4,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"02\/07\/2025","nro_caballo":8,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"01\/07\/2025","nro_caballo":1,"total_apostado":100,"monto_a_devolver":0,"monto_devuelto":100,"estado_devolucion":"Devuelto"},{"fecha":"01\/07\/2025","nro_caballo":4,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"27\/06\/2025","nro_caballo":12,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"}],"total_records":16,"total_general":50610,"total_a_devolver":45310,"total_devuelto":5300}
[02-Oct-2025 13:10:07 UTC] Acceso a reporte: usuario=1, reporte=informe_parte_venta, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-02"}
[02-Oct-2025 13:10:09 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:10:09 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[02-Oct-2025 13:10:09 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[02-Oct-2025 13:10:09 UTC] DEBUG Tickets Anulados - Filtros recibidos: {"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-02"}
[02-Oct-2025 13:10:09 UTC] DEBUG Tickets Anulados - WHERE construido: AND STR_TO_DATE(t.fecha, '%d/%m/%Y') >= STR_TO_DATE(:fecha_desde, '%Y-%m-%d') AND STR_TO_DATE(t.fecha, '%d/%m/%Y') <= STR_TO_DATE(:fecha_hasta, '%Y-%m-%d')
[02-Oct-2025 13:10:09 UTC] DEBUG Tickets Anulados - Registros obtenidos: 12
[02-Oct-2025 13:10:09 UTC] DEBUG Tickets Anulados - Primer registro: {"nro_ticket":133,"fecha":"31\/07\/2025","hora":"10:01:20","nombre_usuario":"Agencia 24","nombre_agencia":"Morteros","total_apostado":10000}
[02-Oct-2025 13:10:09 UTC] DEBUG formatearFecha - Input: '31/07/2025' (tipo: string)
[02-Oct-2025 13:10:09 UTC] DEBUG formatearFecha - Ya en formato correcto: 31/07/2025
[02-Oct-2025 13:10:09 UTC] DEBUG formatearFecha - Input: '06/07/2025' (tipo: string)
[02-Oct-2025 13:10:09 UTC] DEBUG formatearFecha - Ya en formato correcto: 06/07/2025
[02-Oct-2025 13:10:10 UTC] DEBUG formatearFecha - Input: '05/07/2025' (tipo: string)
[02-Oct-2025 13:10:10 UTC] DEBUG formatearFecha - Ya en formato correcto: 05/07/2025
[02-Oct-2025 13:10:10 UTC] DEBUG formatearFecha - Input: '04/07/2025' (tipo: string)
[02-Oct-2025 13:10:10 UTC] DEBUG formatearFecha - Ya en formato correcto: 04/07/2025
[02-Oct-2025 13:10:10 UTC] DEBUG formatearFecha - Input: '02/07/2025' (tipo: string)
[02-Oct-2025 13:10:10 UTC] DEBUG formatearFecha - Ya en formato correcto: 02/07/2025
[02-Oct-2025 13:10:10 UTC] DEBUG formatearFecha - Input: '02/07/2025' (tipo: string)
[02-Oct-2025 13:10:10 UTC] DEBUG formatearFecha - Ya en formato correcto: 02/07/2025
[02-Oct-2025 13:10:10 UTC] DEBUG formatearFecha - Input: '02/07/2025' (tipo: string)
[02-Oct-2025 13:10:10 UTC] DEBUG formatearFecha - Ya en formato correcto: 02/07/2025
[02-Oct-2025 13:10:10 UTC] DEBUG formatearFecha - Input: '02/07/2025' (tipo: string)
[02-Oct-2025 13:10:10 UTC] DEBUG formatearFecha - Ya en formato correcto: 02/07/2025
[02-Oct-2025 13:10:10 UTC] DEBUG formatearFecha - Input: '01/07/2025' (tipo: string)
[02-Oct-2025 13:10:10 UTC] DEBUG formatearFecha - Ya en formato correcto: 01/07/2025
[02-Oct-2025 13:10:10 UTC] DEBUG formatearFecha - Input: '01/07/2025' (tipo: string)
[02-Oct-2025 13:10:10 UTC] DEBUG formatearFecha - Ya en formato correcto: 01/07/2025
[02-Oct-2025 13:10:10 UTC] DEBUG formatearFecha - Input: '01/07/2025' (tipo: string)
[02-Oct-2025 13:10:10 UTC] DEBUG formatearFecha - Ya en formato correcto: 01/07/2025
[02-Oct-2025 13:10:10 UTC] DEBUG formatearFecha - Input: '30/06/2025' (tipo: string)
[02-Oct-2025 13:10:10 UTC] DEBUG formatearFecha - Ya en formato correcto: 30/06/2025
