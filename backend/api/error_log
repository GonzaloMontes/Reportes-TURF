[01-Oct-2025 21:48:30 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_HOST" in /var/www/html/Core/DatabaseManager.php on line 38
[01-Oct-2025 21:48:30 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_NAME" in /var/www/html/Core/DatabaseManager.php on line 40
[01-Oct-2025 21:48:30 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_USER" in /var/www/html/Core/DatabaseManager.php on line 41
[01-Oct-2025 21:48:30 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_PASS" in /var/www/html/Core/DatabaseManager.php on line 42
[01-Oct-2025 21:48:30 UTC] API Error: Error de conexión a : SQLSTATE[HY000] [2002] No such file or directory in /var/www/html/Core/DatabaseManager.php:69
[01-Oct-2025 21:48:30 UTC] PHP Warning:  Undefined array key "APP_DEBUG" in /var/www/html/Routes/api.php on line 230
[01-Oct-2025 21:48:38 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_HOST" in /var/www/html/Core/DatabaseManager.php on line 38
[01-Oct-2025 21:48:38 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_NAME" in /var/www/html/Core/DatabaseManager.php on line 40
[01-Oct-2025 21:48:38 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_USER" in /var/www/html/Core/DatabaseManager.php on line 41
[01-Oct-2025 21:48:38 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_PASS" in /var/www/html/Core/DatabaseManager.php on line 42
[01-Oct-2025 21:48:38 UTC] API Error: Error de conexión a : SQLSTATE[HY000] [2002] No such file or directory in /var/www/html/Core/DatabaseManager.php:69
[01-Oct-2025 21:48:38 UTC] PHP Warning:  Undefined array key "APP_DEBUG" in /var/www/html/Routes/api.php on line 230
[01-Oct-2025 21:48:39 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_HOST" in /var/www/html/Core/DatabaseManager.php on line 38
[01-Oct-2025 21:48:39 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_NAME" in /var/www/html/Core/DatabaseManager.php on line 40
[01-Oct-2025 21:48:39 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_USER" in /var/www/html/Core/DatabaseManager.php on line 41
[01-Oct-2025 21:48:39 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_PASS" in /var/www/html/Core/DatabaseManager.php on line 42
[01-Oct-2025 21:48:39 UTC] API Error: Error de conexión a : SQLSTATE[HY000] [2002] No such file or directory in /var/www/html/Core/DatabaseManager.php:69
[01-Oct-2025 21:48:39 UTC] PHP Warning:  Undefined array key "APP_DEBUG" in /var/www/html/Routes/api.php on line 230
[01-Oct-2025 21:48:40 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_HOST" in /var/www/html/Core/DatabaseManager.php on line 38
[01-Oct-2025 21:48:40 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_NAME" in /var/www/html/Core/DatabaseManager.php on line 40
[01-Oct-2025 21:48:40 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_USER" in /var/www/html/Core/DatabaseManager.php on line 41
[01-Oct-2025 21:48:40 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_PASS" in /var/www/html/Core/DatabaseManager.php on line 42
[01-Oct-2025 21:48:40 UTC] API Error: Error de conexión a : SQLSTATE[HY000] [2002] No such file or directory in /var/www/html/Core/DatabaseManager.php:69
[01-Oct-2025 21:48:40 UTC] PHP Warning:  Undefined array key "APP_DEBUG" in /var/www/html/Routes/api.php on line 230
[01-Oct-2025 21:48:40 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_HOST" in /var/www/html/Core/DatabaseManager.php on line 38
[01-Oct-2025 21:48:40 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_NAME" in /var/www/html/Core/DatabaseManager.php on line 40
[01-Oct-2025 21:48:40 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_USER" in /var/www/html/Core/DatabaseManager.php on line 41
[01-Oct-2025 21:48:40 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_PASS" in /var/www/html/Core/DatabaseManager.php on line 42
[01-Oct-2025 21:48:40 UTC] API Error: Error de conexión a : SQLSTATE[HY000] [2002] No such file or directory in /var/www/html/Core/DatabaseManager.php:69
[01-Oct-2025 21:48:40 UTC] PHP Warning:  Undefined array key "APP_DEBUG" in /var/www/html/Routes/api.php on line 230
[01-Oct-2025 21:48:41 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_HOST" in /var/www/html/Core/DatabaseManager.php on line 38
[01-Oct-2025 21:48:41 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_NAME" in /var/www/html/Core/DatabaseManager.php on line 40
[01-Oct-2025 21:48:41 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_USER" in /var/www/html/Core/DatabaseManager.php on line 41
[01-Oct-2025 21:48:41 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_PASS" in /var/www/html/Core/DatabaseManager.php on line 42
[01-Oct-2025 21:48:41 UTC] API Error: Error de conexión a : SQLSTATE[HY000] [2002] No such file or directory in /var/www/html/Core/DatabaseManager.php:69
[01-Oct-2025 21:48:41 UTC] PHP Warning:  Undefined array key "APP_DEBUG" in /var/www/html/Routes/api.php on line 230
[01-Oct-2025 21:48:41 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_HOST" in /var/www/html/Core/DatabaseManager.php on line 38
[01-Oct-2025 21:48:41 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_NAME" in /var/www/html/Core/DatabaseManager.php on line 40
[01-Oct-2025 21:48:41 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_USER" in /var/www/html/Core/DatabaseManager.php on line 41
[01-Oct-2025 21:48:41 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_PASS" in /var/www/html/Core/DatabaseManager.php on line 42
[01-Oct-2025 21:48:41 UTC] API Error: Error de conexión a : SQLSTATE[HY000] [2002] No such file or directory in /var/www/html/Core/DatabaseManager.php:69
[01-Oct-2025 21:48:41 UTC] PHP Warning:  Undefined array key "APP_DEBUG" in /var/www/html/Routes/api.php on line 230
[01-Oct-2025 21:48:42 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_HOST" in /var/www/html/Core/DatabaseManager.php on line 38
[01-Oct-2025 21:48:42 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_NAME" in /var/www/html/Core/DatabaseManager.php on line 40
[01-Oct-2025 21:48:42 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_USER" in /var/www/html/Core/DatabaseManager.php on line 41
[01-Oct-2025 21:48:42 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_PASS" in /var/www/html/Core/DatabaseManager.php on line 42
[01-Oct-2025 21:48:42 UTC] API Error: Error de conexión a : SQLSTATE[HY000] [2002] No such file or directory in /var/www/html/Core/DatabaseManager.php:69
[01-Oct-2025 21:48:42 UTC] PHP Warning:  Undefined array key "APP_DEBUG" in /var/www/html/Routes/api.php on line 230
[01-Oct-2025 21:48:43 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_HOST" in /var/www/html/Core/DatabaseManager.php on line 38
[01-Oct-2025 21:48:43 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_NAME" in /var/www/html/Core/DatabaseManager.php on line 40
[01-Oct-2025 21:48:43 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_USER" in /var/www/html/Core/DatabaseManager.php on line 41
[01-Oct-2025 21:48:43 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_PASS" in /var/www/html/Core/DatabaseManager.php on line 42
[01-Oct-2025 21:48:43 UTC] API Error: Error de conexión a : SQLSTATE[HY000] [2002] No such file or directory in /var/www/html/Core/DatabaseManager.php:69
[01-Oct-2025 21:48:43 UTC] PHP Warning:  Undefined array key "APP_DEBUG" in /var/www/html/Routes/api.php on line 230
[01-Oct-2025 21:48:43 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_HOST" in /var/www/html/Core/DatabaseManager.php on line 38
[01-Oct-2025 21:48:43 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_NAME" in /var/www/html/Core/DatabaseManager.php on line 40
[01-Oct-2025 21:48:43 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_USER" in /var/www/html/Core/DatabaseManager.php on line 41
[01-Oct-2025 21:48:43 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_PASS" in /var/www/html/Core/DatabaseManager.php on line 42
[01-Oct-2025 21:48:43 UTC] API Error: Error de conexión a : SQLSTATE[HY000] [2002] No such file or directory in /var/www/html/Core/DatabaseManager.php:69
[01-Oct-2025 21:48:43 UTC] PHP Warning:  Undefined array key "APP_DEBUG" in /var/www/html/Routes/api.php on line 230
[01-Oct-2025 22:03:13 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_HOST" in /var/www/html/Core/DatabaseManager.php on line 38
[01-Oct-2025 22:03:13 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_NAME" in /var/www/html/Core/DatabaseManager.php on line 40
[01-Oct-2025 22:03:13 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_USER" in /var/www/html/Core/DatabaseManager.php on line 41
[01-Oct-2025 22:03:13 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_PASS" in /var/www/html/Core/DatabaseManager.php on line 42
[01-Oct-2025 22:03:13 UTC] API Error: Error de conexión a : SQLSTATE[HY000] [2002] No such file or directory in /var/www/html/Core/DatabaseManager.php:69
[01-Oct-2025 22:03:13 UTC] PHP Warning:  Undefined array key "APP_DEBUG" in /var/www/html/Routes/api.php on line 230
[01-Oct-2025 22:03:14 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_HOST" in /var/www/html/Core/DatabaseManager.php on line 38
[01-Oct-2025 22:03:14 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_NAME" in /var/www/html/Core/DatabaseManager.php on line 40
[01-Oct-2025 22:03:14 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_USER" in /var/www/html/Core/DatabaseManager.php on line 41
[01-Oct-2025 22:03:14 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_PASS" in /var/www/html/Core/DatabaseManager.php on line 42
[01-Oct-2025 22:03:14 UTC] API Error: Error de conexión a : SQLSTATE[HY000] [2002] No such file or directory in /var/www/html/Core/DatabaseManager.php:69
[01-Oct-2025 22:03:14 UTC] PHP Warning:  Undefined array key "APP_DEBUG" in /var/www/html/Routes/api.php on line 230
[01-Oct-2025 22:03:15 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_HOST" in /var/www/html/Core/DatabaseManager.php on line 38
[01-Oct-2025 22:03:15 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_NAME" in /var/www/html/Core/DatabaseManager.php on line 40
[01-Oct-2025 22:03:15 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_USER" in /var/www/html/Core/DatabaseManager.php on line 41
[01-Oct-2025 22:03:15 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_PASS" in /var/www/html/Core/DatabaseManager.php on line 42
[01-Oct-2025 22:03:15 UTC] API Error: Error de conexión a : SQLSTATE[HY000] [2002] No such file or directory in /var/www/html/Core/DatabaseManager.php:69
[01-Oct-2025 22:03:15 UTC] PHP Warning:  Undefined array key "APP_DEBUG" in /var/www/html/Routes/api.php on line 230
[01-Oct-2025 22:03:15 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_HOST" in /var/www/html/Core/DatabaseManager.php on line 38
[01-Oct-2025 22:03:15 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_NAME" in /var/www/html/Core/DatabaseManager.php on line 40
[01-Oct-2025 22:03:15 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_USER" in /var/www/html/Core/DatabaseManager.php on line 41
[01-Oct-2025 22:03:15 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_PASS" in /var/www/html/Core/DatabaseManager.php on line 42
[01-Oct-2025 22:03:15 UTC] API Error: Error de conexión a : SQLSTATE[HY000] [2002] No such file or directory in /var/www/html/Core/DatabaseManager.php:69
[01-Oct-2025 22:03:15 UTC] PHP Warning:  Undefined array key "APP_DEBUG" in /var/www/html/Routes/api.php on line 230
[01-Oct-2025 22:03:15 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_HOST" in /var/www/html/Core/DatabaseManager.php on line 38
[01-Oct-2025 22:03:15 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_NAME" in /var/www/html/Core/DatabaseManager.php on line 40
[01-Oct-2025 22:03:15 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_USER" in /var/www/html/Core/DatabaseManager.php on line 41
[01-Oct-2025 22:03:15 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_PASS" in /var/www/html/Core/DatabaseManager.php on line 42
[01-Oct-2025 22:03:15 UTC] API Error: Error de conexión a : SQLSTATE[HY000] [2002] No such file or directory in /var/www/html/Core/DatabaseManager.php:69
[01-Oct-2025 22:03:15 UTC] PHP Warning:  Undefined array key "APP_DEBUG" in /var/www/html/Routes/api.php on line 230
[01-Oct-2025 22:03:19 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_HOST" in /var/www/html/Core/DatabaseManager.php on line 38
[01-Oct-2025 22:03:19 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_NAME" in /var/www/html/Core/DatabaseManager.php on line 40
[01-Oct-2025 22:03:19 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_USER" in /var/www/html/Core/DatabaseManager.php on line 41
[01-Oct-2025 22:03:19 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_PASS" in /var/www/html/Core/DatabaseManager.php on line 42
[01-Oct-2025 22:03:19 UTC] API Error: Error de conexión a : SQLSTATE[HY000] [2002] No such file or directory in /var/www/html/Core/DatabaseManager.php:69
[01-Oct-2025 22:03:19 UTC] PHP Warning:  Undefined array key "APP_DEBUG" in /var/www/html/Routes/api.php on line 230
[01-Oct-2025 22:03:20 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_HOST" in /var/www/html/Core/DatabaseManager.php on line 38
[01-Oct-2025 22:03:20 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_NAME" in /var/www/html/Core/DatabaseManager.php on line 40
[01-Oct-2025 22:03:20 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_USER" in /var/www/html/Core/DatabaseManager.php on line 41
[01-Oct-2025 22:03:20 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_PASS" in /var/www/html/Core/DatabaseManager.php on line 42
[01-Oct-2025 22:03:20 UTC] API Error: Error de conexión a : SQLSTATE[HY000] [2002] No such file or directory in /var/www/html/Core/DatabaseManager.php:69
[01-Oct-2025 22:03:20 UTC] PHP Warning:  Undefined array key "APP_DEBUG" in /var/www/html/Routes/api.php on line 230
[01-Oct-2025 22:03:21 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_HOST" in /var/www/html/Core/DatabaseManager.php on line 38
[01-Oct-2025 22:03:21 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_NAME" in /var/www/html/Core/DatabaseManager.php on line 40
[01-Oct-2025 22:03:21 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_USER" in /var/www/html/Core/DatabaseManager.php on line 41
[01-Oct-2025 22:03:21 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_PASS" in /var/www/html/Core/DatabaseManager.php on line 42
[01-Oct-2025 22:03:21 UTC] API Error: Error de conexión a : SQLSTATE[HY000] [2002] No such file or directory in /var/www/html/Core/DatabaseManager.php:69
[01-Oct-2025 22:03:21 UTC] PHP Warning:  Undefined array key "APP_DEBUG" in /var/www/html/Routes/api.php on line 230
[01-Oct-2025 22:03:21 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_HOST" in /var/www/html/Core/DatabaseManager.php on line 38
[01-Oct-2025 22:03:21 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_NAME" in /var/www/html/Core/DatabaseManager.php on line 40
[01-Oct-2025 22:03:21 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_USER" in /var/www/html/Core/DatabaseManager.php on line 41
[01-Oct-2025 22:03:21 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_PASS" in /var/www/html/Core/DatabaseManager.php on line 42
[01-Oct-2025 22:03:21 UTC] API Error: Error de conexión a : SQLSTATE[HY000] [2002] No such file or directory in /var/www/html/Core/DatabaseManager.php:69
[01-Oct-2025 22:03:21 UTC] PHP Warning:  Undefined array key "APP_DEBUG" in /var/www/html/Routes/api.php on line 230
[01-Oct-2025 22:03:25 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_HOST" in /var/www/html/Core/DatabaseManager.php on line 38
[01-Oct-2025 22:03:25 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_NAME" in /var/www/html/Core/DatabaseManager.php on line 40
[01-Oct-2025 22:03:25 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_USER" in /var/www/html/Core/DatabaseManager.php on line 41
[01-Oct-2025 22:03:25 UTC] PHP Warning:  Undefined array key "DB_AGENCIAS_PASS" in /var/www/html/Core/DatabaseManager.php on line 42
[01-Oct-2025 22:03:25 UTC] API Error: Error de conexión a : SQLSTATE[HY000] [2002] No such file or directory in /var/www/html/Core/DatabaseManager.php:69
[01-Oct-2025 22:03:25 UTC] PHP Warning:  Undefined array key "APP_DEBUG" in /var/www/html/Routes/api.php on line 230
[01-Oct-2025 22:05:15 UTC] PHP Fatal error:  Uncaught Error: Call to undefined method TurfReports\Controllers\AuthController::verify() in /var/www/html/Routes/api.php:121
Stack trace:
#0 {main}
  thrown in /var/www/html/Routes/api.php on line 121
[01-Oct-2025 22:05:16 UTC] DEBUG Login - Usuario encontrado: SÍ
[01-Oct-2025 22:05:16 UTC] DEBUG Login - Login BD: carreras2024
[01-Oct-2025 22:05:16 UTC] DEBUG Login - Login enviado: carreras2024
[01-Oct-2025 22:05:16 UTC] DEBUG Login - Contraseña BD: 0192023a7bbd73250516f069df18b500
[01-Oct-2025 22:05:16 UTC] DEBUG Login - Contraseña enviada: admin123
[01-Oct-2025 22:05:16 UTC] DEBUG Login - Contraseña MD5: 0192023a7bbd73250516f069df18b500
[01-Oct-2025 22:05:16 UTC] DEBUG Login - Coinciden MD5: SÍ
[01-Oct-2025 22:05:16 UTC] DEBUG Login - id_perfil: 1 (tipo: integer)
[01-Oct-2025 22:05:16 UTC] DEBUG Login - Rol asignado: admin
[01-Oct-2025 22:05:16 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:05:16 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:05:16 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:05:16 UTC] PHP Warning:  Cannot modify header information - headers already sent by (output started at /var/www/html/Services/ExportService.php:24) in /var/www/html/Controllers/ReportController.php on line 512
[01-Oct-2025 22:05:18 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:05:18 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:05:18 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:05:18 UTC] Acceso a reporte: usuario=1, reporte=informe-por-agencia, filtros={"fecha_desde":"2025-09-01","fecha_hasta":"2025-10-01"}
[01-Oct-2025 22:05:18 UTC] PHP Warning:  Cannot modify header information - headers already sent by (output started at /var/www/html/Services/ExportService.php:24) in /var/www/html/Controllers/ReportController.php on line 512
[01-Oct-2025 22:05:19 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:05:19 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:05:19 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:05:19 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-09-01","fecha_hasta":"2025-10-01"}
[01-Oct-2025 22:05:19 UTC] PHP Warning:  Cannot modify header information - headers already sent by (output started at /var/www/html/Services/ExportService.php:24) in /var/www/html/Controllers/ReportController.php on line 512
[01-Oct-2025 22:05:21 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:05:21 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:05:21 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:05:21 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-09-01","fecha_hasta":"2025-10-01"}
[01-Oct-2025 22:05:21 UTC] PHP Warning:  Cannot modify header information - headers already sent by (output started at /var/www/html/Services/ExportService.php:24) in /var/www/html/Controllers/ReportController.php on line 512
[01-Oct-2025 22:05:22 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:05:22 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:05:22 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:05:22 UTC] DEBUG - Consulta SQL ejecutada: 
            SELECT 
                cr.fecha,
                cr.nro_caballo,
                COALESCE(SUM(dt.total_apostado), 0) as total_apostado,
                COALESCE(SUM(CASE WHEN crd.devolucion = 0 THEN dt.total_apostado ELSE 0 END), 0) as monto_a_devolver,
                COALESCE(SUM(CASE WHEN crd.devolucion = 1 THEN dt.total_apostado ELSE 0 END), 0) as monto_devuelto,
                CASE 
                    WHEN SUM(dt.total_apostado) IS NULL OR SUM(dt.total_apostado) = 0 THEN 'Sin Apuestas'
                    WHEN SUM(CASE WHEN crd.devolucion = 0 THEN 1 ELSE 0 END) > 0 
                         AND SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Parcial'
                    WHEN SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Devuelto'
                    ELSE 'Pendiente'
                END as estado_devolucion
            FROM 
                tbl_caballos_retirados_ultimo_momento cr
            LEFT JOIN 
                tbl_caballos_retirados_um_detalle crd ON cr.id_caballo_retirado_ultimo_momento = crd.id_caballo_retirado_ultimo_momento
            LEFT JOIN 
                tbl_detalle_tickets dt ON crd.id_detalle_ticket = dt.id_detalle_ticket
            WHERE 1=1
            AND cr.fecha >= :fecha_desde AND cr.fecha <= :fecha_hasta
            GROUP BY
                cr.fecha, cr.nro_caballo, cr.id_carrera
            ORDER BY
                cr.fecha DESC, cr.nro_caballo ASC
            LIMIT :limit OFFSET :offset
        
[01-Oct-2025 22:05:22 UTC] DEBUG - Parámetros: {":fecha_desde":"2025-09-01",":fecha_hasta":"2025-10-01",":limit":100,":offset":0}
[01-Oct-2025 22:05:22 UTC] DEBUG - Registros obtenidos: 0 de 0 totales
[01-Oct-2025 22:05:22 UTC] PHP Warning:  Cannot modify header information - headers already sent by (output started at /var/www/html/Services/ExportService.php:24) in /var/www/html/Controllers/ReportController.php on line 512
[01-Oct-2025 22:05:24 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:05:24 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:05:24 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:05:24 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-09-01","fecha_hasta":"2025-10-01"}
[01-Oct-2025 22:05:24 UTC] PHP Warning:  Cannot modify header information - headers already sent by (output started at /var/www/html/Services/ExportService.php:24) in /var/www/html/Controllers/ReportController.php on line 512
[01-Oct-2025 22:05:27 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:05:27 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:05:27 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:05:27 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-05-05","fecha_hasta":"2025-10-01"}
[01-Oct-2025 22:05:27 UTC] PHP Warning:  Cannot modify header information - headers already sent by (output started at /var/www/html/Services/ExportService.php:24) in /var/www/html/Controllers/ReportController.php on line 512
[01-Oct-2025 22:05:29 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:05:29 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:05:29 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:05:29 UTC] DEBUG - Consulta SQL ejecutada: 
            SELECT 
                cr.fecha,
                cr.nro_caballo,
                COALESCE(SUM(dt.total_apostado), 0) as total_apostado,
                COALESCE(SUM(CASE WHEN crd.devolucion = 0 THEN dt.total_apostado ELSE 0 END), 0) as monto_a_devolver,
                COALESCE(SUM(CASE WHEN crd.devolucion = 1 THEN dt.total_apostado ELSE 0 END), 0) as monto_devuelto,
                CASE 
                    WHEN SUM(dt.total_apostado) IS NULL OR SUM(dt.total_apostado) = 0 THEN 'Sin Apuestas'
                    WHEN SUM(CASE WHEN crd.devolucion = 0 THEN 1 ELSE 0 END) > 0 
                         AND SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Parcial'
                    WHEN SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Devuelto'
                    ELSE 'Pendiente'
                END as estado_devolucion
            FROM 
                tbl_caballos_retirados_ultimo_momento cr
            LEFT JOIN 
                tbl_caballos_retirados_um_detalle crd ON cr.id_caballo_retirado_ultimo_momento = crd.id_caballo_retirado_ultimo_momento
            LEFT JOIN 
                tbl_detalle_tickets dt ON crd.id_detalle_ticket = dt.id_detalle_ticket
            WHERE 1=1
            AND cr.fecha >= :fecha_desde AND cr.fecha <= :fecha_hasta
            GROUP BY
                cr.fecha, cr.nro_caballo, cr.id_carrera
            ORDER BY
                cr.fecha DESC, cr.nro_caballo ASC
            LIMIT :limit OFFSET :offset
        
[01-Oct-2025 22:05:29 UTC] DEBUG - Parámetros: {":fecha_desde":"2025-05-05",":fecha_hasta":"2025-10-01",":limit":100,":offset":0}
[01-Oct-2025 22:05:29 UTC] DEBUG - Registros obtenidos: 16 de 16 totales
[01-Oct-2025 22:05:29 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[01-Oct-2025 22:05:29 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[01-Oct-2025 22:05:29 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[01-Oct-2025 22:05:29 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[01-Oct-2025 22:05:29 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[01-Oct-2025 22:05:29 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[01-Oct-2025 22:05:29 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[01-Oct-2025 22:05:29 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[01-Oct-2025 22:05:29 UTC] DEBUG formatearFecha - Input: '2025-07-15' (tipo: string)
[01-Oct-2025 22:05:29 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-15 -> 15/07/2025
[01-Oct-2025 22:05:29 UTC] DEBUG formatearFecha - Input: '2025-07-14' (tipo: string)
[01-Oct-2025 22:05:29 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-14 -> 14/07/2025
[01-Oct-2025 22:05:29 UTC] DEBUG formatearFecha - Input: '2025-07-11' (tipo: string)
[01-Oct-2025 22:05:29 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-11 -> 11/07/2025
[01-Oct-2025 22:05:29 UTC] DEBUG formatearFecha - Input: '2025-07-10' (tipo: string)
[01-Oct-2025 22:05:29 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-10 -> 10/07/2025
[01-Oct-2025 22:05:29 UTC] DEBUG formatearFecha - Input: '2025-07-08' (tipo: string)
[01-Oct-2025 22:05:29 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-08 -> 08/07/2025
[01-Oct-2025 22:05:29 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[01-Oct-2025 22:05:29 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[01-Oct-2025 22:05:29 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[01-Oct-2025 22:05:29 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[01-Oct-2025 22:05:29 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[01-Oct-2025 22:05:29 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[01-Oct-2025 22:05:29 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[01-Oct-2025 22:05:29 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[01-Oct-2025 22:05:29 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[01-Oct-2025 22:05:29 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[01-Oct-2025 22:05:29 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[01-Oct-2025 22:05:29 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[01-Oct-2025 22:05:29 UTC] DEBUG formatearFecha - Input: '2025-06-27' (tipo: string)
[01-Oct-2025 22:05:29 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-06-27 -> 27/06/2025
[01-Oct-2025 22:05:29 UTC] PHP Warning:  Cannot modify header information - headers already sent by (output started at /var/www/html/Services/ExportService.php:24) in /var/www/html/Controllers/ReportController.php on line 512
[01-Oct-2025 22:05:32 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:05:32 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:05:32 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:05:32 UTC] DEBUG - Consulta SQL ejecutada: 
            SELECT 
                cr.fecha,
                cr.nro_caballo,
                COALESCE(SUM(dt.total_apostado), 0) as total_apostado,
                COALESCE(SUM(CASE WHEN crd.devolucion = 0 THEN dt.total_apostado ELSE 0 END), 0) as monto_a_devolver,
                COALESCE(SUM(CASE WHEN crd.devolucion = 1 THEN dt.total_apostado ELSE 0 END), 0) as monto_devuelto,
                CASE 
                    WHEN SUM(dt.total_apostado) IS NULL OR SUM(dt.total_apostado) = 0 THEN 'Sin Apuestas'
                    WHEN SUM(CASE WHEN crd.devolucion = 0 THEN 1 ELSE 0 END) > 0 
                         AND SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Parcial'
                    WHEN SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Devuelto'
                    ELSE 'Pendiente'
                END as estado_devolucion
            FROM 
                tbl_caballos_retirados_ultimo_momento cr
            LEFT JOIN 
                tbl_caballos_retirados_um_detalle crd ON cr.id_caballo_retirado_ultimo_momento = crd.id_caballo_retirado_ultimo_momento
            LEFT JOIN 
                tbl_detalle_tickets dt ON crd.id_detalle_ticket = dt.id_detalle_ticket
            WHERE 1=1
            AND cr.fecha >= :fecha_desde AND cr.fecha <= :fecha_hasta
            GROUP BY
                cr.fecha, cr.nro_caballo, cr.id_carrera
            ORDER BY
                cr.fecha DESC, cr.nro_caballo ASC
            LIMIT :limit OFFSET :offset
        
[01-Oct-2025 22:05:32 UTC] DEBUG - Parámetros: {":fecha_desde":"2025-05-01",":fecha_hasta":"2025-10-01",":limit":100,":offset":0}
[01-Oct-2025 22:05:32 UTC] DEBUG - Registros obtenidos: 16 de 16 totales
[01-Oct-2025 22:05:32 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[01-Oct-2025 22:05:32 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[01-Oct-2025 22:05:32 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[01-Oct-2025 22:05:32 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[01-Oct-2025 22:05:32 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[01-Oct-2025 22:05:32 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[01-Oct-2025 22:05:32 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[01-Oct-2025 22:05:32 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[01-Oct-2025 22:05:32 UTC] DEBUG formatearFecha - Input: '2025-07-15' (tipo: string)
[01-Oct-2025 22:05:32 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-15 -> 15/07/2025
[01-Oct-2025 22:05:32 UTC] DEBUG formatearFecha - Input: '2025-07-14' (tipo: string)
[01-Oct-2025 22:05:32 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-14 -> 14/07/2025
[01-Oct-2025 22:05:32 UTC] DEBUG formatearFecha - Input: '2025-07-11' (tipo: string)
[01-Oct-2025 22:05:32 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-11 -> 11/07/2025
[01-Oct-2025 22:05:32 UTC] DEBUG formatearFecha - Input: '2025-07-10' (tipo: string)
[01-Oct-2025 22:05:32 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-10 -> 10/07/2025
[01-Oct-2025 22:05:32 UTC] DEBUG formatearFecha - Input: '2025-07-08' (tipo: string)
[01-Oct-2025 22:05:32 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-08 -> 08/07/2025
[01-Oct-2025 22:05:32 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[01-Oct-2025 22:05:32 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[01-Oct-2025 22:05:32 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[01-Oct-2025 22:05:32 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[01-Oct-2025 22:05:32 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[01-Oct-2025 22:05:32 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[01-Oct-2025 22:05:32 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[01-Oct-2025 22:05:32 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[01-Oct-2025 22:05:32 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[01-Oct-2025 22:05:32 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[01-Oct-2025 22:05:32 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[01-Oct-2025 22:05:32 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[01-Oct-2025 22:05:32 UTC] DEBUG formatearFecha - Input: '2025-06-27' (tipo: string)
[01-Oct-2025 22:05:32 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-06-27 -> 27/06/2025
[01-Oct-2025 22:05:32 UTC] PHP Warning:  Cannot modify header information - headers already sent by (output started at /var/www/html/Services/ExportService.php:24) in /var/www/html/Controllers/ReportController.php on line 512
[01-Oct-2025 22:06:12 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:06:12 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:06:12 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:06:12 UTC] DEBUG - Consulta SQL ejecutada: 
            SELECT 
                cr.fecha,
                cr.nro_caballo,
                COALESCE(SUM(dt.total_apostado), 0) as total_apostado,
                COALESCE(SUM(CASE WHEN crd.devolucion = 0 THEN dt.total_apostado ELSE 0 END), 0) as monto_a_devolver,
                COALESCE(SUM(CASE WHEN crd.devolucion = 1 THEN dt.total_apostado ELSE 0 END), 0) as monto_devuelto,
                CASE 
                    WHEN SUM(dt.total_apostado) IS NULL OR SUM(dt.total_apostado) = 0 THEN 'Sin Apuestas'
                    WHEN SUM(CASE WHEN crd.devolucion = 0 THEN 1 ELSE 0 END) > 0 
                         AND SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Parcial'
                    WHEN SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Devuelto'
                    ELSE 'Pendiente'
                END as estado_devolucion
            FROM 
                tbl_caballos_retirados_ultimo_momento cr
            LEFT JOIN 
                tbl_caballos_retirados_um_detalle crd ON cr.id_caballo_retirado_ultimo_momento = crd.id_caballo_retirado_ultimo_momento
            LEFT JOIN 
                tbl_detalle_tickets dt ON crd.id_detalle_ticket = dt.id_detalle_ticket
            WHERE 1=1
            AND cr.fecha >= :fecha_desde AND cr.fecha <= :fecha_hasta
            GROUP BY
                cr.fecha, cr.nro_caballo, cr.id_carrera
            ORDER BY
                cr.fecha DESC, cr.nro_caballo ASC
            LIMIT :limit OFFSET :offset
        
[01-Oct-2025 22:06:12 UTC] DEBUG - Parámetros: {":fecha_desde":"2025-05-01",":fecha_hasta":"2025-10-01",":limit":100,":offset":0}
[01-Oct-2025 22:06:12 UTC] DEBUG - Registros obtenidos: 16 de 16 totales
[01-Oct-2025 22:06:12 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[01-Oct-2025 22:06:12 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[01-Oct-2025 22:06:12 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[01-Oct-2025 22:06:12 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[01-Oct-2025 22:06:12 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[01-Oct-2025 22:06:12 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[01-Oct-2025 22:06:12 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[01-Oct-2025 22:06:12 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[01-Oct-2025 22:06:12 UTC] DEBUG formatearFecha - Input: '2025-07-15' (tipo: string)
[01-Oct-2025 22:06:12 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-15 -> 15/07/2025
[01-Oct-2025 22:06:12 UTC] DEBUG formatearFecha - Input: '2025-07-14' (tipo: string)
[01-Oct-2025 22:06:12 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-14 -> 14/07/2025
[01-Oct-2025 22:06:12 UTC] DEBUG formatearFecha - Input: '2025-07-11' (tipo: string)
[01-Oct-2025 22:06:12 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-11 -> 11/07/2025
[01-Oct-2025 22:06:12 UTC] DEBUG formatearFecha - Input: '2025-07-10' (tipo: string)
[01-Oct-2025 22:06:12 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-10 -> 10/07/2025
[01-Oct-2025 22:06:12 UTC] DEBUG formatearFecha - Input: '2025-07-08' (tipo: string)
[01-Oct-2025 22:06:12 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-08 -> 08/07/2025
[01-Oct-2025 22:06:12 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[01-Oct-2025 22:06:12 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[01-Oct-2025 22:06:12 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[01-Oct-2025 22:06:12 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[01-Oct-2025 22:06:12 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[01-Oct-2025 22:06:12 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[01-Oct-2025 22:06:12 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[01-Oct-2025 22:06:12 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[01-Oct-2025 22:06:12 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[01-Oct-2025 22:06:12 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[01-Oct-2025 22:06:12 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[01-Oct-2025 22:06:12 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[01-Oct-2025 22:06:12 UTC] DEBUG formatearFecha - Input: '2025-06-27' (tipo: string)
[01-Oct-2025 22:06:12 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-06-27 -> 27/06/2025
[01-Oct-2025 22:06:12 UTC] PHP Warning:  Cannot modify header information - headers already sent by (output started at /var/www/html/Services/ExportService.php:24) in /var/www/html/Controllers/ReportController.php on line 512
[01-Oct-2025 22:06:15 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:06:15 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:06:15 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:06:15 UTC] DEBUG Carreras - Filtros recibidos: {"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01"}
[01-Oct-2025 22:06:15 UTC] DEBUG Carreras - WHERE SQL: WHERE STR_TO_DATE(c.fecha, '%d/%m/%Y') >= STR_TO_DATE(:fecha_desde, '%Y-%m-%d') AND STR_TO_DATE(c.fecha, '%d/%m/%Y') <= STR_TO_DATE(:fecha_hasta, '%Y-%m-%d')
[01-Oct-2025 22:06:15 UTC] DEBUG Carreras - Parámetros: {":fecha_desde":"2025-05-01",":fecha_hasta":"2025-10-01"}
[01-Oct-2025 22:06:15 UTC] DEBUG Carreras - Registros obtenidos: 52
[01-Oct-2025 22:06:15 UTC] DEBUG Carreras - Primer registro: {"numero_carrera":1,"fecha":"31\/07\/2025","nombre_hipodromo":"San Isidro","estado_carrera":"Apuesta","carrera_interna_id":52}
[01-Oct-2025 22:06:15 UTC] PHP Warning:  Cannot modify header information - headers already sent by (output started at /var/www/html/Services/ExportService.php:24) in /var/www/html/Controllers/ReportController.php on line 512
[01-Oct-2025 22:06:18 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:06:18 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:06:18 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:06:18 UTC] DEBUG Carreras - Filtros recibidos: {"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01"}
[01-Oct-2025 22:06:18 UTC] DEBUG Carreras - WHERE SQL: WHERE STR_TO_DATE(c.fecha, '%d/%m/%Y') >= STR_TO_DATE(:fecha_desde, '%Y-%m-%d') AND STR_TO_DATE(c.fecha, '%d/%m/%Y') <= STR_TO_DATE(:fecha_hasta, '%Y-%m-%d')
[01-Oct-2025 22:06:18 UTC] DEBUG Carreras - Parámetros: {":fecha_desde":"2025-05-01",":fecha_hasta":"2025-10-01"}
[01-Oct-2025 22:06:18 UTC] DEBUG Carreras - Registros obtenidos: 52
[01-Oct-2025 22:06:18 UTC] DEBUG Carreras - Primer registro: {"numero_carrera":1,"fecha":"31\/07\/2025","nombre_hipodromo":"San Isidro","estado_carrera":"Apuesta","carrera_interna_id":52}
[01-Oct-2025 22:06:19 UTC] PHP Warning:  Cannot modify header information - headers already sent by (output started at /var/www/html/Services/ExportService.php:24) in /var/www/html/Controllers/ReportController.php on line 512
[01-Oct-2025 22:07:05 UTC] DEBUG Login - Usuario encontrado: SÍ
[01-Oct-2025 22:07:05 UTC] DEBUG Login - Login BD: sergio
[01-Oct-2025 22:07:05 UTC] DEBUG Login - Login enviado: sergio
[01-Oct-2025 22:07:05 UTC] DEBUG Login - Contraseña BD: b8edd54d3a1d0c046a61491b8c9dd91a
[01-Oct-2025 22:07:05 UTC] DEBUG Login - Contraseña enviada: agencia1234
[01-Oct-2025 22:07:05 UTC] DEBUG Login - Contraseña MD5: b8edd54d3a1d0c046a61491b8c9dd91a
[01-Oct-2025 22:07:05 UTC] DEBUG Login - Coinciden MD5: SÍ
[01-Oct-2025 22:07:05 UTC] DEBUG Login - id_perfil: 3 (tipo: integer)
[01-Oct-2025 22:07:05 UTC] DEBUG Login - Rol asignado: agencia
[01-Oct-2025 22:07:06 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:07:06 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:07:06 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:07:07 UTC] PHP Warning:  Cannot modify header information - headers already sent by (output started at /var/www/html/Services/ExportService.php:24) in /var/www/html/Controllers/ReportController.php on line 512
[01-Oct-2025 22:07:07 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:07:07 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:07:07 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:07:07 UTC] PHP Warning:  Cannot modify header information - headers already sent by (output started at /var/www/html/Services/ExportService.php:24) in /var/www/html/Controllers/ReportController.php on line 512
[01-Oct-2025 22:07:07 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:07:07 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:07:07 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:07:07 UTC] DEBUG getSportsCarrerasAgencia - ID Agencia: 3, Filtros: {"fecha_desde":"2025-09-01","fecha_hasta":"2025-10-01"}
[01-Oct-2025 22:07:07 UTC] DEBUG getSportsCarrerasAgencia - Query: 
            SELECT 
                c.id_carrera,
                c.fecha, 
                c.numero_carrera, 
                h.nombre_hipodromo,
                c.empate_puesto,
                ec.estado_carrera
            FROM tbl_carreras c
            INNER JOIN tbl_hipodromos h ON c.id_hipodromo = h.id_hipodromo
            INNER JOIN tbl_estados_carreras ec ON c.id_estado = ec.id_estado
            WHERE c.id_estado = 3 AND STR_TO_DATE(c.fecha, '%d/%m/%Y') >= STR_TO_DATE(:fecha_desde, '%Y-%m-%d') AND STR_TO_DATE(c.fecha, '%d/%m/%Y') <= STR_TO_DATE(:fecha_hasta, '%Y-%m-%d')
            ORDER BY h.nombre_hipodromo, c.numero_carrera ASC
        
[01-Oct-2025 22:07:07 UTC] DEBUG getSportsCarrerasAgencia - Params: {":fecha_desde":"2025-09-01",":fecha_hasta":"2025-10-01"}
[01-Oct-2025 22:07:07 UTC] DEBUG getSportsCarrerasAgencia - Carreras encontradas: 0
[01-Oct-2025 22:07:07 UTC] PHP Warning:  Cannot modify header information - headers already sent by (output started at /var/www/html/Services/ExportService.php:24) in /var/www/html/Controllers/ReportController.php on line 512
[01-Oct-2025 22:07:08 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:07:08 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:07:08 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:07:08 UTC] DEBUG Tickets Anulados - Filtros recibidos: {"fecha_desde":"2025-09-01","fecha_hasta":"2025-10-01"}
[01-Oct-2025 22:07:08 UTC] DEBUG Tickets Anulados - WHERE construido: AND STR_TO_DATE(t.fecha, '%d/%m/%Y') >= STR_TO_DATE(:fecha_desde, '%Y-%m-%d') AND STR_TO_DATE(t.fecha, '%d/%m/%Y') <= STR_TO_DATE(:fecha_hasta, '%Y-%m-%d')
[01-Oct-2025 22:07:08 UTC] DEBUG Tickets Anulados - Registros obtenidos: 0
[01-Oct-2025 22:07:08 UTC] PHP Warning:  Cannot modify header information - headers already sent by (output started at /var/www/html/Services/ExportService.php:24) in /var/www/html/Controllers/ReportController.php on line 512
[01-Oct-2025 22:07:08 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:07:08 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:07:08 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:07:08 UTC] DEBUG Tickets Anulados - Filtros recibidos: {"fecha_desde":"2025-09-01","fecha_hasta":"2025-10-01"}
[01-Oct-2025 22:07:08 UTC] DEBUG Tickets Anulados - WHERE construido: AND STR_TO_DATE(t.fecha, '%d/%m/%Y') >= STR_TO_DATE(:fecha_desde, '%Y-%m-%d') AND STR_TO_DATE(t.fecha, '%d/%m/%Y') <= STR_TO_DATE(:fecha_hasta, '%Y-%m-%d')
[01-Oct-2025 22:07:08 UTC] DEBUG Tickets Anulados - Registros obtenidos: 0
[01-Oct-2025 22:07:08 UTC] PHP Warning:  Cannot modify header information - headers already sent by (output started at /var/www/html/Services/ExportService.php:24) in /var/www/html/Controllers/ReportController.php on line 512
[01-Oct-2025 22:07:10 UTC] DEBUG Login - Usuario encontrado: SÍ
[01-Oct-2025 22:07:10 UTC] DEBUG Login - Login BD: carreras2024
[01-Oct-2025 22:07:10 UTC] DEBUG Login - Login enviado: carreras2024
[01-Oct-2025 22:07:10 UTC] DEBUG Login - Contraseña BD: 0192023a7bbd73250516f069df18b500
[01-Oct-2025 22:07:10 UTC] DEBUG Login - Contraseña enviada: admin123
[01-Oct-2025 22:07:10 UTC] DEBUG Login - Contraseña MD5: 0192023a7bbd73250516f069df18b500
[01-Oct-2025 22:07:10 UTC] DEBUG Login - Coinciden MD5: SÍ
[01-Oct-2025 22:07:10 UTC] DEBUG Login - id_perfil: 1 (tipo: integer)
[01-Oct-2025 22:07:10 UTC] DEBUG Login - Rol asignado: admin
[01-Oct-2025 22:07:10 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:07:10 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:07:10 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:07:10 UTC] PHP Warning:  Cannot modify header information - headers already sent by (output started at /var/www/html/Services/ExportService.php:24) in /var/www/html/Controllers/ReportController.php on line 512
[01-Oct-2025 22:07:12 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:07:12 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:07:12 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:07:12 UTC] DEBUG Tickets Anulados - Filtros recibidos: {"fecha_desde":"2025-09-01","fecha_hasta":"2025-10-01"}
[01-Oct-2025 22:07:12 UTC] DEBUG Tickets Anulados - WHERE construido: AND STR_TO_DATE(t.fecha, '%d/%m/%Y') >= STR_TO_DATE(:fecha_desde, '%Y-%m-%d') AND STR_TO_DATE(t.fecha, '%d/%m/%Y') <= STR_TO_DATE(:fecha_hasta, '%Y-%m-%d')
[01-Oct-2025 22:07:12 UTC] DEBUG Tickets Anulados - Registros obtenidos: 0
[01-Oct-2025 22:07:12 UTC] PHP Warning:  Cannot modify header information - headers already sent by (output started at /var/www/html/Services/ExportService.php:24) in /var/www/html/Controllers/ReportController.php on line 512
[01-Oct-2025 22:07:17 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:07:17 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:07:17 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:07:17 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-09-01","fecha_hasta":"2025-10-01"}
[01-Oct-2025 22:07:17 UTC] PHP Warning:  Cannot modify header information - headers already sent by (output started at /var/www/html/Services/ExportService.php:24) in /var/www/html/Controllers/ReportController.php on line 512
[01-Oct-2025 22:07:41 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:07:41 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:07:41 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:07:41 UTC] Acceso a reporte: usuario=1, reporte=informe-por-agencia, filtros={"fecha_desde":"2025-09-01","fecha_hasta":"2025-10-01"}
[01-Oct-2025 22:07:41 UTC] PHP Warning:  Cannot modify header information - headers already sent by (output started at /var/www/html/Services/ExportService.php:24) in /var/www/html/Controllers/ReportController.php on line 512
[01-Oct-2025 22:07:44 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:07:44 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:07:44 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:07:45 UTC] Acceso a reporte: usuario=1, reporte=informe-por-agencia, filtros={"fecha_desde":"2025-09-01","fecha_hasta":"2025-10-01"}
[01-Oct-2025 22:07:45 UTC] PHP Warning:  Cannot modify header information - headers already sent by (output started at /var/www/html/Services/ExportService.php:24) in /var/www/html/Controllers/ReportController.php on line 512
[01-Oct-2025 22:08:14 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:08:14 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:08:14 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:08:14 UTC] Acceso a reporte: usuario=1, reporte=informe-por-agencia, filtros={"fecha_desde":"2025-09-01","fecha_hasta":"2025-10-01"}
[01-Oct-2025 22:08:14 UTC] PHP Warning:  Cannot modify header information - headers already sent by (output started at /var/www/html/Services/ExportService.php:24) in /var/www/html/Controllers/ReportController.php on line 512
[01-Oct-2025 22:09:51 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:09:51 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:09:51 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:09:51 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-09-01","fecha_hasta":"2025-10-01"}
[01-Oct-2025 22:09:51 UTC] PHP Warning:  Cannot modify header information - headers already sent by (output started at /var/www/html/Services/ExportService.php:24) in /var/www/html/Controllers/ReportController.php on line 512
[01-Oct-2025 22:09:51 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:09:51 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:09:51 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:09:51 UTC] DEBUG - Consulta SQL ejecutada: 
            SELECT 
                cr.fecha,
                cr.nro_caballo,
                COALESCE(SUM(dt.total_apostado), 0) as total_apostado,
                COALESCE(SUM(CASE WHEN crd.devolucion = 0 THEN dt.total_apostado ELSE 0 END), 0) as monto_a_devolver,
                COALESCE(SUM(CASE WHEN crd.devolucion = 1 THEN dt.total_apostado ELSE 0 END), 0) as monto_devuelto,
                CASE 
                    WHEN SUM(dt.total_apostado) IS NULL OR SUM(dt.total_apostado) = 0 THEN 'Sin Apuestas'
                    WHEN SUM(CASE WHEN crd.devolucion = 0 THEN 1 ELSE 0 END) > 0 
                         AND SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Parcial'
                    WHEN SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Devuelto'
                    ELSE 'Pendiente'
                END as estado_devolucion
            FROM 
                tbl_caballos_retirados_ultimo_momento cr
            LEFT JOIN 
                tbl_caballos_retirados_um_detalle crd ON cr.id_caballo_retirado_ultimo_momento = crd.id_caballo_retirado_ultimo_momento
            LEFT JOIN 
                tbl_detalle_tickets dt ON crd.id_detalle_ticket = dt.id_detalle_ticket
            WHERE 1=1
            AND cr.fecha >= :fecha_desde AND cr.fecha <= :fecha_hasta
            GROUP BY
                cr.fecha, cr.nro_caballo, cr.id_carrera
            ORDER BY
                cr.fecha DESC, cr.nro_caballo ASC
            LIMIT :limit OFFSET :offset
        
[01-Oct-2025 22:09:51 UTC] DEBUG - Parámetros: {":fecha_desde":"2025-09-01",":fecha_hasta":"2025-10-01",":limit":100,":offset":0}
[01-Oct-2025 22:09:51 UTC] DEBUG - Registros obtenidos: 0 de 0 totales
[01-Oct-2025 22:09:51 UTC] PHP Warning:  Cannot modify header information - headers already sent by (output started at /var/www/html/Services/ExportService.php:24) in /var/www/html/Controllers/ReportController.php on line 512
[01-Oct-2025 22:09:52 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:09:52 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:09:52 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:09:52 UTC] DEBUG Carreras - Filtros recibidos: {"fecha_desde":"2025-09-01","fecha_hasta":"2025-10-01"}
[01-Oct-2025 22:09:52 UTC] DEBUG Carreras - WHERE SQL: WHERE STR_TO_DATE(c.fecha, '%d/%m/%Y') >= STR_TO_DATE(:fecha_desde, '%Y-%m-%d') AND STR_TO_DATE(c.fecha, '%d/%m/%Y') <= STR_TO_DATE(:fecha_hasta, '%Y-%m-%d')
[01-Oct-2025 22:09:52 UTC] DEBUG Carreras - Parámetros: {":fecha_desde":"2025-09-01",":fecha_hasta":"2025-10-01"}
[01-Oct-2025 22:09:52 UTC] DEBUG Carreras - Registros obtenidos: 0
[01-Oct-2025 22:09:52 UTC] PHP Warning:  Cannot modify header information - headers already sent by (output started at /var/www/html/Services/ExportService.php:24) in /var/www/html/Controllers/ReportController.php on line 512
[01-Oct-2025 22:09:52 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:09:52 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:09:52 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:09:52 UTC] DEBUG - Consulta SQL ejecutada: 
            SELECT 
                cr.fecha,
                cr.nro_caballo,
                COALESCE(SUM(dt.total_apostado), 0) as total_apostado,
                COALESCE(SUM(CASE WHEN crd.devolucion = 0 THEN dt.total_apostado ELSE 0 END), 0) as monto_a_devolver,
                COALESCE(SUM(CASE WHEN crd.devolucion = 1 THEN dt.total_apostado ELSE 0 END), 0) as monto_devuelto,
                CASE 
                    WHEN SUM(dt.total_apostado) IS NULL OR SUM(dt.total_apostado) = 0 THEN 'Sin Apuestas'
                    WHEN SUM(CASE WHEN crd.devolucion = 0 THEN 1 ELSE 0 END) > 0 
                         AND SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Parcial'
                    WHEN SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Devuelto'
                    ELSE 'Pendiente'
                END as estado_devolucion
            FROM 
                tbl_caballos_retirados_ultimo_momento cr
            LEFT JOIN 
                tbl_caballos_retirados_um_detalle crd ON cr.id_caballo_retirado_ultimo_momento = crd.id_caballo_retirado_ultimo_momento
            LEFT JOIN 
                tbl_detalle_tickets dt ON crd.id_detalle_ticket = dt.id_detalle_ticket
            WHERE 1=1
            AND cr.fecha >= :fecha_desde AND cr.fecha <= :fecha_hasta
            GROUP BY
                cr.fecha, cr.nro_caballo, cr.id_carrera
            ORDER BY
                cr.fecha DESC, cr.nro_caballo ASC
            LIMIT :limit OFFSET :offset
        
[01-Oct-2025 22:09:52 UTC] DEBUG - Parámetros: {":fecha_desde":"2025-09-01",":fecha_hasta":"2025-10-01",":limit":100,":offset":0}
[01-Oct-2025 22:09:52 UTC] DEBUG - Registros obtenidos: 0 de 0 totales
[01-Oct-2025 22:09:52 UTC] PHP Warning:  Cannot modify header information - headers already sent by (output started at /var/www/html/Services/ExportService.php:24) in /var/www/html/Controllers/ReportController.php on line 512
[01-Oct-2025 22:09:53 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:09:53 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:09:53 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:09:53 UTC] DEBUG Carreras - Filtros recibidos: {"fecha_desde":"2025-09-01","fecha_hasta":"2025-10-01"}
[01-Oct-2025 22:09:53 UTC] DEBUG Carreras - WHERE SQL: WHERE STR_TO_DATE(c.fecha, '%d/%m/%Y') >= STR_TO_DATE(:fecha_desde, '%Y-%m-%d') AND STR_TO_DATE(c.fecha, '%d/%m/%Y') <= STR_TO_DATE(:fecha_hasta, '%Y-%m-%d')
[01-Oct-2025 22:09:53 UTC] DEBUG Carreras - Parámetros: {":fecha_desde":"2025-09-01",":fecha_hasta":"2025-10-01"}
[01-Oct-2025 22:09:53 UTC] DEBUG Carreras - Registros obtenidos: 0
[01-Oct-2025 22:09:53 UTC] PHP Warning:  Cannot modify header information - headers already sent by (output started at /var/www/html/Services/ExportService.php:24) in /var/www/html/Controllers/ReportController.php on line 512
[01-Oct-2025 22:09:53 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:09:53 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:09:53 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:09:53 UTC] DEBUG Tickets Anulados - Filtros recibidos: {"fecha_desde":"2025-09-01","fecha_hasta":"2025-10-01"}
[01-Oct-2025 22:09:53 UTC] DEBUG Tickets Anulados - WHERE construido: AND STR_TO_DATE(t.fecha, '%d/%m/%Y') >= STR_TO_DATE(:fecha_desde, '%Y-%m-%d') AND STR_TO_DATE(t.fecha, '%d/%m/%Y') <= STR_TO_DATE(:fecha_hasta, '%Y-%m-%d')
[01-Oct-2025 22:09:53 UTC] DEBUG Tickets Anulados - Registros obtenidos: 0
[01-Oct-2025 22:09:53 UTC] PHP Warning:  Cannot modify header information - headers already sent by (output started at /var/www/html/Services/ExportService.php:24) in /var/www/html/Controllers/ReportController.php on line 512
[01-Oct-2025 22:09:54 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:09:54 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:09:54 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:09:54 UTC] DEBUG Tickets Anulados - Filtros recibidos: {"fecha_desde":"2025-09-01","fecha_hasta":"2025-10-01"}
[01-Oct-2025 22:09:54 UTC] DEBUG Tickets Anulados - WHERE construido: AND STR_TO_DATE(t.fecha, '%d/%m/%Y') >= STR_TO_DATE(:fecha_desde, '%Y-%m-%d') AND STR_TO_DATE(t.fecha, '%d/%m/%Y') <= STR_TO_DATE(:fecha_hasta, '%Y-%m-%d')
[01-Oct-2025 22:09:54 UTC] DEBUG Tickets Anulados - Registros obtenidos: 0
[01-Oct-2025 22:09:54 UTC] PHP Warning:  Cannot modify header information - headers already sent by (output started at /var/www/html/Services/ExportService.php:24) in /var/www/html/Controllers/ReportController.php on line 512
[01-Oct-2025 22:09:55 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:09:55 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:09:55 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:09:55 UTC] DEBUG Carreras - Filtros recibidos: {"fecha_desde":"2025-09-01","fecha_hasta":"2025-10-01"}
[01-Oct-2025 22:09:55 UTC] DEBUG Carreras - WHERE SQL: WHERE STR_TO_DATE(c.fecha, '%d/%m/%Y') >= STR_TO_DATE(:fecha_desde, '%Y-%m-%d') AND STR_TO_DATE(c.fecha, '%d/%m/%Y') <= STR_TO_DATE(:fecha_hasta, '%Y-%m-%d')
[01-Oct-2025 22:09:55 UTC] DEBUG Carreras - Parámetros: {":fecha_desde":"2025-09-01",":fecha_hasta":"2025-10-01"}
[01-Oct-2025 22:09:55 UTC] DEBUG Carreras - Registros obtenidos: 0
[01-Oct-2025 22:09:55 UTC] PHP Warning:  Cannot modify header information - headers already sent by (output started at /var/www/html/Services/ExportService.php:24) in /var/www/html/Controllers/ReportController.php on line 512
[01-Oct-2025 22:09:55 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:09:56 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:09:56 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:09:56 UTC] DEBUG Carreras - Filtros recibidos: {"fecha_desde":"2025-09-01","fecha_hasta":"2025-10-01"}
[01-Oct-2025 22:09:56 UTC] DEBUG Carreras - WHERE SQL: WHERE STR_TO_DATE(c.fecha, '%d/%m/%Y') >= STR_TO_DATE(:fecha_desde, '%Y-%m-%d') AND STR_TO_DATE(c.fecha, '%d/%m/%Y') <= STR_TO_DATE(:fecha_hasta, '%Y-%m-%d')
[01-Oct-2025 22:09:56 UTC] DEBUG Carreras - Parámetros: {":fecha_desde":"2025-09-01",":fecha_hasta":"2025-10-01"}
[01-Oct-2025 22:09:56 UTC] DEBUG Carreras - Registros obtenidos: 0
[01-Oct-2025 22:09:56 UTC] PHP Warning:  Cannot modify header information - headers already sent by (output started at /var/www/html/Services/ExportService.php:24) in /var/www/html/Controllers/ReportController.php on line 512
[01-Oct-2025 22:12:59 UTC] DEBUG Login - Usuario encontrado: SÍ
[01-Oct-2025 22:12:59 UTC] DEBUG Login - Login BD: carreras2024
[01-Oct-2025 22:12:59 UTC] DEBUG Login - Login enviado: carreras2024
[01-Oct-2025 22:12:59 UTC] DEBUG Login - Contraseña BD: 0192023a7bbd73250516f069df18b500
[01-Oct-2025 22:12:59 UTC] DEBUG Login - Contraseña enviada: admin123
[01-Oct-2025 22:12:59 UTC] DEBUG Login - Contraseña MD5: 0192023a7bbd73250516f069df18b500
[01-Oct-2025 22:12:59 UTC] DEBUG Login - Coinciden MD5: SÍ
[01-Oct-2025 22:12:59 UTC] DEBUG Login - id_perfil: 1 (tipo: integer)
[01-Oct-2025 22:12:59 UTC] DEBUG Login - Rol asignado: admin
[01-Oct-2025 22:13:00 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:13:00 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:13:00 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:13:00 UTC] PHP Warning:  Cannot modify header information - headers already sent by (output started at /var/www/html/Services/ExportService.php:24) in /var/www/html/Controllers/ReportController.php on line 512
[01-Oct-2025 22:13:11 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:13:11 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:13:11 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:13:11 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-09-01","fecha_hasta":"2025-10-01"}
[01-Oct-2025 22:13:11 UTC] PHP Warning:  Cannot modify header information - headers already sent by (output started at /var/www/html/Services/ExportService.php:24) in /var/www/html/Controllers/ReportController.php on line 512
[01-Oct-2025 22:13:13 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:13:13 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:13:13 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:13:14 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-09-01","fecha_hasta":"2025-10-01"}
[01-Oct-2025 22:13:14 UTC] PHP Warning:  Cannot modify header information - headers already sent by (output started at /var/www/html/Services/ExportService.php:24) in /var/www/html/Controllers/ReportController.php on line 512
[01-Oct-2025 22:13:59 UTC] DEBUG Login - Usuario encontrado: SÍ
[01-Oct-2025 22:13:59 UTC] DEBUG Login - Login BD: sergio
[01-Oct-2025 22:13:59 UTC] DEBUG Login - Login enviado: sergio
[01-Oct-2025 22:13:59 UTC] DEBUG Login - Contraseña BD: b8edd54d3a1d0c046a61491b8c9dd91a
[01-Oct-2025 22:13:59 UTC] DEBUG Login - Contraseña enviada: agencia1234
[01-Oct-2025 22:13:59 UTC] DEBUG Login - Contraseña MD5: b8edd54d3a1d0c046a61491b8c9dd91a
[01-Oct-2025 22:13:59 UTC] DEBUG Login - Coinciden MD5: SÍ
[01-Oct-2025 22:13:59 UTC] DEBUG Login - id_perfil: 3 (tipo: integer)
[01-Oct-2025 22:13:59 UTC] DEBUG Login - Rol asignado: agencia
[01-Oct-2025 22:14:00 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:14:00 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:14:00 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:14:00 UTC] PHP Warning:  Cannot modify header information - headers already sent by (output started at /var/www/html/Services/ExportService.php:24) in /var/www/html/Controllers/ReportController.php on line 512
[01-Oct-2025 22:14:01 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:14:01 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:14:01 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:14:01 UTC] PHP Warning:  Cannot modify header information - headers already sent by (output started at /var/www/html/Services/ExportService.php:24) in /var/www/html/Controllers/ReportController.php on line 512
[01-Oct-2025 22:16:42 UTC] PHP Fatal error:  Uncaught Error: Call to undefined method TurfReports\Controllers\AuthController::verify() in /var/www/html/Routes/api.php:121
Stack trace:
#0 {main}
  thrown in /var/www/html/Routes/api.php on line 121
[01-Oct-2025 22:16:44 UTC] DEBUG Login - Usuario encontrado: SÍ
[01-Oct-2025 22:16:44 UTC] DEBUG Login - Login BD: carreras2024
[01-Oct-2025 22:16:44 UTC] DEBUG Login - Login enviado: carreras2024
[01-Oct-2025 22:16:44 UTC] DEBUG Login - Contraseña BD: 0192023a7bbd73250516f069df18b500
[01-Oct-2025 22:16:44 UTC] DEBUG Login - Contraseña enviada: admin123
[01-Oct-2025 22:16:44 UTC] DEBUG Login - Contraseña MD5: 0192023a7bbd73250516f069df18b500
[01-Oct-2025 22:16:44 UTC] DEBUG Login - Coinciden MD5: SÍ
[01-Oct-2025 22:16:44 UTC] DEBUG Login - id_perfil: 1 (tipo: integer)
[01-Oct-2025 22:16:44 UTC] DEBUG Login - Rol asignado: admin
[01-Oct-2025 22:16:44 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:16:44 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:16:44 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:16:45 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:16:45 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:16:45 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:16:45 UTC] Acceso a reporte: usuario=1, reporte=informe-por-agencia, filtros={"fecha_desde":"2025-09-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:16:49 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:16:49 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:16:49 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:16:49 UTC] Acceso a reporte: usuario=1, reporte=informe-por-agencia, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:16:50 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:16:50 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:16:50 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:16:50 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:16:51 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:16:51 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:16:51 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:16:51 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:16:52 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:16:52 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:16:52 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:16:52 UTC] DEBUG - Consulta SQL ejecutada: 
            SELECT 
                cr.fecha,
                cr.nro_caballo,
                COALESCE(SUM(dt.total_apostado), 0) as total_apostado,
                COALESCE(SUM(CASE WHEN crd.devolucion = 0 THEN dt.total_apostado ELSE 0 END), 0) as monto_a_devolver,
                COALESCE(SUM(CASE WHEN crd.devolucion = 1 THEN dt.total_apostado ELSE 0 END), 0) as monto_devuelto,
                CASE 
                    WHEN SUM(dt.total_apostado) IS NULL OR SUM(dt.total_apostado) = 0 THEN 'Sin Apuestas'
                    WHEN SUM(CASE WHEN crd.devolucion = 0 THEN 1 ELSE 0 END) > 0 
                         AND SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Parcial'
                    WHEN SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Devuelto'
                    ELSE 'Pendiente'
                END as estado_devolucion
            FROM 
                tbl_caballos_retirados_ultimo_momento cr
            LEFT JOIN 
                tbl_caballos_retirados_um_detalle crd ON cr.id_caballo_retirado_ultimo_momento = crd.id_caballo_retirado_ultimo_momento
            LEFT JOIN 
                tbl_detalle_tickets dt ON crd.id_detalle_ticket = dt.id_detalle_ticket
            WHERE 1=1
            AND cr.fecha >= :fecha_desde AND cr.fecha <= :fecha_hasta
            GROUP BY
                cr.fecha, cr.nro_caballo, cr.id_carrera
            ORDER BY
                cr.fecha DESC, cr.nro_caballo ASC
            LIMIT :limit OFFSET :offset
        
[01-Oct-2025 22:16:52 UTC] DEBUG - Parámetros: {":fecha_desde":"2025-05-01",":fecha_hasta":"2025-10-01",":limit":50,":offset":0}
[01-Oct-2025 22:16:52 UTC] DEBUG - Registros obtenidos: 16 de 16 totales
[01-Oct-2025 22:16:52 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[01-Oct-2025 22:16:52 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[01-Oct-2025 22:16:52 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[01-Oct-2025 22:16:52 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[01-Oct-2025 22:16:52 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[01-Oct-2025 22:16:52 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[01-Oct-2025 22:16:52 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[01-Oct-2025 22:16:52 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[01-Oct-2025 22:16:52 UTC] DEBUG formatearFecha - Input: '2025-07-15' (tipo: string)
[01-Oct-2025 22:16:52 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-15 -> 15/07/2025
[01-Oct-2025 22:16:52 UTC] DEBUG formatearFecha - Input: '2025-07-14' (tipo: string)
[01-Oct-2025 22:16:52 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-14 -> 14/07/2025
[01-Oct-2025 22:16:52 UTC] DEBUG formatearFecha - Input: '2025-07-11' (tipo: string)
[01-Oct-2025 22:16:52 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-11 -> 11/07/2025
[01-Oct-2025 22:16:52 UTC] DEBUG formatearFecha - Input: '2025-07-10' (tipo: string)
[01-Oct-2025 22:16:52 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-10 -> 10/07/2025
[01-Oct-2025 22:16:52 UTC] DEBUG formatearFecha - Input: '2025-07-08' (tipo: string)
[01-Oct-2025 22:16:52 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-08 -> 08/07/2025
[01-Oct-2025 22:16:52 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[01-Oct-2025 22:16:52 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[01-Oct-2025 22:16:52 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[01-Oct-2025 22:16:52 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[01-Oct-2025 22:16:52 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[01-Oct-2025 22:16:52 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[01-Oct-2025 22:16:52 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[01-Oct-2025 22:16:52 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[01-Oct-2025 22:16:52 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[01-Oct-2025 22:16:52 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[01-Oct-2025 22:16:52 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[01-Oct-2025 22:16:52 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[01-Oct-2025 22:16:52 UTC] DEBUG formatearFecha - Input: '2025-06-27' (tipo: string)
[01-Oct-2025 22:16:52 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-06-27 -> 27/06/2025
[01-Oct-2025 22:16:56 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:16:56 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:16:56 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:16:56 UTC] DEBUG Carreras - Filtros recibidos: {"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:16:56 UTC] DEBUG Carreras - WHERE SQL: WHERE STR_TO_DATE(c.fecha, '%d/%m/%Y') >= STR_TO_DATE(:fecha_desde, '%Y-%m-%d') AND STR_TO_DATE(c.fecha, '%d/%m/%Y') <= STR_TO_DATE(:fecha_hasta, '%Y-%m-%d')
[01-Oct-2025 22:16:56 UTC] DEBUG Carreras - Parámetros: {":fecha_desde":"2025-05-01",":fecha_hasta":"2025-10-01"}
[01-Oct-2025 22:16:56 UTC] DEBUG Carreras - Registros obtenidos: 50
[01-Oct-2025 22:16:56 UTC] DEBUG Carreras - Primer registro: {"numero_carrera":1,"fecha":"31\/07\/2025","nombre_hipodromo":"San Isidro","estado_carrera":"Apuesta","carrera_interna_id":52}
[01-Oct-2025 22:16:56 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:16:56 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:16:56 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:16:56 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:16:57 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:16:57 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:16:57 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:16:57 UTC] Acceso a reporte: usuario=1, reporte=informe-por-agencia, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:16:58 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:16:58 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:16:58 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:16:58 UTC] Acceso a reporte: usuario=1, reporte=informe-por-agencia, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:16:59 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:16:59 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:16:59 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:16:59 UTC] DEBUG - Consulta SQL ejecutada: 
            SELECT 
                cr.fecha,
                cr.nro_caballo,
                COALESCE(SUM(dt.total_apostado), 0) as total_apostado,
                COALESCE(SUM(CASE WHEN crd.devolucion = 0 THEN dt.total_apostado ELSE 0 END), 0) as monto_a_devolver,
                COALESCE(SUM(CASE WHEN crd.devolucion = 1 THEN dt.total_apostado ELSE 0 END), 0) as monto_devuelto,
                CASE 
                    WHEN SUM(dt.total_apostado) IS NULL OR SUM(dt.total_apostado) = 0 THEN 'Sin Apuestas'
                    WHEN SUM(CASE WHEN crd.devolucion = 0 THEN 1 ELSE 0 END) > 0 
                         AND SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Parcial'
                    WHEN SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Devuelto'
                    ELSE 'Pendiente'
                END as estado_devolucion
            FROM 
                tbl_caballos_retirados_ultimo_momento cr
            LEFT JOIN 
                tbl_caballos_retirados_um_detalle crd ON cr.id_caballo_retirado_ultimo_momento = crd.id_caballo_retirado_ultimo_momento
            LEFT JOIN 
                tbl_detalle_tickets dt ON crd.id_detalle_ticket = dt.id_detalle_ticket
            WHERE 1=1
            AND cr.fecha >= :fecha_desde AND cr.fecha <= :fecha_hasta
            GROUP BY
                cr.fecha, cr.nro_caballo, cr.id_carrera
            ORDER BY
                cr.fecha DESC, cr.nro_caballo ASC
            LIMIT :limit OFFSET :offset
        
[01-Oct-2025 22:16:59 UTC] DEBUG - Parámetros: {":fecha_desde":"2025-05-01",":fecha_hasta":"2025-10-01",":limit":50,":offset":0}
[01-Oct-2025 22:16:59 UTC] DEBUG - Registros obtenidos: 16 de 16 totales
[01-Oct-2025 22:16:59 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[01-Oct-2025 22:16:59 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[01-Oct-2025 22:16:59 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[01-Oct-2025 22:16:59 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[01-Oct-2025 22:16:59 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[01-Oct-2025 22:16:59 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[01-Oct-2025 22:16:59 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[01-Oct-2025 22:16:59 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[01-Oct-2025 22:16:59 UTC] DEBUG formatearFecha - Input: '2025-07-15' (tipo: string)
[01-Oct-2025 22:16:59 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-15 -> 15/07/2025
[01-Oct-2025 22:16:59 UTC] DEBUG formatearFecha - Input: '2025-07-14' (tipo: string)
[01-Oct-2025 22:16:59 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-14 -> 14/07/2025
[01-Oct-2025 22:16:59 UTC] DEBUG formatearFecha - Input: '2025-07-11' (tipo: string)
[01-Oct-2025 22:16:59 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-11 -> 11/07/2025
[01-Oct-2025 22:16:59 UTC] DEBUG formatearFecha - Input: '2025-07-10' (tipo: string)
[01-Oct-2025 22:16:59 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-10 -> 10/07/2025
[01-Oct-2025 22:16:59 UTC] DEBUG formatearFecha - Input: '2025-07-08' (tipo: string)
[01-Oct-2025 22:16:59 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-08 -> 08/07/2025
[01-Oct-2025 22:16:59 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[01-Oct-2025 22:16:59 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[01-Oct-2025 22:16:59 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[01-Oct-2025 22:16:59 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[01-Oct-2025 22:16:59 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[01-Oct-2025 22:16:59 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[01-Oct-2025 22:16:59 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[01-Oct-2025 22:16:59 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[01-Oct-2025 22:16:59 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[01-Oct-2025 22:16:59 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[01-Oct-2025 22:16:59 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[01-Oct-2025 22:16:59 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[01-Oct-2025 22:16:59 UTC] DEBUG formatearFecha - Input: '2025-06-27' (tipo: string)
[01-Oct-2025 22:16:59 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-06-27 -> 27/06/2025
[01-Oct-2025 22:17:01 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:17:01 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:17:01 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:17:01 UTC] DEBUG - Consulta SQL ejecutada: 
            SELECT 
                cr.fecha,
                cr.nro_caballo,
                COALESCE(SUM(dt.total_apostado), 0) as total_apostado,
                COALESCE(SUM(CASE WHEN crd.devolucion = 0 THEN dt.total_apostado ELSE 0 END), 0) as monto_a_devolver,
                COALESCE(SUM(CASE WHEN crd.devolucion = 1 THEN dt.total_apostado ELSE 0 END), 0) as monto_devuelto,
                CASE 
                    WHEN SUM(dt.total_apostado) IS NULL OR SUM(dt.total_apostado) = 0 THEN 'Sin Apuestas'
                    WHEN SUM(CASE WHEN crd.devolucion = 0 THEN 1 ELSE 0 END) > 0 
                         AND SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Parcial'
                    WHEN SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Devuelto'
                    ELSE 'Pendiente'
                END as estado_devolucion
            FROM 
                tbl_caballos_retirados_ultimo_momento cr
            LEFT JOIN 
                tbl_caballos_retirados_um_detalle crd ON cr.id_caballo_retirado_ultimo_momento = crd.id_caballo_retirado_ultimo_momento
            LEFT JOIN 
                tbl_detalle_tickets dt ON crd.id_detalle_ticket = dt.id_detalle_ticket
            WHERE 1=1
            AND cr.fecha >= :fecha_desde AND cr.fecha <= :fecha_hasta
            GROUP BY
                cr.fecha, cr.nro_caballo, cr.id_carrera
            ORDER BY
                cr.fecha DESC, cr.nro_caballo ASC
            LIMIT :limit OFFSET :offset
        
[01-Oct-2025 22:17:01 UTC] DEBUG - Parámetros: {":fecha_desde":"2025-05-01",":fecha_hasta":"2025-10-01",":limit":50,":offset":0}
[01-Oct-2025 22:17:01 UTC] DEBUG - Registros obtenidos: 16 de 16 totales
[01-Oct-2025 22:17:01 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[01-Oct-2025 22:17:01 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[01-Oct-2025 22:17:01 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[01-Oct-2025 22:17:01 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[01-Oct-2025 22:17:01 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[01-Oct-2025 22:17:01 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[01-Oct-2025 22:17:01 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[01-Oct-2025 22:17:01 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[01-Oct-2025 22:17:01 UTC] DEBUG formatearFecha - Input: '2025-07-15' (tipo: string)
[01-Oct-2025 22:17:01 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-15 -> 15/07/2025
[01-Oct-2025 22:17:01 UTC] DEBUG formatearFecha - Input: '2025-07-14' (tipo: string)
[01-Oct-2025 22:17:01 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-14 -> 14/07/2025
[01-Oct-2025 22:17:01 UTC] DEBUG formatearFecha - Input: '2025-07-11' (tipo: string)
[01-Oct-2025 22:17:01 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-11 -> 11/07/2025
[01-Oct-2025 22:17:01 UTC] DEBUG formatearFecha - Input: '2025-07-10' (tipo: string)
[01-Oct-2025 22:17:01 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-10 -> 10/07/2025
[01-Oct-2025 22:17:01 UTC] DEBUG formatearFecha - Input: '2025-07-08' (tipo: string)
[01-Oct-2025 22:17:01 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-08 -> 08/07/2025
[01-Oct-2025 22:17:01 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[01-Oct-2025 22:17:01 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[01-Oct-2025 22:17:01 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[01-Oct-2025 22:17:01 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[01-Oct-2025 22:17:01 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[01-Oct-2025 22:17:01 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[01-Oct-2025 22:17:01 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[01-Oct-2025 22:17:01 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[01-Oct-2025 22:17:01 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[01-Oct-2025 22:17:01 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[01-Oct-2025 22:17:01 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[01-Oct-2025 22:17:01 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[01-Oct-2025 22:17:01 UTC] DEBUG formatearFecha - Input: '2025-06-27' (tipo: string)
[01-Oct-2025 22:17:01 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-06-27 -> 27/06/2025
[01-Oct-2025 22:17:02 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:17:02 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:17:02 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:17:02 UTC] DEBUG Carreras - Filtros recibidos: {"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:17:02 UTC] DEBUG Carreras - WHERE SQL: WHERE STR_TO_DATE(c.fecha, '%d/%m/%Y') >= STR_TO_DATE(:fecha_desde, '%Y-%m-%d') AND STR_TO_DATE(c.fecha, '%d/%m/%Y') <= STR_TO_DATE(:fecha_hasta, '%Y-%m-%d')
[01-Oct-2025 22:17:02 UTC] DEBUG Carreras - Parámetros: {":fecha_desde":"2025-05-01",":fecha_hasta":"2025-10-01"}
[01-Oct-2025 22:17:02 UTC] DEBUG Carreras - Registros obtenidos: 50
[01-Oct-2025 22:17:02 UTC] DEBUG Carreras - Primer registro: {"numero_carrera":1,"fecha":"31\/07\/2025","nombre_hipodromo":"San Isidro","estado_carrera":"Apuesta","carrera_interna_id":52}
[01-Oct-2025 22:17:03 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:17:03 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:17:03 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:17:03 UTC] DEBUG Tickets Anulados - Filtros recibidos: {"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:17:03 UTC] DEBUG Tickets Anulados - WHERE construido: AND STR_TO_DATE(t.fecha, '%d/%m/%Y') >= STR_TO_DATE(:fecha_desde, '%Y-%m-%d') AND STR_TO_DATE(t.fecha, '%d/%m/%Y') <= STR_TO_DATE(:fecha_hasta, '%Y-%m-%d')
[01-Oct-2025 22:17:03 UTC] DEBUG Tickets Anulados - Registros obtenidos: 12
[01-Oct-2025 22:17:03 UTC] DEBUG Tickets Anulados - Primer registro: {"nro_ticket":133,"fecha":"31\/07\/2025","hora":"10:01:20","nombre_usuario":"Agencia 24","nombre_agencia":"Morteros","total_apostado":10000}
[01-Oct-2025 22:17:03 UTC] DEBUG formatearFecha - Input: '31/07/2025' (tipo: string)
[01-Oct-2025 22:17:03 UTC] DEBUG formatearFecha - Ya en formato correcto: 31/07/2025
[01-Oct-2025 22:17:03 UTC] DEBUG formatearFecha - Input: '06/07/2025' (tipo: string)
[01-Oct-2025 22:17:03 UTC] DEBUG formatearFecha - Ya en formato correcto: 06/07/2025
[01-Oct-2025 22:17:03 UTC] DEBUG formatearFecha - Input: '05/07/2025' (tipo: string)
[01-Oct-2025 22:17:03 UTC] DEBUG formatearFecha - Ya en formato correcto: 05/07/2025
[01-Oct-2025 22:17:03 UTC] DEBUG formatearFecha - Input: '04/07/2025' (tipo: string)
[01-Oct-2025 22:17:03 UTC] DEBUG formatearFecha - Ya en formato correcto: 04/07/2025
[01-Oct-2025 22:17:03 UTC] DEBUG formatearFecha - Input: '02/07/2025' (tipo: string)
[01-Oct-2025 22:17:03 UTC] DEBUG formatearFecha - Ya en formato correcto: 02/07/2025
[01-Oct-2025 22:17:03 UTC] DEBUG formatearFecha - Input: '02/07/2025' (tipo: string)
[01-Oct-2025 22:17:03 UTC] DEBUG formatearFecha - Ya en formato correcto: 02/07/2025
[01-Oct-2025 22:17:03 UTC] DEBUG formatearFecha - Input: '02/07/2025' (tipo: string)
[01-Oct-2025 22:17:03 UTC] DEBUG formatearFecha - Ya en formato correcto: 02/07/2025
[01-Oct-2025 22:17:03 UTC] DEBUG formatearFecha - Input: '02/07/2025' (tipo: string)
[01-Oct-2025 22:17:03 UTC] DEBUG formatearFecha - Ya en formato correcto: 02/07/2025
[01-Oct-2025 22:17:03 UTC] DEBUG formatearFecha - Input: '01/07/2025' (tipo: string)
[01-Oct-2025 22:17:03 UTC] DEBUG formatearFecha - Ya en formato correcto: 01/07/2025
[01-Oct-2025 22:17:03 UTC] DEBUG formatearFecha - Input: '01/07/2025' (tipo: string)
[01-Oct-2025 22:17:03 UTC] DEBUG formatearFecha - Ya en formato correcto: 01/07/2025
[01-Oct-2025 22:17:03 UTC] DEBUG formatearFecha - Input: '01/07/2025' (tipo: string)
[01-Oct-2025 22:17:03 UTC] DEBUG formatearFecha - Ya en formato correcto: 01/07/2025
[01-Oct-2025 22:17:03 UTC] DEBUG formatearFecha - Input: '30/06/2025' (tipo: string)
[01-Oct-2025 22:17:03 UTC] DEBUG formatearFecha - Ya en formato correcto: 30/06/2025
[01-Oct-2025 22:17:14 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:17:14 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:17:14 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:17:14 UTC] DEBUG Carreras - Filtros recibidos: {"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:17:14 UTC] DEBUG Carreras - WHERE SQL: WHERE STR_TO_DATE(c.fecha, '%d/%m/%Y') >= STR_TO_DATE(:fecha_desde, '%Y-%m-%d') AND STR_TO_DATE(c.fecha, '%d/%m/%Y') <= STR_TO_DATE(:fecha_hasta, '%Y-%m-%d')
[01-Oct-2025 22:17:14 UTC] DEBUG Carreras - Parámetros: {":fecha_desde":"2025-05-01",":fecha_hasta":"2025-10-01"}
[01-Oct-2025 22:17:14 UTC] DEBUG Carreras - Registros obtenidos: 50
[01-Oct-2025 22:17:14 UTC] DEBUG Carreras - Primer registro: {"numero_carrera":1,"fecha":"31\/07\/2025","nombre_hipodromo":"San Isidro","estado_carrera":"Apuesta","carrera_interna_id":52}
[01-Oct-2025 22:17:18 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:17:18 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:17:18 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:17:18 UTC] DEBUG getResultadosCarrera - ID Carrera: 48
[01-Oct-2025 22:17:18 UTC] DEBUG getResultadosCarrera - Resultados encontrados: 8
[01-Oct-2025 22:17:20 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:17:20 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:17:20 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:17:20 UTC] DEBUG - Consulta SQL ejecutada: 
            SELECT 
                cr.fecha,
                cr.nro_caballo,
                COALESCE(SUM(dt.total_apostado), 0) as total_apostado,
                COALESCE(SUM(CASE WHEN crd.devolucion = 0 THEN dt.total_apostado ELSE 0 END), 0) as monto_a_devolver,
                COALESCE(SUM(CASE WHEN crd.devolucion = 1 THEN dt.total_apostado ELSE 0 END), 0) as monto_devuelto,
                CASE 
                    WHEN SUM(dt.total_apostado) IS NULL OR SUM(dt.total_apostado) = 0 THEN 'Sin Apuestas'
                    WHEN SUM(CASE WHEN crd.devolucion = 0 THEN 1 ELSE 0 END) > 0 
                         AND SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Parcial'
                    WHEN SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Devuelto'
                    ELSE 'Pendiente'
                END as estado_devolucion
            FROM 
                tbl_caballos_retirados_ultimo_momento cr
            LEFT JOIN 
                tbl_caballos_retirados_um_detalle crd ON cr.id_caballo_retirado_ultimo_momento = crd.id_caballo_retirado_ultimo_momento
            LEFT JOIN 
                tbl_detalle_tickets dt ON crd.id_detalle_ticket = dt.id_detalle_ticket
            WHERE 1=1
            AND cr.fecha >= :fecha_desde AND cr.fecha <= :fecha_hasta
            GROUP BY
                cr.fecha, cr.nro_caballo, cr.id_carrera
            ORDER BY
                cr.fecha DESC, cr.nro_caballo ASC
            LIMIT :limit OFFSET :offset
        
[01-Oct-2025 22:17:20 UTC] DEBUG - Parámetros: {":fecha_desde":"2025-05-01",":fecha_hasta":"2025-10-01",":limit":50,":offset":0}
[01-Oct-2025 22:17:20 UTC] DEBUG - Registros obtenidos: 16 de 16 totales
[01-Oct-2025 22:17:20 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[01-Oct-2025 22:17:20 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[01-Oct-2025 22:17:20 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[01-Oct-2025 22:17:20 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[01-Oct-2025 22:17:20 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[01-Oct-2025 22:17:20 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[01-Oct-2025 22:17:20 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[01-Oct-2025 22:17:20 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[01-Oct-2025 22:17:20 UTC] DEBUG formatearFecha - Input: '2025-07-15' (tipo: string)
[01-Oct-2025 22:17:20 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-15 -> 15/07/2025
[01-Oct-2025 22:17:20 UTC] DEBUG formatearFecha - Input: '2025-07-14' (tipo: string)
[01-Oct-2025 22:17:20 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-14 -> 14/07/2025
[01-Oct-2025 22:17:20 UTC] DEBUG formatearFecha - Input: '2025-07-11' (tipo: string)
[01-Oct-2025 22:17:20 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-11 -> 11/07/2025
[01-Oct-2025 22:17:20 UTC] DEBUG formatearFecha - Input: '2025-07-10' (tipo: string)
[01-Oct-2025 22:17:20 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-10 -> 10/07/2025
[01-Oct-2025 22:17:20 UTC] DEBUG formatearFecha - Input: '2025-07-08' (tipo: string)
[01-Oct-2025 22:17:20 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-08 -> 08/07/2025
[01-Oct-2025 22:17:20 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[01-Oct-2025 22:17:20 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[01-Oct-2025 22:17:20 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[01-Oct-2025 22:17:20 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[01-Oct-2025 22:17:20 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[01-Oct-2025 22:17:20 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[01-Oct-2025 22:17:20 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[01-Oct-2025 22:17:20 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[01-Oct-2025 22:17:20 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[01-Oct-2025 22:17:20 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[01-Oct-2025 22:17:20 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[01-Oct-2025 22:17:20 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[01-Oct-2025 22:17:20 UTC] DEBUG formatearFecha - Input: '2025-06-27' (tipo: string)
[01-Oct-2025 22:17:20 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-06-27 -> 27/06/2025
[01-Oct-2025 22:17:26 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:17:26 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:17:26 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:17:26 UTC] Acceso a reporte: usuario=1, reporte=informe-por-agencia, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:17:28 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:17:28 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:17:28 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:17:28 UTC] Acceso a reporte: usuario=1, reporte=informe-por-agencia, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:17:49 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:17:49 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:17:49 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:17:49 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:17:49 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:17:49 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:17:49 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:17:49 UTC] Acceso a reporte: usuario=1, reporte=informe-por-agencia, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:17:52 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:17:52 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:17:52 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:17:52 UTC] Acceso a reporte: usuario=1, reporte=informe-por-agencia, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:18:00 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:18:00 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:18:00 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:18:00 UTC] Acceso a reporte: usuario=1, reporte=informe-por-agencia, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:18:39 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:18:39 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:18:39 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:18:39 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:18:41 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:18:41 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:18:41 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:18:41 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:19:39 UTC] PHP Fatal error:  Uncaught Error: Call to undefined method TurfReports\Controllers\AuthController::verify() in /var/www/html/Routes/api.php:121
Stack trace:
#0 {main}
  thrown in /var/www/html/Routes/api.php on line 121
[01-Oct-2025 22:19:40 UTC] DEBUG Login - Usuario encontrado: SÍ
[01-Oct-2025 22:19:40 UTC] DEBUG Login - Login BD: carreras2024
[01-Oct-2025 22:19:40 UTC] DEBUG Login - Login enviado: carreras2024
[01-Oct-2025 22:19:40 UTC] DEBUG Login - Contraseña BD: 0192023a7bbd73250516f069df18b500
[01-Oct-2025 22:19:40 UTC] DEBUG Login - Contraseña enviada: admin123
[01-Oct-2025 22:19:40 UTC] DEBUG Login - Contraseña MD5: 0192023a7bbd73250516f069df18b500
[01-Oct-2025 22:19:40 UTC] DEBUG Login - Coinciden MD5: SÍ
[01-Oct-2025 22:19:40 UTC] DEBUG Login - id_perfil: 1 (tipo: integer)
[01-Oct-2025 22:19:40 UTC] DEBUG Login - Rol asignado: admin
[01-Oct-2025 22:19:40 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:19:40 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:19:40 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:19:41 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:19:41 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:19:41 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:19:41 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-09-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:19:42 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:19:42 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:19:42 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:19:42 UTC] Acceso a reporte: usuario=1, reporte=informe-por-agencia, filtros={"fecha_desde":"2025-09-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:19:44 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:19:44 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:19:44 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:19:44 UTC] Acceso a reporte: usuario=1, reporte=informe-por-agencia, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:19:47 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:19:47 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:19:47 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:19:47 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:19:48 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:19:48 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:19:48 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:19:48 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:19:50 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:19:50 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:19:50 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:19:50 UTC] DEBUG - Consulta SQL ejecutada: 
            SELECT 
                cr.fecha,
                cr.nro_caballo,
                COALESCE(SUM(dt.total_apostado), 0) as total_apostado,
                COALESCE(SUM(CASE WHEN crd.devolucion = 0 THEN dt.total_apostado ELSE 0 END), 0) as monto_a_devolver,
                COALESCE(SUM(CASE WHEN crd.devolucion = 1 THEN dt.total_apostado ELSE 0 END), 0) as monto_devuelto,
                CASE 
                    WHEN SUM(dt.total_apostado) IS NULL OR SUM(dt.total_apostado) = 0 THEN 'Sin Apuestas'
                    WHEN SUM(CASE WHEN crd.devolucion = 0 THEN 1 ELSE 0 END) > 0 
                         AND SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Parcial'
                    WHEN SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Devuelto'
                    ELSE 'Pendiente'
                END as estado_devolucion
            FROM 
                tbl_caballos_retirados_ultimo_momento cr
            LEFT JOIN 
                tbl_caballos_retirados_um_detalle crd ON cr.id_caballo_retirado_ultimo_momento = crd.id_caballo_retirado_ultimo_momento
            LEFT JOIN 
                tbl_detalle_tickets dt ON crd.id_detalle_ticket = dt.id_detalle_ticket
            WHERE 1=1
            AND cr.fecha >= :fecha_desde AND cr.fecha <= :fecha_hasta
            GROUP BY
                cr.fecha, cr.nro_caballo, cr.id_carrera
            ORDER BY
                cr.fecha DESC, cr.nro_caballo ASC
            LIMIT :limit OFFSET :offset
        
[01-Oct-2025 22:19:50 UTC] DEBUG - Parámetros: {":fecha_desde":"2025-05-01",":fecha_hasta":"2025-10-01",":limit":50,":offset":0}
[01-Oct-2025 22:19:50 UTC] DEBUG - Registros obtenidos: 16 de 16 totales
[01-Oct-2025 22:19:50 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[01-Oct-2025 22:19:50 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[01-Oct-2025 22:19:50 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[01-Oct-2025 22:19:50 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[01-Oct-2025 22:19:50 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[01-Oct-2025 22:19:50 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[01-Oct-2025 22:19:50 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[01-Oct-2025 22:19:50 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[01-Oct-2025 22:19:50 UTC] DEBUG formatearFecha - Input: '2025-07-15' (tipo: string)
[01-Oct-2025 22:19:50 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-15 -> 15/07/2025
[01-Oct-2025 22:19:50 UTC] DEBUG formatearFecha - Input: '2025-07-14' (tipo: string)
[01-Oct-2025 22:19:50 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-14 -> 14/07/2025
[01-Oct-2025 22:19:50 UTC] DEBUG formatearFecha - Input: '2025-07-11' (tipo: string)
[01-Oct-2025 22:19:50 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-11 -> 11/07/2025
[01-Oct-2025 22:19:50 UTC] DEBUG formatearFecha - Input: '2025-07-10' (tipo: string)
[01-Oct-2025 22:19:50 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-10 -> 10/07/2025
[01-Oct-2025 22:19:50 UTC] DEBUG formatearFecha - Input: '2025-07-08' (tipo: string)
[01-Oct-2025 22:19:50 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-08 -> 08/07/2025
[01-Oct-2025 22:19:50 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[01-Oct-2025 22:19:50 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[01-Oct-2025 22:19:50 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[01-Oct-2025 22:19:50 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[01-Oct-2025 22:19:50 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[01-Oct-2025 22:19:50 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[01-Oct-2025 22:19:50 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[01-Oct-2025 22:19:50 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[01-Oct-2025 22:19:50 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[01-Oct-2025 22:19:50 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[01-Oct-2025 22:19:50 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[01-Oct-2025 22:19:50 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[01-Oct-2025 22:19:50 UTC] DEBUG formatearFecha - Input: '2025-06-27' (tipo: string)
[01-Oct-2025 22:19:50 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-06-27 -> 27/06/2025
[01-Oct-2025 22:19:52 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:19:52 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:19:52 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:19:52 UTC] Acceso a reporte: usuario=1, reporte=informe-por-agencia, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:22:12 UTC] PHP Fatal error:  Uncaught Error: Call to undefined method TurfReports\Controllers\AuthController::verify() in /var/www/html/Routes/api.php:121
Stack trace:
#0 {main}
  thrown in /var/www/html/Routes/api.php on line 121
[01-Oct-2025 22:22:13 UTC] DEBUG Login - Usuario encontrado: SÍ
[01-Oct-2025 22:22:13 UTC] DEBUG Login - Login BD: carreras2024
[01-Oct-2025 22:22:13 UTC] DEBUG Login - Login enviado: carreras2024
[01-Oct-2025 22:22:13 UTC] DEBUG Login - Contraseña BD: 0192023a7bbd73250516f069df18b500
[01-Oct-2025 22:22:13 UTC] DEBUG Login - Contraseña enviada: admin123
[01-Oct-2025 22:22:13 UTC] DEBUG Login - Contraseña MD5: 0192023a7bbd73250516f069df18b500
[01-Oct-2025 22:22:13 UTC] DEBUG Login - Coinciden MD5: SÍ
[01-Oct-2025 22:22:13 UTC] DEBUG Login - id_perfil: 1 (tipo: integer)
[01-Oct-2025 22:22:13 UTC] DEBUG Login - Rol asignado: admin
[01-Oct-2025 22:22:13 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:22:13 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:22:13 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:22:14 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:22:14 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:22:14 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:22:14 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-09-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:22:14 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:22:14 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:22:14 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:22:14 UTC] Acceso a reporte: usuario=1, reporte=informe-por-agencia, filtros={"fecha_desde":"2025-09-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:22:16 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:22:16 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:22:16 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:22:16 UTC] Acceso a reporte: usuario=1, reporte=informe-por-agencia, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:22:17 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:22:17 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:22:17 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:22:17 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:22:18 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:22:18 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:22:18 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:22:18 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:22:19 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:22:19 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:22:19 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:22:19 UTC] DEBUG - Consulta SQL ejecutada: 
            SELECT 
                cr.fecha,
                cr.nro_caballo,
                COALESCE(SUM(dt.total_apostado), 0) as total_apostado,
                COALESCE(SUM(CASE WHEN crd.devolucion = 0 THEN dt.total_apostado ELSE 0 END), 0) as monto_a_devolver,
                COALESCE(SUM(CASE WHEN crd.devolucion = 1 THEN dt.total_apostado ELSE 0 END), 0) as monto_devuelto,
                CASE 
                    WHEN SUM(dt.total_apostado) IS NULL OR SUM(dt.total_apostado) = 0 THEN 'Sin Apuestas'
                    WHEN SUM(CASE WHEN crd.devolucion = 0 THEN 1 ELSE 0 END) > 0 
                         AND SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Parcial'
                    WHEN SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Devuelto'
                    ELSE 'Pendiente'
                END as estado_devolucion
            FROM 
                tbl_caballos_retirados_ultimo_momento cr
            LEFT JOIN 
                tbl_caballos_retirados_um_detalle crd ON cr.id_caballo_retirado_ultimo_momento = crd.id_caballo_retirado_ultimo_momento
            LEFT JOIN 
                tbl_detalle_tickets dt ON crd.id_detalle_ticket = dt.id_detalle_ticket
            WHERE 1=1
            AND cr.fecha >= :fecha_desde AND cr.fecha <= :fecha_hasta
            GROUP BY
                cr.fecha, cr.nro_caballo, cr.id_carrera
            ORDER BY
                cr.fecha DESC, cr.nro_caballo ASC
            LIMIT :limit OFFSET :offset
        
[01-Oct-2025 22:22:19 UTC] DEBUG - Parámetros: {":fecha_desde":"2025-05-01",":fecha_hasta":"2025-10-01",":limit":50,":offset":0}
[01-Oct-2025 22:22:19 UTC] DEBUG - Registros obtenidos: 16 de 16 totales
[01-Oct-2025 22:22:19 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[01-Oct-2025 22:22:19 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[01-Oct-2025 22:22:19 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[01-Oct-2025 22:22:19 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[01-Oct-2025 22:22:19 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[01-Oct-2025 22:22:19 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[01-Oct-2025 22:22:19 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[01-Oct-2025 22:22:19 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[01-Oct-2025 22:22:19 UTC] DEBUG formatearFecha - Input: '2025-07-15' (tipo: string)
[01-Oct-2025 22:22:19 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-15 -> 15/07/2025
[01-Oct-2025 22:22:19 UTC] DEBUG formatearFecha - Input: '2025-07-14' (tipo: string)
[01-Oct-2025 22:22:19 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-14 -> 14/07/2025
[01-Oct-2025 22:22:19 UTC] DEBUG formatearFecha - Input: '2025-07-11' (tipo: string)
[01-Oct-2025 22:22:19 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-11 -> 11/07/2025
[01-Oct-2025 22:22:19 UTC] DEBUG formatearFecha - Input: '2025-07-10' (tipo: string)
[01-Oct-2025 22:22:19 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-10 -> 10/07/2025
[01-Oct-2025 22:22:19 UTC] DEBUG formatearFecha - Input: '2025-07-08' (tipo: string)
[01-Oct-2025 22:22:19 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-08 -> 08/07/2025
[01-Oct-2025 22:22:19 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[01-Oct-2025 22:22:19 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[01-Oct-2025 22:22:19 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[01-Oct-2025 22:22:19 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[01-Oct-2025 22:22:19 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[01-Oct-2025 22:22:19 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[01-Oct-2025 22:22:19 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[01-Oct-2025 22:22:19 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[01-Oct-2025 22:22:19 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[01-Oct-2025 22:22:19 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[01-Oct-2025 22:22:19 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[01-Oct-2025 22:22:19 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[01-Oct-2025 22:22:19 UTC] DEBUG formatearFecha - Input: '2025-06-27' (tipo: string)
[01-Oct-2025 22:22:19 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-06-27 -> 27/06/2025
[01-Oct-2025 22:22:20 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:22:20 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:22:20 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:22:20 UTC] DEBUG - Consulta SQL ejecutada: 
            SELECT 
                cr.fecha,
                cr.nro_caballo,
                COALESCE(SUM(dt.total_apostado), 0) as total_apostado,
                COALESCE(SUM(CASE WHEN crd.devolucion = 0 THEN dt.total_apostado ELSE 0 END), 0) as monto_a_devolver,
                COALESCE(SUM(CASE WHEN crd.devolucion = 1 THEN dt.total_apostado ELSE 0 END), 0) as monto_devuelto,
                CASE 
                    WHEN SUM(dt.total_apostado) IS NULL OR SUM(dt.total_apostado) = 0 THEN 'Sin Apuestas'
                    WHEN SUM(CASE WHEN crd.devolucion = 0 THEN 1 ELSE 0 END) > 0 
                         AND SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Parcial'
                    WHEN SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Devuelto'
                    ELSE 'Pendiente'
                END as estado_devolucion
            FROM 
                tbl_caballos_retirados_ultimo_momento cr
            LEFT JOIN 
                tbl_caballos_retirados_um_detalle crd ON cr.id_caballo_retirado_ultimo_momento = crd.id_caballo_retirado_ultimo_momento
            LEFT JOIN 
                tbl_detalle_tickets dt ON crd.id_detalle_ticket = dt.id_detalle_ticket
            WHERE 1=1
            AND cr.fecha >= :fecha_desde AND cr.fecha <= :fecha_hasta
            GROUP BY
                cr.fecha, cr.nro_caballo, cr.id_carrera
            ORDER BY
                cr.fecha DESC, cr.nro_caballo ASC
            LIMIT :limit OFFSET :offset
        
[01-Oct-2025 22:22:20 UTC] DEBUG - Parámetros: {":fecha_desde":"2025-05-01",":fecha_hasta":"2025-10-01",":limit":50,":offset":0}
[01-Oct-2025 22:22:20 UTC] DEBUG - Registros obtenidos: 16 de 16 totales
[01-Oct-2025 22:22:20 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[01-Oct-2025 22:22:20 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[01-Oct-2025 22:22:20 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[01-Oct-2025 22:22:20 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[01-Oct-2025 22:22:20 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[01-Oct-2025 22:22:20 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[01-Oct-2025 22:22:20 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[01-Oct-2025 22:22:20 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[01-Oct-2025 22:22:20 UTC] DEBUG formatearFecha - Input: '2025-07-15' (tipo: string)
[01-Oct-2025 22:22:20 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-15 -> 15/07/2025
[01-Oct-2025 22:22:20 UTC] DEBUG formatearFecha - Input: '2025-07-14' (tipo: string)
[01-Oct-2025 22:22:20 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-14 -> 14/07/2025
[01-Oct-2025 22:22:20 UTC] DEBUG formatearFecha - Input: '2025-07-11' (tipo: string)
[01-Oct-2025 22:22:20 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-11 -> 11/07/2025
[01-Oct-2025 22:22:20 UTC] DEBUG formatearFecha - Input: '2025-07-10' (tipo: string)
[01-Oct-2025 22:22:20 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-10 -> 10/07/2025
[01-Oct-2025 22:22:20 UTC] DEBUG formatearFecha - Input: '2025-07-08' (tipo: string)
[01-Oct-2025 22:22:20 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-08 -> 08/07/2025
[01-Oct-2025 22:22:20 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[01-Oct-2025 22:22:20 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[01-Oct-2025 22:22:20 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[01-Oct-2025 22:22:20 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[01-Oct-2025 22:22:20 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[01-Oct-2025 22:22:20 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[01-Oct-2025 22:22:20 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[01-Oct-2025 22:22:20 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[01-Oct-2025 22:22:20 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[01-Oct-2025 22:22:20 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[01-Oct-2025 22:22:20 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[01-Oct-2025 22:22:20 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[01-Oct-2025 22:22:20 UTC] DEBUG formatearFecha - Input: '2025-06-27' (tipo: string)
[01-Oct-2025 22:22:20 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-06-27 -> 27/06/2025
[01-Oct-2025 22:22:21 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:22:21 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:22:21 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:22:21 UTC] DEBUG Carreras - Filtros recibidos: {"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:22:21 UTC] DEBUG Carreras - WHERE SQL: WHERE STR_TO_DATE(c.fecha, '%d/%m/%Y') >= STR_TO_DATE(:fecha_desde, '%Y-%m-%d') AND STR_TO_DATE(c.fecha, '%d/%m/%Y') <= STR_TO_DATE(:fecha_hasta, '%Y-%m-%d')
[01-Oct-2025 22:22:21 UTC] DEBUG Carreras - Parámetros: {":fecha_desde":"2025-05-01",":fecha_hasta":"2025-10-01"}
[01-Oct-2025 22:22:21 UTC] DEBUG Carreras - Registros obtenidos: 50
[01-Oct-2025 22:22:21 UTC] DEBUG Carreras - Primer registro: {"numero_carrera":1,"fecha":"31\/07\/2025","nombre_hipodromo":"San Isidro","estado_carrera":"Apuesta","carrera_interna_id":52}
[01-Oct-2025 22:22:22 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:22:22 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:22:22 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:22:22 UTC] DEBUG Carreras - Filtros recibidos: {"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:22:22 UTC] DEBUG Carreras - WHERE SQL: WHERE STR_TO_DATE(c.fecha, '%d/%m/%Y') >= STR_TO_DATE(:fecha_desde, '%Y-%m-%d') AND STR_TO_DATE(c.fecha, '%d/%m/%Y') <= STR_TO_DATE(:fecha_hasta, '%Y-%m-%d')
[01-Oct-2025 22:22:22 UTC] DEBUG Carreras - Parámetros: {":fecha_desde":"2025-05-01",":fecha_hasta":"2025-10-01"}
[01-Oct-2025 22:22:22 UTC] DEBUG Carreras - Registros obtenidos: 50
[01-Oct-2025 22:22:22 UTC] DEBUG Carreras - Primer registro: {"numero_carrera":1,"fecha":"31\/07\/2025","nombre_hipodromo":"San Isidro","estado_carrera":"Apuesta","carrera_interna_id":52}
[01-Oct-2025 22:22:23 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:22:23 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:22:23 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:22:23 UTC] DEBUG Tickets Anulados - Filtros recibidos: {"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:22:23 UTC] DEBUG Tickets Anulados - WHERE construido: AND STR_TO_DATE(t.fecha, '%d/%m/%Y') >= STR_TO_DATE(:fecha_desde, '%Y-%m-%d') AND STR_TO_DATE(t.fecha, '%d/%m/%Y') <= STR_TO_DATE(:fecha_hasta, '%Y-%m-%d')
[01-Oct-2025 22:22:23 UTC] DEBUG Tickets Anulados - Registros obtenidos: 12
[01-Oct-2025 22:22:23 UTC] DEBUG Tickets Anulados - Primer registro: {"nro_ticket":133,"fecha":"31\/07\/2025","hora":"10:01:20","nombre_usuario":"Agencia 24","nombre_agencia":"Morteros","total_apostado":10000}
[01-Oct-2025 22:22:23 UTC] DEBUG formatearFecha - Input: '31/07/2025' (tipo: string)
[01-Oct-2025 22:22:23 UTC] DEBUG formatearFecha - Ya en formato correcto: 31/07/2025
[01-Oct-2025 22:22:23 UTC] DEBUG formatearFecha - Input: '06/07/2025' (tipo: string)
[01-Oct-2025 22:22:23 UTC] DEBUG formatearFecha - Ya en formato correcto: 06/07/2025
[01-Oct-2025 22:22:23 UTC] DEBUG formatearFecha - Input: '05/07/2025' (tipo: string)
[01-Oct-2025 22:22:23 UTC] DEBUG formatearFecha - Ya en formato correcto: 05/07/2025
[01-Oct-2025 22:22:23 UTC] DEBUG formatearFecha - Input: '04/07/2025' (tipo: string)
[01-Oct-2025 22:22:23 UTC] DEBUG formatearFecha - Ya en formato correcto: 04/07/2025
[01-Oct-2025 22:22:23 UTC] DEBUG formatearFecha - Input: '02/07/2025' (tipo: string)
[01-Oct-2025 22:22:23 UTC] DEBUG formatearFecha - Ya en formato correcto: 02/07/2025
[01-Oct-2025 22:22:23 UTC] DEBUG formatearFecha - Input: '02/07/2025' (tipo: string)
[01-Oct-2025 22:22:23 UTC] DEBUG formatearFecha - Ya en formato correcto: 02/07/2025
[01-Oct-2025 22:22:23 UTC] DEBUG formatearFecha - Input: '02/07/2025' (tipo: string)
[01-Oct-2025 22:22:23 UTC] DEBUG formatearFecha - Ya en formato correcto: 02/07/2025
[01-Oct-2025 22:22:23 UTC] DEBUG formatearFecha - Input: '02/07/2025' (tipo: string)
[01-Oct-2025 22:22:23 UTC] DEBUG formatearFecha - Ya en formato correcto: 02/07/2025
[01-Oct-2025 22:22:23 UTC] DEBUG formatearFecha - Input: '01/07/2025' (tipo: string)
[01-Oct-2025 22:22:23 UTC] DEBUG formatearFecha - Ya en formato correcto: 01/07/2025
[01-Oct-2025 22:22:23 UTC] DEBUG formatearFecha - Input: '01/07/2025' (tipo: string)
[01-Oct-2025 22:22:23 UTC] DEBUG formatearFecha - Ya en formato correcto: 01/07/2025
[01-Oct-2025 22:22:23 UTC] DEBUG formatearFecha - Input: '01/07/2025' (tipo: string)
[01-Oct-2025 22:22:23 UTC] DEBUG formatearFecha - Ya en formato correcto: 01/07/2025
[01-Oct-2025 22:22:23 UTC] DEBUG formatearFecha - Input: '30/06/2025' (tipo: string)
[01-Oct-2025 22:22:23 UTC] DEBUG formatearFecha - Ya en formato correcto: 30/06/2025
[01-Oct-2025 22:22:24 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:22:24 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:22:24 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:22:24 UTC] DEBUG Tickets Anulados - Filtros recibidos: {"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:22:24 UTC] DEBUG Tickets Anulados - WHERE construido: AND STR_TO_DATE(t.fecha, '%d/%m/%Y') >= STR_TO_DATE(:fecha_desde, '%Y-%m-%d') AND STR_TO_DATE(t.fecha, '%d/%m/%Y') <= STR_TO_DATE(:fecha_hasta, '%Y-%m-%d')
[01-Oct-2025 22:22:24 UTC] DEBUG Tickets Anulados - Registros obtenidos: 12
[01-Oct-2025 22:22:24 UTC] DEBUG Tickets Anulados - Primer registro: {"nro_ticket":133,"fecha":"31\/07\/2025","hora":"10:01:20","nombre_usuario":"Agencia 24","nombre_agencia":"Morteros","total_apostado":10000}
[01-Oct-2025 22:22:24 UTC] DEBUG formatearFecha - Input: '31/07/2025' (tipo: string)
[01-Oct-2025 22:22:24 UTC] DEBUG formatearFecha - Ya en formato correcto: 31/07/2025
[01-Oct-2025 22:22:24 UTC] DEBUG formatearFecha - Input: '06/07/2025' (tipo: string)
[01-Oct-2025 22:22:24 UTC] DEBUG formatearFecha - Ya en formato correcto: 06/07/2025
[01-Oct-2025 22:22:24 UTC] DEBUG formatearFecha - Input: '05/07/2025' (tipo: string)
[01-Oct-2025 22:22:24 UTC] DEBUG formatearFecha - Ya en formato correcto: 05/07/2025
[01-Oct-2025 22:22:24 UTC] DEBUG formatearFecha - Input: '04/07/2025' (tipo: string)
[01-Oct-2025 22:22:24 UTC] DEBUG formatearFecha - Ya en formato correcto: 04/07/2025
[01-Oct-2025 22:22:24 UTC] DEBUG formatearFecha - Input: '02/07/2025' (tipo: string)
[01-Oct-2025 22:22:24 UTC] DEBUG formatearFecha - Ya en formato correcto: 02/07/2025
[01-Oct-2025 22:22:24 UTC] DEBUG formatearFecha - Input: '02/07/2025' (tipo: string)
[01-Oct-2025 22:22:24 UTC] DEBUG formatearFecha - Ya en formato correcto: 02/07/2025
[01-Oct-2025 22:22:24 UTC] DEBUG formatearFecha - Input: '02/07/2025' (tipo: string)
[01-Oct-2025 22:22:24 UTC] DEBUG formatearFecha - Ya en formato correcto: 02/07/2025
[01-Oct-2025 22:22:24 UTC] DEBUG formatearFecha - Input: '02/07/2025' (tipo: string)
[01-Oct-2025 22:22:24 UTC] DEBUG formatearFecha - Ya en formato correcto: 02/07/2025
[01-Oct-2025 22:22:24 UTC] DEBUG formatearFecha - Input: '01/07/2025' (tipo: string)
[01-Oct-2025 22:22:24 UTC] DEBUG formatearFecha - Ya en formato correcto: 01/07/2025
[01-Oct-2025 22:22:24 UTC] DEBUG formatearFecha - Input: '01/07/2025' (tipo: string)
[01-Oct-2025 22:22:24 UTC] DEBUG formatearFecha - Ya en formato correcto: 01/07/2025
[01-Oct-2025 22:22:24 UTC] DEBUG formatearFecha - Input: '01/07/2025' (tipo: string)
[01-Oct-2025 22:22:24 UTC] DEBUG formatearFecha - Ya en formato correcto: 01/07/2025
[01-Oct-2025 22:22:24 UTC] DEBUG formatearFecha - Input: '30/06/2025' (tipo: string)
[01-Oct-2025 22:22:24 UTC] DEBUG formatearFecha - Ya en formato correcto: 30/06/2025
[01-Oct-2025 22:25:26 UTC] PHP Fatal error:  Uncaught Error: Call to undefined method TurfReports\Controllers\AuthController::verify() in /var/www/html/Routes/api.php:121
Stack trace:
#0 {main}
  thrown in /var/www/html/Routes/api.php on line 121
[01-Oct-2025 22:25:27 UTC] DEBUG Login - Usuario encontrado: SÍ
[01-Oct-2025 22:25:27 UTC] DEBUG Login - Login BD: carreras2024
[01-Oct-2025 22:25:27 UTC] DEBUG Login - Login enviado: carreras2024
[01-Oct-2025 22:25:27 UTC] DEBUG Login - Contraseña BD: 0192023a7bbd73250516f069df18b500
[01-Oct-2025 22:25:27 UTC] DEBUG Login - Contraseña enviada: admin123
[01-Oct-2025 22:25:27 UTC] DEBUG Login - Contraseña MD5: 0192023a7bbd73250516f069df18b500
[01-Oct-2025 22:25:27 UTC] DEBUG Login - Coinciden MD5: SÍ
[01-Oct-2025 22:25:27 UTC] DEBUG Login - id_perfil: 1 (tipo: integer)
[01-Oct-2025 22:25:27 UTC] DEBUG Login - Rol asignado: admin
[01-Oct-2025 22:25:27 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:25:27 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:25:27 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:25:33 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:25:33 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:25:33 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:25:33 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:25:34 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:25:34 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:25:34 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:25:34 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:25:34 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:25:34 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:25:34 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:25:34 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:25:36 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:25:36 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:25:36 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:25:36 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","agencia_id":3,"limit":50,"offset":0}
[01-Oct-2025 22:25:37 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:25:37 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:25:37 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:25:37 UTC] DEBUG - Consulta SQL ejecutada: 
            SELECT 
                cr.fecha,
                cr.nro_caballo,
                COALESCE(SUM(dt.total_apostado), 0) as total_apostado,
                COALESCE(SUM(CASE WHEN crd.devolucion = 0 THEN dt.total_apostado ELSE 0 END), 0) as monto_a_devolver,
                COALESCE(SUM(CASE WHEN crd.devolucion = 1 THEN dt.total_apostado ELSE 0 END), 0) as monto_devuelto,
                CASE 
                    WHEN SUM(dt.total_apostado) IS NULL OR SUM(dt.total_apostado) = 0 THEN 'Sin Apuestas'
                    WHEN SUM(CASE WHEN crd.devolucion = 0 THEN 1 ELSE 0 END) > 0 
                         AND SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Parcial'
                    WHEN SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Devuelto'
                    ELSE 'Pendiente'
                END as estado_devolucion
            FROM 
                tbl_caballos_retirados_ultimo_momento cr
            LEFT JOIN 
                tbl_caballos_retirados_um_detalle crd ON cr.id_caballo_retirado_ultimo_momento = crd.id_caballo_retirado_ultimo_momento
            LEFT JOIN 
                tbl_detalle_tickets dt ON crd.id_detalle_ticket = dt.id_detalle_ticket
            WHERE 1=1
            AND cr.fecha >= :fecha_desde AND cr.fecha <= :fecha_hasta
            GROUP BY
                cr.fecha, cr.nro_caballo, cr.id_carrera
            ORDER BY
                cr.fecha DESC, cr.nro_caballo ASC
            LIMIT :limit OFFSET :offset
        
[01-Oct-2025 22:25:37 UTC] DEBUG - Parámetros: {":fecha_desde":"2025-05-01",":fecha_hasta":"2025-10-01",":limit":50,":offset":0}
[01-Oct-2025 22:25:37 UTC] DEBUG - Registros obtenidos: 16 de 16 totales
[01-Oct-2025 22:25:37 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[01-Oct-2025 22:25:37 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[01-Oct-2025 22:25:37 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[01-Oct-2025 22:25:37 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[01-Oct-2025 22:25:37 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[01-Oct-2025 22:25:37 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[01-Oct-2025 22:25:37 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[01-Oct-2025 22:25:37 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[01-Oct-2025 22:25:37 UTC] DEBUG formatearFecha - Input: '2025-07-15' (tipo: string)
[01-Oct-2025 22:25:37 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-15 -> 15/07/2025
[01-Oct-2025 22:25:37 UTC] DEBUG formatearFecha - Input: '2025-07-14' (tipo: string)
[01-Oct-2025 22:25:37 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-14 -> 14/07/2025
[01-Oct-2025 22:25:37 UTC] DEBUG formatearFecha - Input: '2025-07-11' (tipo: string)
[01-Oct-2025 22:25:37 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-11 -> 11/07/2025
[01-Oct-2025 22:25:37 UTC] DEBUG formatearFecha - Input: '2025-07-10' (tipo: string)
[01-Oct-2025 22:25:37 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-10 -> 10/07/2025
[01-Oct-2025 22:25:37 UTC] DEBUG formatearFecha - Input: '2025-07-08' (tipo: string)
[01-Oct-2025 22:25:37 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-08 -> 08/07/2025
[01-Oct-2025 22:25:37 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[01-Oct-2025 22:25:37 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[01-Oct-2025 22:25:37 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[01-Oct-2025 22:25:37 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[01-Oct-2025 22:25:37 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[01-Oct-2025 22:25:37 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[01-Oct-2025 22:25:37 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[01-Oct-2025 22:25:37 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[01-Oct-2025 22:25:37 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[01-Oct-2025 22:25:37 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[01-Oct-2025 22:25:37 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[01-Oct-2025 22:25:37 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[01-Oct-2025 22:25:37 UTC] DEBUG formatearFecha - Input: '2025-06-27' (tipo: string)
[01-Oct-2025 22:25:37 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-06-27 -> 27/06/2025
[01-Oct-2025 22:25:38 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:25:38 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:25:38 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:25:38 UTC] DEBUG - Consulta SQL ejecutada: 
            SELECT 
                cr.fecha,
                cr.nro_caballo,
                COALESCE(SUM(dt.total_apostado), 0) as total_apostado,
                COALESCE(SUM(CASE WHEN crd.devolucion = 0 THEN dt.total_apostado ELSE 0 END), 0) as monto_a_devolver,
                COALESCE(SUM(CASE WHEN crd.devolucion = 1 THEN dt.total_apostado ELSE 0 END), 0) as monto_devuelto,
                CASE 
                    WHEN SUM(dt.total_apostado) IS NULL OR SUM(dt.total_apostado) = 0 THEN 'Sin Apuestas'
                    WHEN SUM(CASE WHEN crd.devolucion = 0 THEN 1 ELSE 0 END) > 0 
                         AND SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Parcial'
                    WHEN SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Devuelto'
                    ELSE 'Pendiente'
                END as estado_devolucion
            FROM 
                tbl_caballos_retirados_ultimo_momento cr
            LEFT JOIN 
                tbl_caballos_retirados_um_detalle crd ON cr.id_caballo_retirado_ultimo_momento = crd.id_caballo_retirado_ultimo_momento
            LEFT JOIN 
                tbl_detalle_tickets dt ON crd.id_detalle_ticket = dt.id_detalle_ticket
            WHERE 1=1
            AND cr.fecha >= :fecha_desde AND cr.fecha <= :fecha_hasta
            GROUP BY
                cr.fecha, cr.nro_caballo, cr.id_carrera
            ORDER BY
                cr.fecha DESC, cr.nro_caballo ASC
            LIMIT :limit OFFSET :offset
        
[01-Oct-2025 22:25:38 UTC] DEBUG - Parámetros: {":fecha_desde":"2025-05-01",":fecha_hasta":"2025-10-01",":limit":50,":offset":0}
[01-Oct-2025 22:25:38 UTC] DEBUG - Registros obtenidos: 16 de 16 totales
[01-Oct-2025 22:25:38 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[01-Oct-2025 22:25:38 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[01-Oct-2025 22:25:38 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[01-Oct-2025 22:25:38 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[01-Oct-2025 22:25:38 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[01-Oct-2025 22:25:38 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[01-Oct-2025 22:25:38 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[01-Oct-2025 22:25:38 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[01-Oct-2025 22:25:38 UTC] DEBUG formatearFecha - Input: '2025-07-15' (tipo: string)
[01-Oct-2025 22:25:38 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-15 -> 15/07/2025
[01-Oct-2025 22:25:38 UTC] DEBUG formatearFecha - Input: '2025-07-14' (tipo: string)
[01-Oct-2025 22:25:38 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-14 -> 14/07/2025
[01-Oct-2025 22:25:38 UTC] DEBUG formatearFecha - Input: '2025-07-11' (tipo: string)
[01-Oct-2025 22:25:38 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-11 -> 11/07/2025
[01-Oct-2025 22:25:38 UTC] DEBUG formatearFecha - Input: '2025-07-10' (tipo: string)
[01-Oct-2025 22:25:38 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-10 -> 10/07/2025
[01-Oct-2025 22:25:38 UTC] DEBUG formatearFecha - Input: '2025-07-08' (tipo: string)
[01-Oct-2025 22:25:38 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-08 -> 08/07/2025
[01-Oct-2025 22:25:38 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[01-Oct-2025 22:25:38 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[01-Oct-2025 22:25:38 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[01-Oct-2025 22:25:38 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[01-Oct-2025 22:25:38 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[01-Oct-2025 22:25:38 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[01-Oct-2025 22:25:38 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[01-Oct-2025 22:25:38 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[01-Oct-2025 22:25:38 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[01-Oct-2025 22:25:38 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[01-Oct-2025 22:25:38 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[01-Oct-2025 22:25:38 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[01-Oct-2025 22:25:38 UTC] DEBUG formatearFecha - Input: '2025-06-27' (tipo: string)
[01-Oct-2025 22:25:38 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-06-27 -> 27/06/2025
[01-Oct-2025 22:25:39 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:25:39 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:25:39 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:25:39 UTC] Acceso a reporte: usuario=1, reporte=informe-por-agencia, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","agencia_id":3,"limit":50,"offset":0}
[01-Oct-2025 22:25:40 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:25:40 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:25:40 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:25:40 UTC] Acceso a reporte: usuario=1, reporte=informe-por-agencia, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","agencia_id":3,"limit":50,"offset":0}
[01-Oct-2025 22:27:12 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:27:12 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:27:12 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:27:12 UTC] Acceso a reporte: usuario=1, reporte=informe-por-agencia, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","agencia_id":3,"limit":50,"offset":0}
[01-Oct-2025 22:37:05 UTC] PHP Fatal error:  Uncaught Error: Call to undefined method TurfReports\Controllers\AuthController::verify() in /var/www/html/Routes/api.php:121
Stack trace:
#0 {main}
  thrown in /var/www/html/Routes/api.php on line 121
[01-Oct-2025 22:37:06 UTC] DEBUG Login - Usuario encontrado: SÍ
[01-Oct-2025 22:37:06 UTC] DEBUG Login - Login BD: carreras2024
[01-Oct-2025 22:37:06 UTC] DEBUG Login - Login enviado: carreras2024
[01-Oct-2025 22:37:06 UTC] DEBUG Login - Contraseña BD: 0192023a7bbd73250516f069df18b500
[01-Oct-2025 22:37:06 UTC] DEBUG Login - Contraseña enviada: admin123
[01-Oct-2025 22:37:06 UTC] DEBUG Login - Contraseña MD5: 0192023a7bbd73250516f069df18b500
[01-Oct-2025 22:37:06 UTC] DEBUG Login - Coinciden MD5: SÍ
[01-Oct-2025 22:37:06 UTC] DEBUG Login - id_perfil: 1 (tipo: integer)
[01-Oct-2025 22:37:06 UTC] DEBUG Login - Rol asignado: admin
[01-Oct-2025 22:37:06 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:37:06 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:37:06 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:37:07 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:37:07 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:37:07 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:37:07 UTC] DEBUG Carreras - Filtros recibidos: {"fecha_desde":"2025-09-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:37:07 UTC] DEBUG Carreras - WHERE SQL: WHERE STR_TO_DATE(c.fecha, '%d/%m/%Y') >= STR_TO_DATE(:fecha_desde, '%Y-%m-%d') AND STR_TO_DATE(c.fecha, '%d/%m/%Y') <= STR_TO_DATE(:fecha_hasta, '%Y-%m-%d')
[01-Oct-2025 22:37:07 UTC] DEBUG Carreras - Parámetros: {":fecha_desde":"2025-09-01",":fecha_hasta":"2025-10-01"}
[01-Oct-2025 22:37:07 UTC] DEBUG Carreras - Registros obtenidos: 0
[01-Oct-2025 22:37:09 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:37:09 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:37:09 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:37:09 UTC] DEBUG Carreras - Filtros recibidos: {"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:37:09 UTC] DEBUG Carreras - WHERE SQL: WHERE STR_TO_DATE(c.fecha, '%d/%m/%Y') >= STR_TO_DATE(:fecha_desde, '%Y-%m-%d') AND STR_TO_DATE(c.fecha, '%d/%m/%Y') <= STR_TO_DATE(:fecha_hasta, '%Y-%m-%d')
[01-Oct-2025 22:37:09 UTC] DEBUG Carreras - Parámetros: {":fecha_desde":"2025-05-01",":fecha_hasta":"2025-10-01"}
[01-Oct-2025 22:37:10 UTC] DEBUG Carreras - Registros obtenidos: 50
[01-Oct-2025 22:37:10 UTC] DEBUG Carreras - Primer registro: {"numero_carrera":1,"fecha":"31\/07\/2025","nombre_hipodromo":"San Isidro","estado_carrera":"Apuesta","carrera_interna_id":52}
[01-Oct-2025 22:37:11 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:37:11 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:37:11 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:37:11 UTC] DEBUG Tickets Anulados - Filtros recibidos: {"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:37:11 UTC] DEBUG Tickets Anulados - WHERE construido: AND STR_TO_DATE(t.fecha, '%d/%m/%Y') >= STR_TO_DATE(:fecha_desde, '%Y-%m-%d') AND STR_TO_DATE(t.fecha, '%d/%m/%Y') <= STR_TO_DATE(:fecha_hasta, '%Y-%m-%d')
[01-Oct-2025 22:37:11 UTC] DEBUG Tickets Anulados - Registros obtenidos: 12
[01-Oct-2025 22:37:11 UTC] DEBUG Tickets Anulados - Primer registro: {"nro_ticket":133,"fecha":"31\/07\/2025","hora":"10:01:20","nombre_usuario":"Agencia 24","nombre_agencia":"Morteros","total_apostado":10000}
[01-Oct-2025 22:37:11 UTC] DEBUG formatearFecha - Input: '31/07/2025' (tipo: string)
[01-Oct-2025 22:37:11 UTC] DEBUG formatearFecha - Ya en formato correcto: 31/07/2025
[01-Oct-2025 22:37:11 UTC] DEBUG formatearFecha - Input: '06/07/2025' (tipo: string)
[01-Oct-2025 22:37:11 UTC] DEBUG formatearFecha - Ya en formato correcto: 06/07/2025
[01-Oct-2025 22:37:11 UTC] DEBUG formatearFecha - Input: '05/07/2025' (tipo: string)
[01-Oct-2025 22:37:11 UTC] DEBUG formatearFecha - Ya en formato correcto: 05/07/2025
[01-Oct-2025 22:37:11 UTC] DEBUG formatearFecha - Input: '04/07/2025' (tipo: string)
[01-Oct-2025 22:37:11 UTC] DEBUG formatearFecha - Ya en formato correcto: 04/07/2025
[01-Oct-2025 22:37:11 UTC] DEBUG formatearFecha - Input: '02/07/2025' (tipo: string)
[01-Oct-2025 22:37:11 UTC] DEBUG formatearFecha - Ya en formato correcto: 02/07/2025
[01-Oct-2025 22:37:11 UTC] DEBUG formatearFecha - Input: '02/07/2025' (tipo: string)
[01-Oct-2025 22:37:11 UTC] DEBUG formatearFecha - Ya en formato correcto: 02/07/2025
[01-Oct-2025 22:37:11 UTC] DEBUG formatearFecha - Input: '02/07/2025' (tipo: string)
[01-Oct-2025 22:37:11 UTC] DEBUG formatearFecha - Ya en formato correcto: 02/07/2025
[01-Oct-2025 22:37:11 UTC] DEBUG formatearFecha - Input: '02/07/2025' (tipo: string)
[01-Oct-2025 22:37:11 UTC] DEBUG formatearFecha - Ya en formato correcto: 02/07/2025
[01-Oct-2025 22:37:11 UTC] DEBUG formatearFecha - Input: '01/07/2025' (tipo: string)
[01-Oct-2025 22:37:11 UTC] DEBUG formatearFecha - Ya en formato correcto: 01/07/2025
[01-Oct-2025 22:37:11 UTC] DEBUG formatearFecha - Input: '01/07/2025' (tipo: string)
[01-Oct-2025 22:37:11 UTC] DEBUG formatearFecha - Ya en formato correcto: 01/07/2025
[01-Oct-2025 22:37:11 UTC] DEBUG formatearFecha - Input: '01/07/2025' (tipo: string)
[01-Oct-2025 22:37:11 UTC] DEBUG formatearFecha - Ya en formato correcto: 01/07/2025
[01-Oct-2025 22:37:11 UTC] DEBUG formatearFecha - Input: '30/06/2025' (tipo: string)
[01-Oct-2025 22:37:11 UTC] DEBUG formatearFecha - Ya en formato correcto: 30/06/2025
[01-Oct-2025 22:37:12 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:37:12 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:37:12 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:37:12 UTC] DEBUG - Consulta SQL ejecutada: 
            SELECT 
                cr.fecha,
                cr.nro_caballo,
                COALESCE(SUM(dt.total_apostado), 0) as total_apostado,
                COALESCE(SUM(CASE WHEN crd.devolucion = 0 THEN dt.total_apostado ELSE 0 END), 0) as monto_a_devolver,
                COALESCE(SUM(CASE WHEN crd.devolucion = 1 THEN dt.total_apostado ELSE 0 END), 0) as monto_devuelto,
                CASE 
                    WHEN SUM(dt.total_apostado) IS NULL OR SUM(dt.total_apostado) = 0 THEN 'Sin Apuestas'
                    WHEN SUM(CASE WHEN crd.devolucion = 0 THEN 1 ELSE 0 END) > 0 
                         AND SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Parcial'
                    WHEN SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Devuelto'
                    ELSE 'Pendiente'
                END as estado_devolucion
            FROM 
                tbl_caballos_retirados_ultimo_momento cr
            LEFT JOIN 
                tbl_caballos_retirados_um_detalle crd ON cr.id_caballo_retirado_ultimo_momento = crd.id_caballo_retirado_ultimo_momento
            LEFT JOIN 
                tbl_detalle_tickets dt ON crd.id_detalle_ticket = dt.id_detalle_ticket
            WHERE 1=1
            AND cr.fecha >= :fecha_desde AND cr.fecha <= :fecha_hasta
            GROUP BY
                cr.fecha, cr.nro_caballo, cr.id_carrera
            ORDER BY
                cr.fecha DESC, cr.nro_caballo ASC
            LIMIT :limit OFFSET :offset
        
[01-Oct-2025 22:37:12 UTC] DEBUG - Parámetros: {":fecha_desde":"2025-05-01",":fecha_hasta":"2025-10-01",":limit":50,":offset":0}
[01-Oct-2025 22:37:12 UTC] DEBUG - Registros obtenidos: 16 de 16 totales
[01-Oct-2025 22:37:12 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[01-Oct-2025 22:37:12 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[01-Oct-2025 22:37:12 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[01-Oct-2025 22:37:12 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[01-Oct-2025 22:37:12 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[01-Oct-2025 22:37:12 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[01-Oct-2025 22:37:12 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[01-Oct-2025 22:37:12 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[01-Oct-2025 22:37:12 UTC] DEBUG formatearFecha - Input: '2025-07-15' (tipo: string)
[01-Oct-2025 22:37:12 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-15 -> 15/07/2025
[01-Oct-2025 22:37:12 UTC] DEBUG formatearFecha - Input: '2025-07-14' (tipo: string)
[01-Oct-2025 22:37:12 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-14 -> 14/07/2025
[01-Oct-2025 22:37:12 UTC] DEBUG formatearFecha - Input: '2025-07-11' (tipo: string)
[01-Oct-2025 22:37:12 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-11 -> 11/07/2025
[01-Oct-2025 22:37:12 UTC] DEBUG formatearFecha - Input: '2025-07-10' (tipo: string)
[01-Oct-2025 22:37:12 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-10 -> 10/07/2025
[01-Oct-2025 22:37:12 UTC] DEBUG formatearFecha - Input: '2025-07-08' (tipo: string)
[01-Oct-2025 22:37:12 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-08 -> 08/07/2025
[01-Oct-2025 22:37:12 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[01-Oct-2025 22:37:12 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[01-Oct-2025 22:37:12 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[01-Oct-2025 22:37:12 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[01-Oct-2025 22:37:12 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[01-Oct-2025 22:37:12 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[01-Oct-2025 22:37:12 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[01-Oct-2025 22:37:12 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[01-Oct-2025 22:37:12 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[01-Oct-2025 22:37:12 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[01-Oct-2025 22:37:12 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[01-Oct-2025 22:37:12 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[01-Oct-2025 22:37:12 UTC] DEBUG formatearFecha - Input: '2025-06-27' (tipo: string)
[01-Oct-2025 22:37:12 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-06-27 -> 27/06/2025
[01-Oct-2025 22:37:12 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:37:12 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:37:12 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:37:12 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:37:13 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:37:13 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:37:13 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:37:13 UTC] Acceso a reporte: usuario=1, reporte=informe-por-agencia, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:37:13 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:37:13 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:37:13 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:37:13 UTC] Acceso a reporte: usuario=1, reporte=informe-por-agencia, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:37:14 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:37:14 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:37:14 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:37:14 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:39:08 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:39:08 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:39:08 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:40:09 UTC] DEBUG Login - Usuario encontrado: NO
[01-Oct-2025 22:40:09 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:40:09 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:40:09 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:46:10 UTC] PHP Fatal error:  Uncaught Error: Call to undefined method TurfReports\Controllers\AuthController::verify() in /var/www/html/Routes/api.php:121
Stack trace:
#0 {main}
  thrown in /var/www/html/Routes/api.php on line 121
[01-Oct-2025 22:46:11 UTC] DEBUG Login - Usuario encontrado: SÍ
[01-Oct-2025 22:46:11 UTC] DEBUG Login - Login BD: carreras2024
[01-Oct-2025 22:46:11 UTC] DEBUG Login - Login enviado: carreras2024
[01-Oct-2025 22:46:11 UTC] DEBUG Login - Contraseña BD: 0192023a7bbd73250516f069df18b500
[01-Oct-2025 22:46:11 UTC] DEBUG Login - Contraseña enviada: admin123
[01-Oct-2025 22:46:11 UTC] DEBUG Login - Contraseña MD5: 0192023a7bbd73250516f069df18b500
[01-Oct-2025 22:46:11 UTC] DEBUG Login - Coinciden MD5: SÍ
[01-Oct-2025 22:46:11 UTC] DEBUG Login - id_perfil: 1 (tipo: integer)
[01-Oct-2025 22:46:11 UTC] DEBUG Login - Rol asignado: admin
[01-Oct-2025 22:46:11 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:46:11 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:46:11 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:46:13 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:46:13 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:46:13 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:46:13 UTC] Acceso a reporte: usuario=1, reporte=informe-por-agencia, filtros={"fecha_desde":"2025-09-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:46:15 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:46:15 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:46:15 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:46:15 UTC] Acceso a reporte: usuario=1, reporte=informe-por-agencia, filtros={"fecha_desde":"2025-09-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:46:17 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:46:17 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:46:17 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:46:17 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-09-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:46:19 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:46:19 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:46:19 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:46:19 UTC] Acceso a reporte: usuario=1, reporte=informe-por-agencia, filtros={"fecha_desde":"2025-09-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:46:19 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:46:19 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:46:19 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:46:19 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-09-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:46:21 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:46:21 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:46:21 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:46:21 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-09-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:46:23 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:46:23 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:46:23 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:46:23 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:46:24 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:46:24 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:46:24 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:46:25 UTC] DEBUG - Consulta SQL ejecutada: 
            SELECT 
                cr.fecha,
                cr.nro_caballo,
                COALESCE(SUM(dt.total_apostado), 0) as total_apostado,
                COALESCE(SUM(CASE WHEN crd.devolucion = 0 THEN dt.total_apostado ELSE 0 END), 0) as monto_a_devolver,
                COALESCE(SUM(CASE WHEN crd.devolucion = 1 THEN dt.total_apostado ELSE 0 END), 0) as monto_devuelto,
                CASE 
                    WHEN SUM(dt.total_apostado) IS NULL OR SUM(dt.total_apostado) = 0 THEN 'Sin Apuestas'
                    WHEN SUM(CASE WHEN crd.devolucion = 0 THEN 1 ELSE 0 END) > 0 
                         AND SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Parcial'
                    WHEN SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Devuelto'
                    ELSE 'Pendiente'
                END as estado_devolucion
            FROM 
                tbl_caballos_retirados_ultimo_momento cr
            LEFT JOIN 
                tbl_caballos_retirados_um_detalle crd ON cr.id_caballo_retirado_ultimo_momento = crd.id_caballo_retirado_ultimo_momento
            LEFT JOIN 
                tbl_detalle_tickets dt ON crd.id_detalle_ticket = dt.id_detalle_ticket
            WHERE 1=1
            AND cr.fecha >= :fecha_desde AND cr.fecha <= :fecha_hasta
            GROUP BY
                cr.fecha, cr.nro_caballo, cr.id_carrera
            ORDER BY
                cr.fecha DESC, cr.nro_caballo ASC
            LIMIT :limit OFFSET :offset
        
[01-Oct-2025 22:46:25 UTC] DEBUG - Parámetros: {":fecha_desde":"2025-05-01",":fecha_hasta":"2025-10-01",":limit":50,":offset":0}
[01-Oct-2025 22:46:25 UTC] DEBUG - Registros obtenidos: 16 de 16 totales
[01-Oct-2025 22:46:25 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[01-Oct-2025 22:46:25 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[01-Oct-2025 22:46:25 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[01-Oct-2025 22:46:25 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[01-Oct-2025 22:46:25 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[01-Oct-2025 22:46:25 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[01-Oct-2025 22:46:25 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[01-Oct-2025 22:46:25 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[01-Oct-2025 22:46:25 UTC] DEBUG formatearFecha - Input: '2025-07-15' (tipo: string)
[01-Oct-2025 22:46:25 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-15 -> 15/07/2025
[01-Oct-2025 22:46:25 UTC] DEBUG formatearFecha - Input: '2025-07-14' (tipo: string)
[01-Oct-2025 22:46:25 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-14 -> 14/07/2025
[01-Oct-2025 22:46:25 UTC] DEBUG formatearFecha - Input: '2025-07-11' (tipo: string)
[01-Oct-2025 22:46:25 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-11 -> 11/07/2025
[01-Oct-2025 22:46:25 UTC] DEBUG formatearFecha - Input: '2025-07-10' (tipo: string)
[01-Oct-2025 22:46:25 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-10 -> 10/07/2025
[01-Oct-2025 22:46:25 UTC] DEBUG formatearFecha - Input: '2025-07-08' (tipo: string)
[01-Oct-2025 22:46:25 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-08 -> 08/07/2025
[01-Oct-2025 22:46:25 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[01-Oct-2025 22:46:25 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[01-Oct-2025 22:46:25 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[01-Oct-2025 22:46:25 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[01-Oct-2025 22:46:25 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[01-Oct-2025 22:46:25 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[01-Oct-2025 22:46:25 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[01-Oct-2025 22:46:25 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[01-Oct-2025 22:46:25 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[01-Oct-2025 22:46:25 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[01-Oct-2025 22:46:25 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[01-Oct-2025 22:46:25 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[01-Oct-2025 22:46:25 UTC] DEBUG formatearFecha - Input: '2025-06-27' (tipo: string)
[01-Oct-2025 22:46:25 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-06-27 -> 27/06/2025
[01-Oct-2025 22:46:26 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:46:26 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:46:26 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:46:26 UTC] DEBUG - Consulta SQL ejecutada: 
            SELECT 
                cr.fecha,
                cr.nro_caballo,
                COALESCE(SUM(dt.total_apostado), 0) as total_apostado,
                COALESCE(SUM(CASE WHEN crd.devolucion = 0 THEN dt.total_apostado ELSE 0 END), 0) as monto_a_devolver,
                COALESCE(SUM(CASE WHEN crd.devolucion = 1 THEN dt.total_apostado ELSE 0 END), 0) as monto_devuelto,
                CASE 
                    WHEN SUM(dt.total_apostado) IS NULL OR SUM(dt.total_apostado) = 0 THEN 'Sin Apuestas'
                    WHEN SUM(CASE WHEN crd.devolucion = 0 THEN 1 ELSE 0 END) > 0 
                         AND SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Parcial'
                    WHEN SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Devuelto'
                    ELSE 'Pendiente'
                END as estado_devolucion
            FROM 
                tbl_caballos_retirados_ultimo_momento cr
            LEFT JOIN 
                tbl_caballos_retirados_um_detalle crd ON cr.id_caballo_retirado_ultimo_momento = crd.id_caballo_retirado_ultimo_momento
            LEFT JOIN 
                tbl_detalle_tickets dt ON crd.id_detalle_ticket = dt.id_detalle_ticket
            WHERE 1=1
            AND cr.fecha >= :fecha_desde AND cr.fecha <= :fecha_hasta
            GROUP BY
                cr.fecha, cr.nro_caballo, cr.id_carrera
            ORDER BY
                cr.fecha DESC, cr.nro_caballo ASC
            LIMIT :limit OFFSET :offset
        
[01-Oct-2025 22:46:26 UTC] DEBUG - Parámetros: {":fecha_desde":"2025-05-01",":fecha_hasta":"2025-10-01",":limit":50,":offset":0}
[01-Oct-2025 22:46:26 UTC] DEBUG - Registros obtenidos: 16 de 16 totales
[01-Oct-2025 22:46:26 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[01-Oct-2025 22:46:26 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[01-Oct-2025 22:46:26 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[01-Oct-2025 22:46:26 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[01-Oct-2025 22:46:26 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[01-Oct-2025 22:46:26 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[01-Oct-2025 22:46:26 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[01-Oct-2025 22:46:26 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[01-Oct-2025 22:46:26 UTC] DEBUG formatearFecha - Input: '2025-07-15' (tipo: string)
[01-Oct-2025 22:46:26 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-15 -> 15/07/2025
[01-Oct-2025 22:46:26 UTC] DEBUG formatearFecha - Input: '2025-07-14' (tipo: string)
[01-Oct-2025 22:46:26 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-14 -> 14/07/2025
[01-Oct-2025 22:46:26 UTC] DEBUG formatearFecha - Input: '2025-07-11' (tipo: string)
[01-Oct-2025 22:46:26 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-11 -> 11/07/2025
[01-Oct-2025 22:46:26 UTC] DEBUG formatearFecha - Input: '2025-07-10' (tipo: string)
[01-Oct-2025 22:46:26 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-10 -> 10/07/2025
[01-Oct-2025 22:46:26 UTC] DEBUG formatearFecha - Input: '2025-07-08' (tipo: string)
[01-Oct-2025 22:46:26 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-08 -> 08/07/2025
[01-Oct-2025 22:46:26 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[01-Oct-2025 22:46:26 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[01-Oct-2025 22:46:26 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[01-Oct-2025 22:46:26 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[01-Oct-2025 22:46:26 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[01-Oct-2025 22:46:26 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[01-Oct-2025 22:46:26 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[01-Oct-2025 22:46:26 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[01-Oct-2025 22:46:26 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[01-Oct-2025 22:46:26 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[01-Oct-2025 22:46:26 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[01-Oct-2025 22:46:26 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[01-Oct-2025 22:46:26 UTC] DEBUG formatearFecha - Input: '2025-06-27' (tipo: string)
[01-Oct-2025 22:46:26 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-06-27 -> 27/06/2025
[01-Oct-2025 22:46:27 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:46:27 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:46:27 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:46:27 UTC] Acceso a reporte: usuario=1, reporte=informe-por-agencia, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:46:29 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:46:29 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:46:29 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:46:29 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:46:31 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:46:31 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:46:31 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:46:31 UTC] Acceso a reporte: usuario=1, reporte=informe-por-agencia, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:46:35 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:46:35 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:46:35 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:46:35 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:46:37 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:46:37 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:46:37 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:46:37 UTC] DEBUG - Consulta SQL ejecutada: 
            SELECT 
                cr.fecha,
                cr.nro_caballo,
                COALESCE(SUM(dt.total_apostado), 0) as total_apostado,
                COALESCE(SUM(CASE WHEN crd.devolucion = 0 THEN dt.total_apostado ELSE 0 END), 0) as monto_a_devolver,
                COALESCE(SUM(CASE WHEN crd.devolucion = 1 THEN dt.total_apostado ELSE 0 END), 0) as monto_devuelto,
                CASE 
                    WHEN SUM(dt.total_apostado) IS NULL OR SUM(dt.total_apostado) = 0 THEN 'Sin Apuestas'
                    WHEN SUM(CASE WHEN crd.devolucion = 0 THEN 1 ELSE 0 END) > 0 
                         AND SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Parcial'
                    WHEN SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Devuelto'
                    ELSE 'Pendiente'
                END as estado_devolucion
            FROM 
                tbl_caballos_retirados_ultimo_momento cr
            LEFT JOIN 
                tbl_caballos_retirados_um_detalle crd ON cr.id_caballo_retirado_ultimo_momento = crd.id_caballo_retirado_ultimo_momento
            LEFT JOIN 
                tbl_detalle_tickets dt ON crd.id_detalle_ticket = dt.id_detalle_ticket
            WHERE 1=1
            AND cr.fecha >= :fecha_desde AND cr.fecha <= :fecha_hasta
            GROUP BY
                cr.fecha, cr.nro_caballo, cr.id_carrera
            ORDER BY
                cr.fecha DESC, cr.nro_caballo ASC
            LIMIT :limit OFFSET :offset
        
[01-Oct-2025 22:46:37 UTC] DEBUG - Parámetros: {":fecha_desde":"2025-05-01",":fecha_hasta":"2025-10-01",":limit":50,":offset":0}
[01-Oct-2025 22:46:37 UTC] DEBUG - Registros obtenidos: 16 de 16 totales
[01-Oct-2025 22:46:37 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[01-Oct-2025 22:46:37 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[01-Oct-2025 22:46:37 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[01-Oct-2025 22:46:37 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[01-Oct-2025 22:46:37 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[01-Oct-2025 22:46:37 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[01-Oct-2025 22:46:37 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[01-Oct-2025 22:46:37 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[01-Oct-2025 22:46:37 UTC] DEBUG formatearFecha - Input: '2025-07-15' (tipo: string)
[01-Oct-2025 22:46:37 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-15 -> 15/07/2025
[01-Oct-2025 22:46:37 UTC] DEBUG formatearFecha - Input: '2025-07-14' (tipo: string)
[01-Oct-2025 22:46:37 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-14 -> 14/07/2025
[01-Oct-2025 22:46:37 UTC] DEBUG formatearFecha - Input: '2025-07-11' (tipo: string)
[01-Oct-2025 22:46:37 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-11 -> 11/07/2025
[01-Oct-2025 22:46:37 UTC] DEBUG formatearFecha - Input: '2025-07-10' (tipo: string)
[01-Oct-2025 22:46:37 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-10 -> 10/07/2025
[01-Oct-2025 22:46:37 UTC] DEBUG formatearFecha - Input: '2025-07-08' (tipo: string)
[01-Oct-2025 22:46:37 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-08 -> 08/07/2025
[01-Oct-2025 22:46:37 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[01-Oct-2025 22:46:37 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[01-Oct-2025 22:46:37 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[01-Oct-2025 22:46:37 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[01-Oct-2025 22:46:37 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[01-Oct-2025 22:46:37 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[01-Oct-2025 22:46:37 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[01-Oct-2025 22:46:37 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[01-Oct-2025 22:46:37 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[01-Oct-2025 22:46:37 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[01-Oct-2025 22:46:37 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[01-Oct-2025 22:46:37 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[01-Oct-2025 22:46:37 UTC] DEBUG formatearFecha - Input: '2025-06-27' (tipo: string)
[01-Oct-2025 22:46:37 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-06-27 -> 27/06/2025
[01-Oct-2025 22:46:38 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:46:38 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:46:38 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:46:38 UTC] DEBUG - Consulta SQL ejecutada: 
            SELECT 
                cr.fecha,
                cr.nro_caballo,
                COALESCE(SUM(dt.total_apostado), 0) as total_apostado,
                COALESCE(SUM(CASE WHEN crd.devolucion = 0 THEN dt.total_apostado ELSE 0 END), 0) as monto_a_devolver,
                COALESCE(SUM(CASE WHEN crd.devolucion = 1 THEN dt.total_apostado ELSE 0 END), 0) as monto_devuelto,
                CASE 
                    WHEN SUM(dt.total_apostado) IS NULL OR SUM(dt.total_apostado) = 0 THEN 'Sin Apuestas'
                    WHEN SUM(CASE WHEN crd.devolucion = 0 THEN 1 ELSE 0 END) > 0 
                         AND SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Parcial'
                    WHEN SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Devuelto'
                    ELSE 'Pendiente'
                END as estado_devolucion
            FROM 
                tbl_caballos_retirados_ultimo_momento cr
            LEFT JOIN 
                tbl_caballos_retirados_um_detalle crd ON cr.id_caballo_retirado_ultimo_momento = crd.id_caballo_retirado_ultimo_momento
            LEFT JOIN 
                tbl_detalle_tickets dt ON crd.id_detalle_ticket = dt.id_detalle_ticket
            WHERE 1=1
            AND cr.fecha >= :fecha_desde AND cr.fecha <= :fecha_hasta
            GROUP BY
                cr.fecha, cr.nro_caballo, cr.id_carrera
            ORDER BY
                cr.fecha DESC, cr.nro_caballo ASC
            LIMIT :limit OFFSET :offset
        
[01-Oct-2025 22:46:38 UTC] DEBUG - Parámetros: {":fecha_desde":"2025-05-01",":fecha_hasta":"2025-10-01",":limit":50,":offset":0}
[01-Oct-2025 22:46:38 UTC] DEBUG - Registros obtenidos: 16 de 16 totales
[01-Oct-2025 22:46:38 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[01-Oct-2025 22:46:38 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[01-Oct-2025 22:46:38 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[01-Oct-2025 22:46:38 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[01-Oct-2025 22:46:38 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[01-Oct-2025 22:46:38 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[01-Oct-2025 22:46:38 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[01-Oct-2025 22:46:38 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[01-Oct-2025 22:46:38 UTC] DEBUG formatearFecha - Input: '2025-07-15' (tipo: string)
[01-Oct-2025 22:46:38 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-15 -> 15/07/2025
[01-Oct-2025 22:46:38 UTC] DEBUG formatearFecha - Input: '2025-07-14' (tipo: string)
[01-Oct-2025 22:46:38 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-14 -> 14/07/2025
[01-Oct-2025 22:46:38 UTC] DEBUG formatearFecha - Input: '2025-07-11' (tipo: string)
[01-Oct-2025 22:46:38 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-11 -> 11/07/2025
[01-Oct-2025 22:46:38 UTC] DEBUG formatearFecha - Input: '2025-07-10' (tipo: string)
[01-Oct-2025 22:46:38 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-10 -> 10/07/2025
[01-Oct-2025 22:46:38 UTC] DEBUG formatearFecha - Input: '2025-07-08' (tipo: string)
[01-Oct-2025 22:46:38 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-08 -> 08/07/2025
[01-Oct-2025 22:46:38 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[01-Oct-2025 22:46:38 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[01-Oct-2025 22:46:38 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[01-Oct-2025 22:46:38 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[01-Oct-2025 22:46:38 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[01-Oct-2025 22:46:38 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[01-Oct-2025 22:46:38 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[01-Oct-2025 22:46:38 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[01-Oct-2025 22:46:38 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[01-Oct-2025 22:46:38 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[01-Oct-2025 22:46:38 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[01-Oct-2025 22:46:38 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[01-Oct-2025 22:46:38 UTC] DEBUG formatearFecha - Input: '2025-06-27' (tipo: string)
[01-Oct-2025 22:46:38 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-06-27 -> 27/06/2025
[01-Oct-2025 22:46:39 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:46:39 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:46:39 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:46:39 UTC] DEBUG Carreras - Filtros recibidos: {"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:46:39 UTC] DEBUG Carreras - WHERE SQL: WHERE STR_TO_DATE(c.fecha, '%d/%m/%Y') >= STR_TO_DATE(:fecha_desde, '%Y-%m-%d') AND STR_TO_DATE(c.fecha, '%d/%m/%Y') <= STR_TO_DATE(:fecha_hasta, '%Y-%m-%d')
[01-Oct-2025 22:46:39 UTC] DEBUG Carreras - Parámetros: {":fecha_desde":"2025-05-01",":fecha_hasta":"2025-10-01"}
[01-Oct-2025 22:46:39 UTC] DEBUG Carreras - Registros obtenidos: 50
[01-Oct-2025 22:46:39 UTC] DEBUG Carreras - Primer registro: {"numero_carrera":1,"fecha":"31\/07\/2025","nombre_hipodromo":"San Isidro","estado_carrera":"Apuesta","carrera_interna_id":52}
[01-Oct-2025 22:46:40 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:46:40 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:46:40 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:46:40 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:46:40 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:46:40 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:46:40 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:46:41 UTC] DEBUG - Consulta SQL ejecutada: 
            SELECT 
                cr.fecha,
                cr.nro_caballo,
                COALESCE(SUM(dt.total_apostado), 0) as total_apostado,
                COALESCE(SUM(CASE WHEN crd.devolucion = 0 THEN dt.total_apostado ELSE 0 END), 0) as monto_a_devolver,
                COALESCE(SUM(CASE WHEN crd.devolucion = 1 THEN dt.total_apostado ELSE 0 END), 0) as monto_devuelto,
                CASE 
                    WHEN SUM(dt.total_apostado) IS NULL OR SUM(dt.total_apostado) = 0 THEN 'Sin Apuestas'
                    WHEN SUM(CASE WHEN crd.devolucion = 0 THEN 1 ELSE 0 END) > 0 
                         AND SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Parcial'
                    WHEN SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Devuelto'
                    ELSE 'Pendiente'
                END as estado_devolucion
            FROM 
                tbl_caballos_retirados_ultimo_momento cr
            LEFT JOIN 
                tbl_caballos_retirados_um_detalle crd ON cr.id_caballo_retirado_ultimo_momento = crd.id_caballo_retirado_ultimo_momento
            LEFT JOIN 
                tbl_detalle_tickets dt ON crd.id_detalle_ticket = dt.id_detalle_ticket
            WHERE 1=1
            AND cr.fecha >= :fecha_desde AND cr.fecha <= :fecha_hasta
            GROUP BY
                cr.fecha, cr.nro_caballo, cr.id_carrera
            ORDER BY
                cr.fecha DESC, cr.nro_caballo ASC
            LIMIT :limit OFFSET :offset
        
[01-Oct-2025 22:46:41 UTC] DEBUG - Parámetros: {":fecha_desde":"2025-05-01",":fecha_hasta":"2025-10-01",":limit":50,":offset":0}
[01-Oct-2025 22:46:41 UTC] DEBUG - Registros obtenidos: 16 de 16 totales
[01-Oct-2025 22:46:41 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[01-Oct-2025 22:46:41 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[01-Oct-2025 22:46:41 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[01-Oct-2025 22:46:41 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[01-Oct-2025 22:46:41 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[01-Oct-2025 22:46:41 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[01-Oct-2025 22:46:41 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[01-Oct-2025 22:46:41 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[01-Oct-2025 22:46:41 UTC] DEBUG formatearFecha - Input: '2025-07-15' (tipo: string)
[01-Oct-2025 22:46:41 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-15 -> 15/07/2025
[01-Oct-2025 22:46:41 UTC] DEBUG formatearFecha - Input: '2025-07-14' (tipo: string)
[01-Oct-2025 22:46:41 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-14 -> 14/07/2025
[01-Oct-2025 22:46:41 UTC] DEBUG formatearFecha - Input: '2025-07-11' (tipo: string)
[01-Oct-2025 22:46:41 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-11 -> 11/07/2025
[01-Oct-2025 22:46:41 UTC] DEBUG formatearFecha - Input: '2025-07-10' (tipo: string)
[01-Oct-2025 22:46:41 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-10 -> 10/07/2025
[01-Oct-2025 22:46:41 UTC] DEBUG formatearFecha - Input: '2025-07-08' (tipo: string)
[01-Oct-2025 22:46:41 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-08 -> 08/07/2025
[01-Oct-2025 22:46:41 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[01-Oct-2025 22:46:41 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[01-Oct-2025 22:46:41 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[01-Oct-2025 22:46:41 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[01-Oct-2025 22:46:41 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[01-Oct-2025 22:46:41 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[01-Oct-2025 22:46:41 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[01-Oct-2025 22:46:41 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[01-Oct-2025 22:46:41 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[01-Oct-2025 22:46:41 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[01-Oct-2025 22:46:41 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[01-Oct-2025 22:46:41 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[01-Oct-2025 22:46:41 UTC] DEBUG formatearFecha - Input: '2025-06-27' (tipo: string)
[01-Oct-2025 22:46:41 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-06-27 -> 27/06/2025
[01-Oct-2025 22:46:41 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:46:41 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:46:41 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:46:41 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:46:41 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:46:41 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:46:41 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:46:41 UTC] DEBUG - Consulta SQL ejecutada: 
            SELECT 
                cr.fecha,
                cr.nro_caballo,
                COALESCE(SUM(dt.total_apostado), 0) as total_apostado,
                COALESCE(SUM(CASE WHEN crd.devolucion = 0 THEN dt.total_apostado ELSE 0 END), 0) as monto_a_devolver,
                COALESCE(SUM(CASE WHEN crd.devolucion = 1 THEN dt.total_apostado ELSE 0 END), 0) as monto_devuelto,
                CASE 
                    WHEN SUM(dt.total_apostado) IS NULL OR SUM(dt.total_apostado) = 0 THEN 'Sin Apuestas'
                    WHEN SUM(CASE WHEN crd.devolucion = 0 THEN 1 ELSE 0 END) > 0 
                         AND SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Parcial'
                    WHEN SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Devuelto'
                    ELSE 'Pendiente'
                END as estado_devolucion
            FROM 
                tbl_caballos_retirados_ultimo_momento cr
            LEFT JOIN 
                tbl_caballos_retirados_um_detalle crd ON cr.id_caballo_retirado_ultimo_momento = crd.id_caballo_retirado_ultimo_momento
            LEFT JOIN 
                tbl_detalle_tickets dt ON crd.id_detalle_ticket = dt.id_detalle_ticket
            WHERE 1=1
            AND cr.fecha >= :fecha_desde AND cr.fecha <= :fecha_hasta
            GROUP BY
                cr.fecha, cr.nro_caballo, cr.id_carrera
            ORDER BY
                cr.fecha DESC, cr.nro_caballo ASC
            LIMIT :limit OFFSET :offset
        
[01-Oct-2025 22:46:41 UTC] DEBUG - Parámetros: {":fecha_desde":"2025-05-01",":fecha_hasta":"2025-10-01",":limit":50,":offset":0}
[01-Oct-2025 22:46:41 UTC] DEBUG - Registros obtenidos: 16 de 16 totales
[01-Oct-2025 22:46:41 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[01-Oct-2025 22:46:41 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[01-Oct-2025 22:46:41 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[01-Oct-2025 22:46:41 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[01-Oct-2025 22:46:41 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[01-Oct-2025 22:46:41 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[01-Oct-2025 22:46:41 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[01-Oct-2025 22:46:41 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[01-Oct-2025 22:46:41 UTC] DEBUG formatearFecha - Input: '2025-07-15' (tipo: string)
[01-Oct-2025 22:46:41 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-15 -> 15/07/2025
[01-Oct-2025 22:46:41 UTC] DEBUG formatearFecha - Input: '2025-07-14' (tipo: string)
[01-Oct-2025 22:46:41 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-14 -> 14/07/2025
[01-Oct-2025 22:46:41 UTC] DEBUG formatearFecha - Input: '2025-07-11' (tipo: string)
[01-Oct-2025 22:46:41 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-11 -> 11/07/2025
[01-Oct-2025 22:46:41 UTC] DEBUG formatearFecha - Input: '2025-07-10' (tipo: string)
[01-Oct-2025 22:46:41 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-10 -> 10/07/2025
[01-Oct-2025 22:46:41 UTC] DEBUG formatearFecha - Input: '2025-07-08' (tipo: string)
[01-Oct-2025 22:46:41 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-08 -> 08/07/2025
[01-Oct-2025 22:46:41 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[01-Oct-2025 22:46:41 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[01-Oct-2025 22:46:41 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[01-Oct-2025 22:46:41 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[01-Oct-2025 22:46:41 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[01-Oct-2025 22:46:41 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[01-Oct-2025 22:46:41 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[01-Oct-2025 22:46:41 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[01-Oct-2025 22:46:41 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[01-Oct-2025 22:46:41 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[01-Oct-2025 22:46:42 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[01-Oct-2025 22:46:42 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[01-Oct-2025 22:46:42 UTC] DEBUG formatearFecha - Input: '2025-06-27' (tipo: string)
[01-Oct-2025 22:46:42 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-06-27 -> 27/06/2025
[01-Oct-2025 22:46:47 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:46:47 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:46:47 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:46:47 UTC] Acceso a reporte: usuario=1, reporte=informe-por-agencia, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:46:55 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:46:55 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:46:55 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:46:55 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:46:57 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:46:57 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:46:57 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:46:57 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:47:23 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:47:23 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:47:23 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:47:23 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:47:24 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:47:24 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:47:24 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:47:24 UTC] Acceso a reporte: usuario=1, reporte=informe-por-agencia, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:47:46 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:47:46 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:47:47 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:47:47 UTC] DEBUG Tickets Anulados - Filtros recibidos: {"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:47:47 UTC] DEBUG Tickets Anulados - WHERE construido: AND STR_TO_DATE(t.fecha, '%d/%m/%Y') >= STR_TO_DATE(:fecha_desde, '%Y-%m-%d') AND STR_TO_DATE(t.fecha, '%d/%m/%Y') <= STR_TO_DATE(:fecha_hasta, '%Y-%m-%d')
[01-Oct-2025 22:47:47 UTC] DEBUG Tickets Anulados - Registros obtenidos: 12
[01-Oct-2025 22:47:47 UTC] DEBUG Tickets Anulados - Primer registro: {"nro_ticket":133,"fecha":"31\/07\/2025","hora":"10:01:20","nombre_usuario":"Agencia 24","nombre_agencia":"Morteros","total_apostado":10000}
[01-Oct-2025 22:47:47 UTC] DEBUG formatearFecha - Input: '31/07/2025' (tipo: string)
[01-Oct-2025 22:47:47 UTC] DEBUG formatearFecha - Ya en formato correcto: 31/07/2025
[01-Oct-2025 22:47:47 UTC] DEBUG formatearFecha - Input: '06/07/2025' (tipo: string)
[01-Oct-2025 22:47:47 UTC] DEBUG formatearFecha - Ya en formato correcto: 06/07/2025
[01-Oct-2025 22:47:47 UTC] DEBUG formatearFecha - Input: '05/07/2025' (tipo: string)
[01-Oct-2025 22:47:47 UTC] DEBUG formatearFecha - Ya en formato correcto: 05/07/2025
[01-Oct-2025 22:47:47 UTC] DEBUG formatearFecha - Input: '04/07/2025' (tipo: string)
[01-Oct-2025 22:47:47 UTC] DEBUG formatearFecha - Ya en formato correcto: 04/07/2025
[01-Oct-2025 22:47:47 UTC] DEBUG formatearFecha - Input: '02/07/2025' (tipo: string)
[01-Oct-2025 22:47:47 UTC] DEBUG formatearFecha - Ya en formato correcto: 02/07/2025
[01-Oct-2025 22:47:47 UTC] DEBUG formatearFecha - Input: '02/07/2025' (tipo: string)
[01-Oct-2025 22:47:47 UTC] DEBUG formatearFecha - Ya en formato correcto: 02/07/2025
[01-Oct-2025 22:47:47 UTC] DEBUG formatearFecha - Input: '02/07/2025' (tipo: string)
[01-Oct-2025 22:47:47 UTC] DEBUG formatearFecha - Ya en formato correcto: 02/07/2025
[01-Oct-2025 22:47:47 UTC] DEBUG formatearFecha - Input: '02/07/2025' (tipo: string)
[01-Oct-2025 22:47:47 UTC] DEBUG formatearFecha - Ya en formato correcto: 02/07/2025
[01-Oct-2025 22:47:47 UTC] DEBUG formatearFecha - Input: '01/07/2025' (tipo: string)
[01-Oct-2025 22:47:47 UTC] DEBUG formatearFecha - Ya en formato correcto: 01/07/2025
[01-Oct-2025 22:47:47 UTC] DEBUG formatearFecha - Input: '01/07/2025' (tipo: string)
[01-Oct-2025 22:47:47 UTC] DEBUG formatearFecha - Ya en formato correcto: 01/07/2025
[01-Oct-2025 22:47:47 UTC] DEBUG formatearFecha - Input: '01/07/2025' (tipo: string)
[01-Oct-2025 22:47:47 UTC] DEBUG formatearFecha - Ya en formato correcto: 01/07/2025
[01-Oct-2025 22:47:47 UTC] DEBUG formatearFecha - Input: '30/06/2025' (tipo: string)
[01-Oct-2025 22:47:47 UTC] DEBUG formatearFecha - Ya en formato correcto: 30/06/2025
[01-Oct-2025 22:47:50 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:47:50 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:47:50 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:47:50 UTC] DEBUG Carreras - Filtros recibidos: {"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:47:50 UTC] DEBUG Carreras - WHERE SQL: WHERE STR_TO_DATE(c.fecha, '%d/%m/%Y') >= STR_TO_DATE(:fecha_desde, '%Y-%m-%d') AND STR_TO_DATE(c.fecha, '%d/%m/%Y') <= STR_TO_DATE(:fecha_hasta, '%Y-%m-%d')
[01-Oct-2025 22:47:50 UTC] DEBUG Carreras - Parámetros: {":fecha_desde":"2025-05-01",":fecha_hasta":"2025-10-01"}
[01-Oct-2025 22:47:50 UTC] DEBUG Carreras - Registros obtenidos: 50
[01-Oct-2025 22:47:50 UTC] DEBUG Carreras - Primer registro: {"numero_carrera":1,"fecha":"31\/07\/2025","nombre_hipodromo":"San Isidro","estado_carrera":"Apuesta","carrera_interna_id":52}
[01-Oct-2025 22:47:52 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:47:52 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:47:52 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:47:52 UTC] DEBUG - Consulta SQL ejecutada: 
            SELECT 
                cr.fecha,
                cr.nro_caballo,
                COALESCE(SUM(dt.total_apostado), 0) as total_apostado,
                COALESCE(SUM(CASE WHEN crd.devolucion = 0 THEN dt.total_apostado ELSE 0 END), 0) as monto_a_devolver,
                COALESCE(SUM(CASE WHEN crd.devolucion = 1 THEN dt.total_apostado ELSE 0 END), 0) as monto_devuelto,
                CASE 
                    WHEN SUM(dt.total_apostado) IS NULL OR SUM(dt.total_apostado) = 0 THEN 'Sin Apuestas'
                    WHEN SUM(CASE WHEN crd.devolucion = 0 THEN 1 ELSE 0 END) > 0 
                         AND SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Parcial'
                    WHEN SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Devuelto'
                    ELSE 'Pendiente'
                END as estado_devolucion
            FROM 
                tbl_caballos_retirados_ultimo_momento cr
            LEFT JOIN 
                tbl_caballos_retirados_um_detalle crd ON cr.id_caballo_retirado_ultimo_momento = crd.id_caballo_retirado_ultimo_momento
            LEFT JOIN 
                tbl_detalle_tickets dt ON crd.id_detalle_ticket = dt.id_detalle_ticket
            WHERE 1=1
            AND cr.fecha >= :fecha_desde AND cr.fecha <= :fecha_hasta
            GROUP BY
                cr.fecha, cr.nro_caballo, cr.id_carrera
            ORDER BY
                cr.fecha DESC, cr.nro_caballo ASC
            LIMIT :limit OFFSET :offset
        
[01-Oct-2025 22:47:52 UTC] DEBUG - Parámetros: {":fecha_desde":"2025-05-01",":fecha_hasta":"2025-10-01",":limit":50,":offset":0}
[01-Oct-2025 22:47:52 UTC] DEBUG - Registros obtenidos: 16 de 16 totales
[01-Oct-2025 22:47:52 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[01-Oct-2025 22:47:52 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[01-Oct-2025 22:47:52 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[01-Oct-2025 22:47:52 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[01-Oct-2025 22:47:52 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[01-Oct-2025 22:47:52 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[01-Oct-2025 22:47:52 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[01-Oct-2025 22:47:52 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[01-Oct-2025 22:47:52 UTC] DEBUG formatearFecha - Input: '2025-07-15' (tipo: string)
[01-Oct-2025 22:47:52 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-15 -> 15/07/2025
[01-Oct-2025 22:47:52 UTC] DEBUG formatearFecha - Input: '2025-07-14' (tipo: string)
[01-Oct-2025 22:47:52 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-14 -> 14/07/2025
[01-Oct-2025 22:47:52 UTC] DEBUG formatearFecha - Input: '2025-07-11' (tipo: string)
[01-Oct-2025 22:47:52 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-11 -> 11/07/2025
[01-Oct-2025 22:47:52 UTC] DEBUG formatearFecha - Input: '2025-07-10' (tipo: string)
[01-Oct-2025 22:47:52 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-10 -> 10/07/2025
[01-Oct-2025 22:47:52 UTC] DEBUG formatearFecha - Input: '2025-07-08' (tipo: string)
[01-Oct-2025 22:47:52 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-08 -> 08/07/2025
[01-Oct-2025 22:47:52 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[01-Oct-2025 22:47:52 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[01-Oct-2025 22:47:52 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[01-Oct-2025 22:47:52 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[01-Oct-2025 22:47:52 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[01-Oct-2025 22:47:52 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[01-Oct-2025 22:47:52 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[01-Oct-2025 22:47:52 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[01-Oct-2025 22:47:52 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[01-Oct-2025 22:47:52 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[01-Oct-2025 22:47:52 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[01-Oct-2025 22:47:52 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[01-Oct-2025 22:47:52 UTC] DEBUG formatearFecha - Input: '2025-06-27' (tipo: string)
[01-Oct-2025 22:47:52 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-06-27 -> 27/06/2025
[01-Oct-2025 22:47:55 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:47:55 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:47:55 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:47:55 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:47:56 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:47:56 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:47:56 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:47:56 UTC] Acceso a reporte: usuario=1, reporte=informe-por-agencia, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:48:01 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:48:01 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:48:01 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:48:01 UTC] Acceso a reporte: usuario=1, reporte=informe-por-agencia, filtros={"fecha_desde":"2025-10-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:48:03 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:48:03 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:48:03 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:48:03 UTC] Acceso a reporte: usuario=1, reporte=informe-por-agencia, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:48:04 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:48:04 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:48:04 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:48:04 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:48:55 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:48:55 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:48:55 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:48:55 UTC] DEBUG - Consulta SQL ejecutada: 
            SELECT 
                cr.fecha,
                cr.nro_caballo,
                COALESCE(SUM(dt.total_apostado), 0) as total_apostado,
                COALESCE(SUM(CASE WHEN crd.devolucion = 0 THEN dt.total_apostado ELSE 0 END), 0) as monto_a_devolver,
                COALESCE(SUM(CASE WHEN crd.devolucion = 1 THEN dt.total_apostado ELSE 0 END), 0) as monto_devuelto,
                CASE 
                    WHEN SUM(dt.total_apostado) IS NULL OR SUM(dt.total_apostado) = 0 THEN 'Sin Apuestas'
                    WHEN SUM(CASE WHEN crd.devolucion = 0 THEN 1 ELSE 0 END) > 0 
                         AND SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Parcial'
                    WHEN SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Devuelto'
                    ELSE 'Pendiente'
                END as estado_devolucion
            FROM 
                tbl_caballos_retirados_ultimo_momento cr
            LEFT JOIN 
                tbl_caballos_retirados_um_detalle crd ON cr.id_caballo_retirado_ultimo_momento = crd.id_caballo_retirado_ultimo_momento
            LEFT JOIN 
                tbl_detalle_tickets dt ON crd.id_detalle_ticket = dt.id_detalle_ticket
            WHERE 1=1
            AND cr.fecha >= :fecha_desde AND cr.fecha <= :fecha_hasta
            GROUP BY
                cr.fecha, cr.nro_caballo, cr.id_carrera
            ORDER BY
                cr.fecha DESC, cr.nro_caballo ASC
            LIMIT :limit OFFSET :offset
        
[01-Oct-2025 22:48:55 UTC] DEBUG - Parámetros: {":fecha_desde":"2025-05-01",":fecha_hasta":"2025-10-01",":limit":50,":offset":0}
[01-Oct-2025 22:48:55 UTC] DEBUG - Registros obtenidos: 16 de 16 totales
[01-Oct-2025 22:48:55 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[01-Oct-2025 22:48:55 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[01-Oct-2025 22:48:55 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[01-Oct-2025 22:48:55 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[01-Oct-2025 22:48:55 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[01-Oct-2025 22:48:55 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[01-Oct-2025 22:48:55 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[01-Oct-2025 22:48:55 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[01-Oct-2025 22:48:55 UTC] DEBUG formatearFecha - Input: '2025-07-15' (tipo: string)
[01-Oct-2025 22:48:55 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-15 -> 15/07/2025
[01-Oct-2025 22:48:55 UTC] DEBUG formatearFecha - Input: '2025-07-14' (tipo: string)
[01-Oct-2025 22:48:55 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-14 -> 14/07/2025
[01-Oct-2025 22:48:55 UTC] DEBUG formatearFecha - Input: '2025-07-11' (tipo: string)
[01-Oct-2025 22:48:55 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-11 -> 11/07/2025
[01-Oct-2025 22:48:55 UTC] DEBUG formatearFecha - Input: '2025-07-10' (tipo: string)
[01-Oct-2025 22:48:55 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-10 -> 10/07/2025
[01-Oct-2025 22:48:55 UTC] DEBUG formatearFecha - Input: '2025-07-08' (tipo: string)
[01-Oct-2025 22:48:55 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-08 -> 08/07/2025
[01-Oct-2025 22:48:55 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[01-Oct-2025 22:48:55 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[01-Oct-2025 22:48:55 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[01-Oct-2025 22:48:55 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[01-Oct-2025 22:48:55 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[01-Oct-2025 22:48:55 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[01-Oct-2025 22:48:55 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[01-Oct-2025 22:48:55 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[01-Oct-2025 22:48:55 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[01-Oct-2025 22:48:55 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[01-Oct-2025 22:48:55 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[01-Oct-2025 22:48:55 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[01-Oct-2025 22:48:55 UTC] DEBUG formatearFecha - Input: '2025-06-27' (tipo: string)
[01-Oct-2025 22:48:55 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-06-27 -> 27/06/2025
[01-Oct-2025 22:51:48 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:51:48 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:51:48 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:51:48 UTC] Acceso a reporte: usuario=1, reporte=informe-por-agencia, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:51:48 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:51:48 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:51:48 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:51:48 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:51:54 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:51:54 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:51:54 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:51:54 UTC] DEBUG - Consulta SQL ejecutada: 
            SELECT 
                cr.fecha,
                cr.nro_caballo,
                COALESCE(SUM(dt.total_apostado), 0) as total_apostado,
                COALESCE(SUM(CASE WHEN crd.devolucion = 0 THEN dt.total_apostado ELSE 0 END), 0) as monto_a_devolver,
                COALESCE(SUM(CASE WHEN crd.devolucion = 1 THEN dt.total_apostado ELSE 0 END), 0) as monto_devuelto,
                CASE 
                    WHEN SUM(dt.total_apostado) IS NULL OR SUM(dt.total_apostado) = 0 THEN 'Sin Apuestas'
                    WHEN SUM(CASE WHEN crd.devolucion = 0 THEN 1 ELSE 0 END) > 0 
                         AND SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Parcial'
                    WHEN SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Devuelto'
                    ELSE 'Pendiente'
                END as estado_devolucion
            FROM 
                tbl_caballos_retirados_ultimo_momento cr
            LEFT JOIN 
                tbl_caballos_retirados_um_detalle crd ON cr.id_caballo_retirado_ultimo_momento = crd.id_caballo_retirado_ultimo_momento
            LEFT JOIN 
                tbl_detalle_tickets dt ON crd.id_detalle_ticket = dt.id_detalle_ticket
            WHERE 1=1
            AND cr.fecha >= :fecha_desde AND cr.fecha <= :fecha_hasta
            GROUP BY
                cr.fecha, cr.nro_caballo, cr.id_carrera
            ORDER BY
                cr.fecha DESC, cr.nro_caballo ASC
            LIMIT :limit OFFSET :offset
        
[01-Oct-2025 22:51:54 UTC] DEBUG - Parámetros: {":fecha_desde":"2025-05-01",":fecha_hasta":"2025-10-01",":limit":50,":offset":0}
[01-Oct-2025 22:51:54 UTC] DEBUG - Registros obtenidos: 16 de 16 totales
[01-Oct-2025 22:51:54 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[01-Oct-2025 22:51:54 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[01-Oct-2025 22:51:54 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[01-Oct-2025 22:51:54 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[01-Oct-2025 22:51:54 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[01-Oct-2025 22:51:54 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[01-Oct-2025 22:51:54 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[01-Oct-2025 22:51:54 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[01-Oct-2025 22:51:54 UTC] DEBUG formatearFecha - Input: '2025-07-15' (tipo: string)
[01-Oct-2025 22:51:54 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-15 -> 15/07/2025
[01-Oct-2025 22:51:54 UTC] DEBUG formatearFecha - Input: '2025-07-14' (tipo: string)
[01-Oct-2025 22:51:54 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-14 -> 14/07/2025
[01-Oct-2025 22:51:54 UTC] DEBUG formatearFecha - Input: '2025-07-11' (tipo: string)
[01-Oct-2025 22:51:54 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-11 -> 11/07/2025
[01-Oct-2025 22:51:54 UTC] DEBUG formatearFecha - Input: '2025-07-10' (tipo: string)
[01-Oct-2025 22:51:54 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-10 -> 10/07/2025
[01-Oct-2025 22:51:54 UTC] DEBUG formatearFecha - Input: '2025-07-08' (tipo: string)
[01-Oct-2025 22:51:54 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-08 -> 08/07/2025
[01-Oct-2025 22:51:54 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[01-Oct-2025 22:51:54 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[01-Oct-2025 22:51:54 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[01-Oct-2025 22:51:54 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[01-Oct-2025 22:51:54 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[01-Oct-2025 22:51:54 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[01-Oct-2025 22:51:54 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[01-Oct-2025 22:51:54 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[01-Oct-2025 22:51:54 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[01-Oct-2025 22:51:54 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[01-Oct-2025 22:51:54 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[01-Oct-2025 22:51:54 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[01-Oct-2025 22:51:54 UTC] DEBUG formatearFecha - Input: '2025-06-27' (tipo: string)
[01-Oct-2025 22:51:54 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-06-27 -> 27/06/2025
[01-Oct-2025 22:52:14 UTC] PHP Fatal error:  Uncaught Error: Call to undefined method TurfReports\Controllers\AuthController::verify() in /var/www/html/Routes/api.php:121
Stack trace:
#0 {main}
  thrown in /var/www/html/Routes/api.php on line 121
[01-Oct-2025 22:52:15 UTC] DEBUG Login - Usuario encontrado: SÍ
[01-Oct-2025 22:52:15 UTC] DEBUG Login - Login BD: carreras2024
[01-Oct-2025 22:52:15 UTC] DEBUG Login - Login enviado: carreras2024
[01-Oct-2025 22:52:15 UTC] DEBUG Login - Contraseña BD: 0192023a7bbd73250516f069df18b500
[01-Oct-2025 22:52:15 UTC] DEBUG Login - Contraseña enviada: admin123
[01-Oct-2025 22:52:15 UTC] DEBUG Login - Contraseña MD5: 0192023a7bbd73250516f069df18b500
[01-Oct-2025 22:52:15 UTC] DEBUG Login - Coinciden MD5: SÍ
[01-Oct-2025 22:52:15 UTC] DEBUG Login - id_perfil: 1 (tipo: integer)
[01-Oct-2025 22:52:15 UTC] DEBUG Login - Rol asignado: admin
[01-Oct-2025 22:52:15 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:52:15 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:52:15 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:52:16 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:52:16 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:52:16 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:52:16 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-09-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:52:19 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:52:19 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:52:19 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:52:19 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:52:20 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:52:20 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:52:20 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:52:20 UTC] DEBUG - Consulta SQL ejecutada: 
            SELECT 
                cr.fecha,
                cr.nro_caballo,
                COALESCE(SUM(dt.total_apostado), 0) as total_apostado,
                COALESCE(SUM(CASE WHEN crd.devolucion = 0 THEN dt.total_apostado ELSE 0 END), 0) as monto_a_devolver,
                COALESCE(SUM(CASE WHEN crd.devolucion = 1 THEN dt.total_apostado ELSE 0 END), 0) as monto_devuelto,
                CASE 
                    WHEN SUM(dt.total_apostado) IS NULL OR SUM(dt.total_apostado) = 0 THEN 'Sin Apuestas'
                    WHEN SUM(CASE WHEN crd.devolucion = 0 THEN 1 ELSE 0 END) > 0 
                         AND SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Parcial'
                    WHEN SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Devuelto'
                    ELSE 'Pendiente'
                END as estado_devolucion
            FROM 
                tbl_caballos_retirados_ultimo_momento cr
            LEFT JOIN 
                tbl_caballos_retirados_um_detalle crd ON cr.id_caballo_retirado_ultimo_momento = crd.id_caballo_retirado_ultimo_momento
            LEFT JOIN 
                tbl_detalle_tickets dt ON crd.id_detalle_ticket = dt.id_detalle_ticket
            WHERE 1=1
            AND cr.fecha >= :fecha_desde AND cr.fecha <= :fecha_hasta
            GROUP BY
                cr.fecha, cr.nro_caballo, cr.id_carrera
            ORDER BY
                cr.fecha DESC, cr.nro_caballo ASC
            LIMIT :limit OFFSET :offset
        
[01-Oct-2025 22:52:20 UTC] DEBUG - Parámetros: {":fecha_desde":"2025-05-01",":fecha_hasta":"2025-10-01",":limit":50,":offset":0}
[01-Oct-2025 22:52:20 UTC] DEBUG - Registros obtenidos: 16 de 16 totales
[01-Oct-2025 22:52:20 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[01-Oct-2025 22:52:20 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[01-Oct-2025 22:52:20 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[01-Oct-2025 22:52:20 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[01-Oct-2025 22:52:20 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[01-Oct-2025 22:52:20 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[01-Oct-2025 22:52:20 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[01-Oct-2025 22:52:20 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[01-Oct-2025 22:52:20 UTC] DEBUG formatearFecha - Input: '2025-07-15' (tipo: string)
[01-Oct-2025 22:52:20 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-15 -> 15/07/2025
[01-Oct-2025 22:52:20 UTC] DEBUG formatearFecha - Input: '2025-07-14' (tipo: string)
[01-Oct-2025 22:52:20 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-14 -> 14/07/2025
[01-Oct-2025 22:52:20 UTC] DEBUG formatearFecha - Input: '2025-07-11' (tipo: string)
[01-Oct-2025 22:52:21 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-11 -> 11/07/2025
[01-Oct-2025 22:52:21 UTC] DEBUG formatearFecha - Input: '2025-07-10' (tipo: string)
[01-Oct-2025 22:52:21 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-10 -> 10/07/2025
[01-Oct-2025 22:52:21 UTC] DEBUG formatearFecha - Input: '2025-07-08' (tipo: string)
[01-Oct-2025 22:52:21 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-08 -> 08/07/2025
[01-Oct-2025 22:52:21 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[01-Oct-2025 22:52:21 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[01-Oct-2025 22:52:21 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[01-Oct-2025 22:52:21 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[01-Oct-2025 22:52:21 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[01-Oct-2025 22:52:21 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[01-Oct-2025 22:52:21 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[01-Oct-2025 22:52:21 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[01-Oct-2025 22:52:21 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[01-Oct-2025 22:52:21 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[01-Oct-2025 22:52:21 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[01-Oct-2025 22:52:21 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[01-Oct-2025 22:52:21 UTC] DEBUG formatearFecha - Input: '2025-06-27' (tipo: string)
[01-Oct-2025 22:52:21 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-06-27 -> 27/06/2025
[01-Oct-2025 22:52:21 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:52:21 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:52:21 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:52:21 UTC] DEBUG - Consulta SQL ejecutada: 
            SELECT 
                cr.fecha,
                cr.nro_caballo,
                COALESCE(SUM(dt.total_apostado), 0) as total_apostado,
                COALESCE(SUM(CASE WHEN crd.devolucion = 0 THEN dt.total_apostado ELSE 0 END), 0) as monto_a_devolver,
                COALESCE(SUM(CASE WHEN crd.devolucion = 1 THEN dt.total_apostado ELSE 0 END), 0) as monto_devuelto,
                CASE 
                    WHEN SUM(dt.total_apostado) IS NULL OR SUM(dt.total_apostado) = 0 THEN 'Sin Apuestas'
                    WHEN SUM(CASE WHEN crd.devolucion = 0 THEN 1 ELSE 0 END) > 0 
                         AND SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Parcial'
                    WHEN SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Devuelto'
                    ELSE 'Pendiente'
                END as estado_devolucion
            FROM 
                tbl_caballos_retirados_ultimo_momento cr
            LEFT JOIN 
                tbl_caballos_retirados_um_detalle crd ON cr.id_caballo_retirado_ultimo_momento = crd.id_caballo_retirado_ultimo_momento
            LEFT JOIN 
                tbl_detalle_tickets dt ON crd.id_detalle_ticket = dt.id_detalle_ticket
            WHERE 1=1
            AND cr.fecha >= :fecha_desde AND cr.fecha <= :fecha_hasta
            GROUP BY
                cr.fecha, cr.nro_caballo, cr.id_carrera
            ORDER BY
                cr.fecha DESC, cr.nro_caballo ASC
            LIMIT :limit OFFSET :offset
        
[01-Oct-2025 22:52:21 UTC] DEBUG - Parámetros: {":fecha_desde":"2025-05-01",":fecha_hasta":"2025-10-01",":limit":50,":offset":0}
[01-Oct-2025 22:52:21 UTC] DEBUG - Registros obtenidos: 16 de 16 totales
[01-Oct-2025 22:52:21 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[01-Oct-2025 22:52:21 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[01-Oct-2025 22:52:21 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[01-Oct-2025 22:52:21 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[01-Oct-2025 22:52:21 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[01-Oct-2025 22:52:21 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[01-Oct-2025 22:52:21 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[01-Oct-2025 22:52:21 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[01-Oct-2025 22:52:21 UTC] DEBUG formatearFecha - Input: '2025-07-15' (tipo: string)
[01-Oct-2025 22:52:21 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-15 -> 15/07/2025
[01-Oct-2025 22:52:21 UTC] DEBUG formatearFecha - Input: '2025-07-14' (tipo: string)
[01-Oct-2025 22:52:21 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-14 -> 14/07/2025
[01-Oct-2025 22:52:21 UTC] DEBUG formatearFecha - Input: '2025-07-11' (tipo: string)
[01-Oct-2025 22:52:21 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-11 -> 11/07/2025
[01-Oct-2025 22:52:21 UTC] DEBUG formatearFecha - Input: '2025-07-10' (tipo: string)
[01-Oct-2025 22:52:21 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-10 -> 10/07/2025
[01-Oct-2025 22:52:21 UTC] DEBUG formatearFecha - Input: '2025-07-08' (tipo: string)
[01-Oct-2025 22:52:21 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-08 -> 08/07/2025
[01-Oct-2025 22:52:21 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[01-Oct-2025 22:52:21 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[01-Oct-2025 22:52:21 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[01-Oct-2025 22:52:21 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[01-Oct-2025 22:52:21 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[01-Oct-2025 22:52:21 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[01-Oct-2025 22:52:21 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[01-Oct-2025 22:52:21 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[01-Oct-2025 22:52:21 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[01-Oct-2025 22:52:21 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[01-Oct-2025 22:52:21 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[01-Oct-2025 22:52:21 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[01-Oct-2025 22:52:21 UTC] DEBUG formatearFecha - Input: '2025-06-27' (tipo: string)
[01-Oct-2025 22:52:21 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-06-27 -> 27/06/2025
[01-Oct-2025 22:53:01 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:53:01 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:53:01 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:53:01 UTC] DEBUG Carreras - Filtros recibidos: {"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:53:01 UTC] DEBUG Carreras - WHERE SQL: WHERE STR_TO_DATE(c.fecha, '%d/%m/%Y') >= STR_TO_DATE(:fecha_desde, '%Y-%m-%d') AND STR_TO_DATE(c.fecha, '%d/%m/%Y') <= STR_TO_DATE(:fecha_hasta, '%Y-%m-%d')
[01-Oct-2025 22:53:01 UTC] DEBUG Carreras - Parámetros: {":fecha_desde":"2025-05-01",":fecha_hasta":"2025-10-01"}
[01-Oct-2025 22:53:01 UTC] DEBUG Carreras - Registros obtenidos: 50
[01-Oct-2025 22:53:01 UTC] DEBUG Carreras - Primer registro: {"numero_carrera":1,"fecha":"31\/07\/2025","nombre_hipodromo":"San Isidro","estado_carrera":"Apuesta","carrera_interna_id":52}
[01-Oct-2025 22:53:01 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:53:01 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:53:01 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:53:01 UTC] DEBUG - Consulta SQL ejecutada: 
            SELECT 
                cr.fecha,
                cr.nro_caballo,
                COALESCE(SUM(dt.total_apostado), 0) as total_apostado,
                COALESCE(SUM(CASE WHEN crd.devolucion = 0 THEN dt.total_apostado ELSE 0 END), 0) as monto_a_devolver,
                COALESCE(SUM(CASE WHEN crd.devolucion = 1 THEN dt.total_apostado ELSE 0 END), 0) as monto_devuelto,
                CASE 
                    WHEN SUM(dt.total_apostado) IS NULL OR SUM(dt.total_apostado) = 0 THEN 'Sin Apuestas'
                    WHEN SUM(CASE WHEN crd.devolucion = 0 THEN 1 ELSE 0 END) > 0 
                         AND SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Parcial'
                    WHEN SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Devuelto'
                    ELSE 'Pendiente'
                END as estado_devolucion
            FROM 
                tbl_caballos_retirados_ultimo_momento cr
            LEFT JOIN 
                tbl_caballos_retirados_um_detalle crd ON cr.id_caballo_retirado_ultimo_momento = crd.id_caballo_retirado_ultimo_momento
            LEFT JOIN 
                tbl_detalle_tickets dt ON crd.id_detalle_ticket = dt.id_detalle_ticket
            WHERE 1=1
            AND cr.fecha >= :fecha_desde AND cr.fecha <= :fecha_hasta
            GROUP BY
                cr.fecha, cr.nro_caballo, cr.id_carrera
            ORDER BY
                cr.fecha DESC, cr.nro_caballo ASC
            LIMIT :limit OFFSET :offset
        
[01-Oct-2025 22:53:01 UTC] DEBUG - Parámetros: {":fecha_desde":"2025-05-01",":fecha_hasta":"2025-10-01",":limit":50,":offset":0}
[01-Oct-2025 22:53:01 UTC] DEBUG - Registros obtenidos: 16 de 16 totales
[01-Oct-2025 22:53:01 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[01-Oct-2025 22:53:01 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[01-Oct-2025 22:53:01 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[01-Oct-2025 22:53:01 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[01-Oct-2025 22:53:01 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[01-Oct-2025 22:53:01 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[01-Oct-2025 22:53:01 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[01-Oct-2025 22:53:01 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[01-Oct-2025 22:53:01 UTC] DEBUG formatearFecha - Input: '2025-07-15' (tipo: string)
[01-Oct-2025 22:53:01 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-15 -> 15/07/2025
[01-Oct-2025 22:53:01 UTC] DEBUG formatearFecha - Input: '2025-07-14' (tipo: string)
[01-Oct-2025 22:53:01 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-14 -> 14/07/2025
[01-Oct-2025 22:53:01 UTC] DEBUG formatearFecha - Input: '2025-07-11' (tipo: string)
[01-Oct-2025 22:53:01 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-11 -> 11/07/2025
[01-Oct-2025 22:53:01 UTC] DEBUG formatearFecha - Input: '2025-07-10' (tipo: string)
[01-Oct-2025 22:53:01 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-10 -> 10/07/2025
[01-Oct-2025 22:53:01 UTC] DEBUG formatearFecha - Input: '2025-07-08' (tipo: string)
[01-Oct-2025 22:53:01 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-08 -> 08/07/2025
[01-Oct-2025 22:53:01 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[01-Oct-2025 22:53:01 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[01-Oct-2025 22:53:01 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[01-Oct-2025 22:53:01 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[01-Oct-2025 22:53:01 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[01-Oct-2025 22:53:01 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[01-Oct-2025 22:53:01 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[01-Oct-2025 22:53:01 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[01-Oct-2025 22:53:01 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[01-Oct-2025 22:53:01 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[01-Oct-2025 22:53:01 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[01-Oct-2025 22:53:01 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[01-Oct-2025 22:53:01 UTC] DEBUG formatearFecha - Input: '2025-06-27' (tipo: string)
[01-Oct-2025 22:53:01 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-06-27 -> 27/06/2025
[01-Oct-2025 22:53:02 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:53:02 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:53:02 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:53:02 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:53:02 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:53:02 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:53:02 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:53:02 UTC] DEBUG - Consulta SQL ejecutada: 
            SELECT 
                cr.fecha,
                cr.nro_caballo,
                COALESCE(SUM(dt.total_apostado), 0) as total_apostado,
                COALESCE(SUM(CASE WHEN crd.devolucion = 0 THEN dt.total_apostado ELSE 0 END), 0) as monto_a_devolver,
                COALESCE(SUM(CASE WHEN crd.devolucion = 1 THEN dt.total_apostado ELSE 0 END), 0) as monto_devuelto,
                CASE 
                    WHEN SUM(dt.total_apostado) IS NULL OR SUM(dt.total_apostado) = 0 THEN 'Sin Apuestas'
                    WHEN SUM(CASE WHEN crd.devolucion = 0 THEN 1 ELSE 0 END) > 0 
                         AND SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Parcial'
                    WHEN SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Devuelto'
                    ELSE 'Pendiente'
                END as estado_devolucion
            FROM 
                tbl_caballos_retirados_ultimo_momento cr
            LEFT JOIN 
                tbl_caballos_retirados_um_detalle crd ON cr.id_caballo_retirado_ultimo_momento = crd.id_caballo_retirado_ultimo_momento
            LEFT JOIN 
                tbl_detalle_tickets dt ON crd.id_detalle_ticket = dt.id_detalle_ticket
            WHERE 1=1
            AND cr.fecha >= :fecha_desde AND cr.fecha <= :fecha_hasta
            GROUP BY
                cr.fecha, cr.nro_caballo, cr.id_carrera
            ORDER BY
                cr.fecha DESC, cr.nro_caballo ASC
            LIMIT :limit OFFSET :offset
        
[01-Oct-2025 22:53:02 UTC] DEBUG - Parámetros: {":fecha_desde":"2025-05-01",":fecha_hasta":"2025-10-01",":limit":50,":offset":0}
[01-Oct-2025 22:53:02 UTC] DEBUG - Registros obtenidos: 16 de 16 totales
[01-Oct-2025 22:53:02 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[01-Oct-2025 22:53:02 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[01-Oct-2025 22:53:02 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[01-Oct-2025 22:53:02 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[01-Oct-2025 22:53:02 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[01-Oct-2025 22:53:02 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[01-Oct-2025 22:53:02 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[01-Oct-2025 22:53:02 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[01-Oct-2025 22:53:02 UTC] DEBUG formatearFecha - Input: '2025-07-15' (tipo: string)
[01-Oct-2025 22:53:02 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-15 -> 15/07/2025
[01-Oct-2025 22:53:02 UTC] DEBUG formatearFecha - Input: '2025-07-14' (tipo: string)
[01-Oct-2025 22:53:02 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-14 -> 14/07/2025
[01-Oct-2025 22:53:02 UTC] DEBUG formatearFecha - Input: '2025-07-11' (tipo: string)
[01-Oct-2025 22:53:02 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-11 -> 11/07/2025
[01-Oct-2025 22:53:02 UTC] DEBUG formatearFecha - Input: '2025-07-10' (tipo: string)
[01-Oct-2025 22:53:02 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-10 -> 10/07/2025
[01-Oct-2025 22:53:02 UTC] DEBUG formatearFecha - Input: '2025-07-08' (tipo: string)
[01-Oct-2025 22:53:02 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-08 -> 08/07/2025
[01-Oct-2025 22:53:02 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[01-Oct-2025 22:53:02 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[01-Oct-2025 22:53:02 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[01-Oct-2025 22:53:02 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[01-Oct-2025 22:53:02 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[01-Oct-2025 22:53:02 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[01-Oct-2025 22:53:02 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[01-Oct-2025 22:53:02 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[01-Oct-2025 22:53:02 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[01-Oct-2025 22:53:02 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[01-Oct-2025 22:53:02 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[01-Oct-2025 22:53:02 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[01-Oct-2025 22:53:02 UTC] DEBUG formatearFecha - Input: '2025-06-27' (tipo: string)
[01-Oct-2025 22:53:02 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-06-27 -> 27/06/2025
[01-Oct-2025 22:54:51 UTC] PHP Fatal error:  Uncaught Error: Call to undefined method TurfReports\Controllers\AuthController::verify() in /var/www/html/Routes/api.php:121
Stack trace:
#0 {main}
  thrown in /var/www/html/Routes/api.php on line 121
[01-Oct-2025 22:54:52 UTC] DEBUG Login - Usuario encontrado: SÍ
[01-Oct-2025 22:54:52 UTC] DEBUG Login - Login BD: carreras2024
[01-Oct-2025 22:54:52 UTC] DEBUG Login - Login enviado: carreras2024
[01-Oct-2025 22:54:52 UTC] DEBUG Login - Contraseña BD: 0192023a7bbd73250516f069df18b500
[01-Oct-2025 22:54:52 UTC] DEBUG Login - Contraseña enviada: admin123
[01-Oct-2025 22:54:52 UTC] DEBUG Login - Contraseña MD5: 0192023a7bbd73250516f069df18b500
[01-Oct-2025 22:54:52 UTC] DEBUG Login - Coinciden MD5: SÍ
[01-Oct-2025 22:54:52 UTC] DEBUG Login - id_perfil: 1 (tipo: integer)
[01-Oct-2025 22:54:52 UTC] DEBUG Login - Rol asignado: admin
[01-Oct-2025 22:54:52 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:54:52 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:54:52 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:54:53 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:54:53 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:54:53 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:54:53 UTC] Acceso a reporte: usuario=1, reporte=informe-por-agencia, filtros={"fecha_desde":"2025-09-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:55:43 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:55:43 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:55:43 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:55:43 UTC] DEBUG - Consulta SQL ejecutada: 
            SELECT 
                cr.fecha,
                cr.nro_caballo,
                COALESCE(SUM(dt.total_apostado), 0) as total_apostado,
                COALESCE(SUM(CASE WHEN crd.devolucion = 0 THEN dt.total_apostado ELSE 0 END), 0) as monto_a_devolver,
                COALESCE(SUM(CASE WHEN crd.devolucion = 1 THEN dt.total_apostado ELSE 0 END), 0) as monto_devuelto,
                CASE 
                    WHEN SUM(dt.total_apostado) IS NULL OR SUM(dt.total_apostado) = 0 THEN 'Sin Apuestas'
                    WHEN SUM(CASE WHEN crd.devolucion = 0 THEN 1 ELSE 0 END) > 0 
                         AND SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Parcial'
                    WHEN SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Devuelto'
                    ELSE 'Pendiente'
                END as estado_devolucion
            FROM 
                tbl_caballos_retirados_ultimo_momento cr
            LEFT JOIN 
                tbl_caballos_retirados_um_detalle crd ON cr.id_caballo_retirado_ultimo_momento = crd.id_caballo_retirado_ultimo_momento
            LEFT JOIN 
                tbl_detalle_tickets dt ON crd.id_detalle_ticket = dt.id_detalle_ticket
            WHERE 1=1
            AND cr.fecha >= :fecha_desde AND cr.fecha <= :fecha_hasta
            GROUP BY
                cr.fecha, cr.nro_caballo, cr.id_carrera
            ORDER BY
                cr.fecha DESC, cr.nro_caballo ASC
            LIMIT :limit OFFSET :offset
        
[01-Oct-2025 22:55:43 UTC] DEBUG - Parámetros: {":fecha_desde":"2025-09-01",":fecha_hasta":"2025-10-01",":limit":50,":offset":0}
[01-Oct-2025 22:55:43 UTC] DEBUG - Registros obtenidos: 0 de 0 totales
[01-Oct-2025 22:55:46 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:55:46 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:55:46 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:55:46 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-09-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:55:46 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:55:46 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:55:46 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:55:46 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-09-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:55:47 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:55:47 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:55:47 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:55:47 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-09-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:56:05 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:56:05 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:56:05 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:56:05 UTC] DEBUG - Consulta SQL ejecutada: 
            SELECT 
                cr.fecha,
                cr.nro_caballo,
                COALESCE(SUM(dt.total_apostado), 0) as total_apostado,
                COALESCE(SUM(CASE WHEN crd.devolucion = 0 THEN dt.total_apostado ELSE 0 END), 0) as monto_a_devolver,
                COALESCE(SUM(CASE WHEN crd.devolucion = 1 THEN dt.total_apostado ELSE 0 END), 0) as monto_devuelto,
                CASE 
                    WHEN SUM(dt.total_apostado) IS NULL OR SUM(dt.total_apostado) = 0 THEN 'Sin Apuestas'
                    WHEN SUM(CASE WHEN crd.devolucion = 0 THEN 1 ELSE 0 END) > 0 
                         AND SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Parcial'
                    WHEN SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Devuelto'
                    ELSE 'Pendiente'
                END as estado_devolucion
            FROM 
                tbl_caballos_retirados_ultimo_momento cr
            LEFT JOIN 
                tbl_caballos_retirados_um_detalle crd ON cr.id_caballo_retirado_ultimo_momento = crd.id_caballo_retirado_ultimo_momento
            LEFT JOIN 
                tbl_detalle_tickets dt ON crd.id_detalle_ticket = dt.id_detalle_ticket
            WHERE 1=1
            AND cr.fecha >= :fecha_desde AND cr.fecha <= :fecha_hasta
            GROUP BY
                cr.fecha, cr.nro_caballo, cr.id_carrera
            ORDER BY
                cr.fecha DESC, cr.nro_caballo ASC
            LIMIT :limit OFFSET :offset
        
[01-Oct-2025 22:56:05 UTC] DEBUG - Parámetros: {":fecha_desde":"2025-09-01",":fecha_hasta":"2025-10-01",":limit":50,":offset":0}
[01-Oct-2025 22:56:05 UTC] DEBUG - Registros obtenidos: 0 de 0 totales
[01-Oct-2025 22:56:19 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:56:19 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:56:19 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:56:19 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-09-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 22:57:23 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:57:23 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 22:57:23 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 22:57:23 UTC] DEBUG - Consulta SQL ejecutada: 
            SELECT 
                cr.fecha,
                cr.nro_caballo,
                COALESCE(SUM(dt.total_apostado), 0) as total_apostado,
                COALESCE(SUM(CASE WHEN crd.devolucion = 0 THEN dt.total_apostado ELSE 0 END), 0) as monto_a_devolver,
                COALESCE(SUM(CASE WHEN crd.devolucion = 1 THEN dt.total_apostado ELSE 0 END), 0) as monto_devuelto,
                CASE 
                    WHEN SUM(dt.total_apostado) IS NULL OR SUM(dt.total_apostado) = 0 THEN 'Sin Apuestas'
                    WHEN SUM(CASE WHEN crd.devolucion = 0 THEN 1 ELSE 0 END) > 0 
                         AND SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Parcial'
                    WHEN SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Devuelto'
                    ELSE 'Pendiente'
                END as estado_devolucion
            FROM 
                tbl_caballos_retirados_ultimo_momento cr
            LEFT JOIN 
                tbl_caballos_retirados_um_detalle crd ON cr.id_caballo_retirado_ultimo_momento = crd.id_caballo_retirado_ultimo_momento
            LEFT JOIN 
                tbl_detalle_tickets dt ON crd.id_detalle_ticket = dt.id_detalle_ticket
            WHERE 1=1
            AND cr.fecha >= :fecha_desde AND cr.fecha <= :fecha_hasta
            GROUP BY
                cr.fecha, cr.nro_caballo, cr.id_carrera
            ORDER BY
                cr.fecha DESC, cr.nro_caballo ASC
            LIMIT :limit OFFSET :offset
        
[01-Oct-2025 22:57:23 UTC] DEBUG - Parámetros: {":fecha_desde":"2025-05-01",":fecha_hasta":"2025-10-01",":limit":50,":offset":0}
[01-Oct-2025 22:57:23 UTC] DEBUG - Registros obtenidos: 16 de 16 totales
[01-Oct-2025 22:57:23 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[01-Oct-2025 22:57:23 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[01-Oct-2025 22:57:23 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[01-Oct-2025 22:57:23 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[01-Oct-2025 22:57:23 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[01-Oct-2025 22:57:23 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[01-Oct-2025 22:57:23 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[01-Oct-2025 22:57:23 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[01-Oct-2025 22:57:23 UTC] DEBUG formatearFecha - Input: '2025-07-15' (tipo: string)
[01-Oct-2025 22:57:23 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-15 -> 15/07/2025
[01-Oct-2025 22:57:23 UTC] DEBUG formatearFecha - Input: '2025-07-14' (tipo: string)
[01-Oct-2025 22:57:23 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-14 -> 14/07/2025
[01-Oct-2025 22:57:23 UTC] DEBUG formatearFecha - Input: '2025-07-11' (tipo: string)
[01-Oct-2025 22:57:23 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-11 -> 11/07/2025
[01-Oct-2025 22:57:23 UTC] DEBUG formatearFecha - Input: '2025-07-10' (tipo: string)
[01-Oct-2025 22:57:23 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-10 -> 10/07/2025
[01-Oct-2025 22:57:23 UTC] DEBUG formatearFecha - Input: '2025-07-08' (tipo: string)
[01-Oct-2025 22:57:23 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-08 -> 08/07/2025
[01-Oct-2025 22:57:23 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[01-Oct-2025 22:57:23 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[01-Oct-2025 22:57:23 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[01-Oct-2025 22:57:23 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[01-Oct-2025 22:57:23 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[01-Oct-2025 22:57:23 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[01-Oct-2025 22:57:23 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[01-Oct-2025 22:57:23 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[01-Oct-2025 22:57:23 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[01-Oct-2025 22:57:23 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[01-Oct-2025 22:57:23 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[01-Oct-2025 22:57:23 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[01-Oct-2025 22:57:23 UTC] DEBUG formatearFecha - Input: '2025-06-27' (tipo: string)
[01-Oct-2025 22:57:23 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-06-27 -> 27/06/2025
[01-Oct-2025 23:01:37 UTC] PHP Fatal error:  Uncaught Error: Call to undefined method TurfReports\Controllers\AuthController::verify() in /var/www/html/Routes/api.php:121
Stack trace:
#0 {main}
  thrown in /var/www/html/Routes/api.php on line 121
[01-Oct-2025 23:01:38 UTC] DEBUG Login - Usuario encontrado: SÍ
[01-Oct-2025 23:01:38 UTC] DEBUG Login - Login BD: carreras2024
[01-Oct-2025 23:01:38 UTC] DEBUG Login - Login enviado: carreras2024
[01-Oct-2025 23:01:38 UTC] DEBUG Login - Contraseña BD: 0192023a7bbd73250516f069df18b500
[01-Oct-2025 23:01:38 UTC] DEBUG Login - Contraseña enviada: admin123
[01-Oct-2025 23:01:38 UTC] DEBUG Login - Contraseña MD5: 0192023a7bbd73250516f069df18b500
[01-Oct-2025 23:01:38 UTC] DEBUG Login - Coinciden MD5: SÍ
[01-Oct-2025 23:01:38 UTC] DEBUG Login - id_perfil: 1 (tipo: integer)
[01-Oct-2025 23:01:38 UTC] DEBUG Login - Rol asignado: admin
[01-Oct-2025 23:01:38 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:01:38 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 23:01:38 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:01:39 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:01:39 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 23:01:39 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:01:39 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-09-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 23:01:40 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:01:40 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 23:01:40 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:01:40 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-09-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 23:10:05 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:10:05 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 23:10:05 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:10:05 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-09-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 23:10:06 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:10:06 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 23:10:06 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:10:06 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-09-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 23:10:13 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:10:13 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 23:10:13 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:10:13 UTC] DEBUG - Consulta SQL ejecutada: 
            SELECT 
                cr.fecha,
                cr.nro_caballo,
                COALESCE(SUM(dt.total_apostado), 0) as total_apostado,
                COALESCE(SUM(CASE WHEN crd.devolucion = 0 THEN dt.total_apostado ELSE 0 END), 0) as monto_a_devolver,
                COALESCE(SUM(CASE WHEN crd.devolucion = 1 THEN dt.total_apostado ELSE 0 END), 0) as monto_devuelto,
                CASE 
                    WHEN SUM(dt.total_apostado) IS NULL OR SUM(dt.total_apostado) = 0 THEN 'Sin Apuestas'
                    WHEN SUM(CASE WHEN crd.devolucion = 0 THEN 1 ELSE 0 END) > 0 
                         AND SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Parcial'
                    WHEN SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Devuelto'
                    ELSE 'Pendiente'
                END as estado_devolucion
            FROM 
                tbl_caballos_retirados_ultimo_momento cr
            LEFT JOIN 
                tbl_caballos_retirados_um_detalle crd ON cr.id_caballo_retirado_ultimo_momento = crd.id_caballo_retirado_ultimo_momento
            LEFT JOIN 
                tbl_detalle_tickets dt ON crd.id_detalle_ticket = dt.id_detalle_ticket
            WHERE 1=1
            AND cr.fecha >= :fecha_desde AND cr.fecha <= :fecha_hasta
            GROUP BY
                cr.fecha, cr.nro_caballo, cr.id_carrera
            ORDER BY
                cr.fecha DESC, cr.nro_caballo ASC
            LIMIT :limit OFFSET :offset
        
[01-Oct-2025 23:10:13 UTC] DEBUG - Parámetros: {":fecha_desde":"2025-09-01",":fecha_hasta":"2025-10-01",":limit":50,":offset":0}
[01-Oct-2025 23:10:13 UTC] DEBUG - Registros obtenidos: 0 de 0 totales
[01-Oct-2025 23:10:15 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:10:15 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 23:10:15 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:10:15 UTC] DEBUG - Consulta SQL ejecutada: 
            SELECT 
                cr.fecha,
                cr.nro_caballo,
                COALESCE(SUM(dt.total_apostado), 0) as total_apostado,
                COALESCE(SUM(CASE WHEN crd.devolucion = 0 THEN dt.total_apostado ELSE 0 END), 0) as monto_a_devolver,
                COALESCE(SUM(CASE WHEN crd.devolucion = 1 THEN dt.total_apostado ELSE 0 END), 0) as monto_devuelto,
                CASE 
                    WHEN SUM(dt.total_apostado) IS NULL OR SUM(dt.total_apostado) = 0 THEN 'Sin Apuestas'
                    WHEN SUM(CASE WHEN crd.devolucion = 0 THEN 1 ELSE 0 END) > 0 
                         AND SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Parcial'
                    WHEN SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Devuelto'
                    ELSE 'Pendiente'
                END as estado_devolucion
            FROM 
                tbl_caballos_retirados_ultimo_momento cr
            LEFT JOIN 
                tbl_caballos_retirados_um_detalle crd ON cr.id_caballo_retirado_ultimo_momento = crd.id_caballo_retirado_ultimo_momento
            LEFT JOIN 
                tbl_detalle_tickets dt ON crd.id_detalle_ticket = dt.id_detalle_ticket
            WHERE 1=1
            AND cr.fecha >= :fecha_desde AND cr.fecha <= :fecha_hasta
            GROUP BY
                cr.fecha, cr.nro_caballo, cr.id_carrera
            ORDER BY
                cr.fecha DESC, cr.nro_caballo ASC
            LIMIT :limit OFFSET :offset
        
[01-Oct-2025 23:10:15 UTC] DEBUG - Parámetros: {":fecha_desde":"2025-09-01",":fecha_hasta":"2025-10-01",":limit":50,":offset":0}
[01-Oct-2025 23:10:15 UTC] DEBUG - Registros obtenidos: 0 de 0 totales
[01-Oct-2025 23:10:20 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:10:20 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 23:10:20 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:10:20 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-09-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 23:10:23 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:10:23 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 23:10:23 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:10:23 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-09-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 23:10:29 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:10:29 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 23:10:29 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:10:29 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 23:10:30 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:10:30 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 23:10:30 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:10:30 UTC] DEBUG - Consulta SQL ejecutada: 
            SELECT 
                cr.fecha,
                cr.nro_caballo,
                COALESCE(SUM(dt.total_apostado), 0) as total_apostado,
                COALESCE(SUM(CASE WHEN crd.devolucion = 0 THEN dt.total_apostado ELSE 0 END), 0) as monto_a_devolver,
                COALESCE(SUM(CASE WHEN crd.devolucion = 1 THEN dt.total_apostado ELSE 0 END), 0) as monto_devuelto,
                CASE 
                    WHEN SUM(dt.total_apostado) IS NULL OR SUM(dt.total_apostado) = 0 THEN 'Sin Apuestas'
                    WHEN SUM(CASE WHEN crd.devolucion = 0 THEN 1 ELSE 0 END) > 0 
                         AND SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Parcial'
                    WHEN SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Devuelto'
                    ELSE 'Pendiente'
                END as estado_devolucion
            FROM 
                tbl_caballos_retirados_ultimo_momento cr
            LEFT JOIN 
                tbl_caballos_retirados_um_detalle crd ON cr.id_caballo_retirado_ultimo_momento = crd.id_caballo_retirado_ultimo_momento
            LEFT JOIN 
                tbl_detalle_tickets dt ON crd.id_detalle_ticket = dt.id_detalle_ticket
            WHERE 1=1
            AND cr.fecha >= :fecha_desde AND cr.fecha <= :fecha_hasta
            GROUP BY
                cr.fecha, cr.nro_caballo, cr.id_carrera
            ORDER BY
                cr.fecha DESC, cr.nro_caballo ASC
            LIMIT :limit OFFSET :offset
        
[01-Oct-2025 23:10:30 UTC] DEBUG - Parámetros: {":fecha_desde":"2025-05-01",":fecha_hasta":"2025-10-01",":limit":50,":offset":0}
[01-Oct-2025 23:10:30 UTC] DEBUG - Registros obtenidos: 16 de 16 totales
[01-Oct-2025 23:10:30 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[01-Oct-2025 23:10:30 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[01-Oct-2025 23:10:30 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[01-Oct-2025 23:10:30 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[01-Oct-2025 23:10:30 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[01-Oct-2025 23:10:30 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[01-Oct-2025 23:10:30 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[01-Oct-2025 23:10:30 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[01-Oct-2025 23:10:30 UTC] DEBUG formatearFecha - Input: '2025-07-15' (tipo: string)
[01-Oct-2025 23:10:30 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-15 -> 15/07/2025
[01-Oct-2025 23:10:30 UTC] DEBUG formatearFecha - Input: '2025-07-14' (tipo: string)
[01-Oct-2025 23:10:30 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-14 -> 14/07/2025
[01-Oct-2025 23:10:30 UTC] DEBUG formatearFecha - Input: '2025-07-11' (tipo: string)
[01-Oct-2025 23:10:30 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-11 -> 11/07/2025
[01-Oct-2025 23:10:30 UTC] DEBUG formatearFecha - Input: '2025-07-10' (tipo: string)
[01-Oct-2025 23:10:30 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-10 -> 10/07/2025
[01-Oct-2025 23:10:30 UTC] DEBUG formatearFecha - Input: '2025-07-08' (tipo: string)
[01-Oct-2025 23:10:30 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-08 -> 08/07/2025
[01-Oct-2025 23:10:30 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[01-Oct-2025 23:10:30 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[01-Oct-2025 23:10:30 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[01-Oct-2025 23:10:30 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[01-Oct-2025 23:10:30 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[01-Oct-2025 23:10:30 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[01-Oct-2025 23:10:30 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[01-Oct-2025 23:10:30 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[01-Oct-2025 23:10:30 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[01-Oct-2025 23:10:30 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[01-Oct-2025 23:10:30 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[01-Oct-2025 23:10:30 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[01-Oct-2025 23:10:30 UTC] DEBUG formatearFecha - Input: '2025-06-27' (tipo: string)
[01-Oct-2025 23:10:30 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-06-27 -> 27/06/2025
[01-Oct-2025 23:10:31 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:10:31 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 23:10:31 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:10:31 UTC] Acceso a reporte: usuario=1, reporte=informe-por-agencia, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 23:10:34 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:10:34 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 23:10:34 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:10:34 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 23:10:36 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:10:36 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 23:10:36 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:10:36 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 23:10:37 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:10:37 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 23:10:37 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:10:37 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 23:10:37 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:10:37 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 23:10:37 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:10:37 UTC] Acceso a reporte: usuario=1, reporte=informe-por-agencia, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 23:10:37 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:10:37 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 23:10:37 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:10:37 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 23:10:38 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:10:38 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 23:10:38 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:10:38 UTC] Acceso a reporte: usuario=1, reporte=informe-por-agencia, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 23:10:38 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:10:38 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 23:10:38 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:10:38 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 23:10:39 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:10:39 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 23:10:39 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:10:39 UTC] Acceso a reporte: usuario=1, reporte=informe-por-agencia, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 23:10:39 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:10:39 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 23:10:39 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:10:39 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 23:10:40 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:10:40 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 23:10:40 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:10:40 UTC] Acceso a reporte: usuario=1, reporte=informe-por-agencia, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 23:10:40 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:10:40 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 23:10:40 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:10:40 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 23:23:51 UTC] PHP Fatal error:  Uncaught Error: Call to undefined method TurfReports\Controllers\AuthController::verify() in /var/www/html/Routes/api.php:121
Stack trace:
#0 {main}
  thrown in /var/www/html/Routes/api.php on line 121
[01-Oct-2025 23:27:12 UTC] DEBUG Login - Usuario encontrado: SÍ
[01-Oct-2025 23:27:12 UTC] DEBUG Login - Login BD: carreras2024
[01-Oct-2025 23:27:12 UTC] DEBUG Login - Login enviado: carreras2024
[01-Oct-2025 23:27:12 UTC] DEBUG Login - Contraseña BD: 0192023a7bbd73250516f069df18b500
[01-Oct-2025 23:27:12 UTC] DEBUG Login - Contraseña enviada: admin123
[01-Oct-2025 23:27:12 UTC] DEBUG Login - Contraseña MD5: 0192023a7bbd73250516f069df18b500
[01-Oct-2025 23:27:12 UTC] DEBUG Login - Coinciden MD5: SÍ
[01-Oct-2025 23:27:12 UTC] DEBUG Login - id_perfil: 1 (tipo: integer)
[01-Oct-2025 23:27:12 UTC] DEBUG Login - Rol asignado: admin
[01-Oct-2025 23:27:13 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:27:13 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 23:27:13 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:27:13 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:27:13 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 23:27:13 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:27:13 UTC] DEBUG - Consulta SQL ejecutada: 
            SELECT 
                cr.fecha,
                cr.nro_caballo,
                COALESCE(SUM(dt.total_apostado), 0) as total_apostado,
                COALESCE(SUM(CASE WHEN crd.devolucion = 0 THEN dt.total_apostado ELSE 0 END), 0) as monto_a_devolver,
                COALESCE(SUM(CASE WHEN crd.devolucion = 1 THEN dt.total_apostado ELSE 0 END), 0) as monto_devuelto,
                CASE 
                    WHEN SUM(dt.total_apostado) IS NULL OR SUM(dt.total_apostado) = 0 THEN 'Sin Apuestas'
                    WHEN SUM(CASE WHEN crd.devolucion = 0 THEN 1 ELSE 0 END) > 0 
                         AND SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Parcial'
                    WHEN SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Devuelto'
                    ELSE 'Pendiente'
                END as estado_devolucion
            FROM 
                tbl_caballos_retirados_ultimo_momento cr
            LEFT JOIN 
                tbl_caballos_retirados_um_detalle crd ON cr.id_caballo_retirado_ultimo_momento = crd.id_caballo_retirado_ultimo_momento
            LEFT JOIN 
                tbl_detalle_tickets dt ON crd.id_detalle_ticket = dt.id_detalle_ticket
            WHERE 1=1
            AND cr.fecha >= :fecha_desde AND cr.fecha <= :fecha_hasta
            GROUP BY
                cr.fecha, cr.nro_caballo, cr.id_carrera
            ORDER BY
                cr.fecha DESC, cr.nro_caballo ASC
            LIMIT :limit OFFSET :offset
        
[01-Oct-2025 23:27:13 UTC] DEBUG - Parámetros: {":fecha_desde":"2025-09-01",":fecha_hasta":"2025-10-01",":limit":50,":offset":0}
[01-Oct-2025 23:27:13 UTC] DEBUG - Registros obtenidos: 0 de 0 totales
[01-Oct-2025 23:27:13 UTC] DEBUG getCaballosRetirados - Totals raw: {"total_records":0,"total_a_devolver":0,"total_devuelto":0,"total_general":0}
[01-Oct-2025 23:27:13 UTC] DEBUG getCaballosRetirados - Resultado final: {"data":[],"total_records":0,"total_general":0,"total_a_devolver":0,"total_devuelto":0}
[01-Oct-2025 23:27:13 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:27:13 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 23:27:13 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:27:13 UTC] DEBUG getListaTickets - Summary raw: {"total_vendido":null,"total_ganadores":null,"total_pagados":null,"total_devoluciones":0}
[01-Oct-2025 23:27:13 UTC] DEBUG getListaTickets - Resultado final: {"total_vendido":0,"total_ganadores":0,"total_pagados":0,"total_devoluciones":0,"ganancia":0}
[01-Oct-2025 23:27:13 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-09-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 23:27:15 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:27:15 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 23:27:15 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:27:15 UTC] DEBUG getListaTickets - Summary raw: {"total_vendido":639780,"total_ganadores":181030.4999847412,"total_pagados":79787.19999694824,"total_devoluciones":0}
[01-Oct-2025 23:27:15 UTC] DEBUG getListaTickets - Resultado final: {"total_vendido":639780,"total_ganadores":181030.4999847412,"total_pagados":79787.19999694824,"total_devoluciones":0,"ganancia":559992.8000030518}
[01-Oct-2025 23:27:15 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 23:27:16 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:27:16 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 23:27:16 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:27:16 UTC] DEBUG - Consulta SQL ejecutada: 
            SELECT 
                cr.fecha,
                cr.nro_caballo,
                COALESCE(SUM(dt.total_apostado), 0) as total_apostado,
                COALESCE(SUM(CASE WHEN crd.devolucion = 0 THEN dt.total_apostado ELSE 0 END), 0) as monto_a_devolver,
                COALESCE(SUM(CASE WHEN crd.devolucion = 1 THEN dt.total_apostado ELSE 0 END), 0) as monto_devuelto,
                CASE 
                    WHEN SUM(dt.total_apostado) IS NULL OR SUM(dt.total_apostado) = 0 THEN 'Sin Apuestas'
                    WHEN SUM(CASE WHEN crd.devolucion = 0 THEN 1 ELSE 0 END) > 0 
                         AND SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Parcial'
                    WHEN SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Devuelto'
                    ELSE 'Pendiente'
                END as estado_devolucion
            FROM 
                tbl_caballos_retirados_ultimo_momento cr
            LEFT JOIN 
                tbl_caballos_retirados_um_detalle crd ON cr.id_caballo_retirado_ultimo_momento = crd.id_caballo_retirado_ultimo_momento
            LEFT JOIN 
                tbl_detalle_tickets dt ON crd.id_detalle_ticket = dt.id_detalle_ticket
            WHERE 1=1
            AND cr.fecha >= :fecha_desde AND cr.fecha <= :fecha_hasta
            GROUP BY
                cr.fecha, cr.nro_caballo, cr.id_carrera
            ORDER BY
                cr.fecha DESC, cr.nro_caballo ASC
            LIMIT :limit OFFSET :offset
        
[01-Oct-2025 23:27:16 UTC] DEBUG - Parámetros: {":fecha_desde":"2025-05-01",":fecha_hasta":"2025-10-01",":limit":50,":offset":0}
[01-Oct-2025 23:27:16 UTC] DEBUG - Registros obtenidos: 16 de 16 totales
[01-Oct-2025 23:27:16 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[01-Oct-2025 23:27:16 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[01-Oct-2025 23:27:16 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[01-Oct-2025 23:27:16 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[01-Oct-2025 23:27:16 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[01-Oct-2025 23:27:16 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[01-Oct-2025 23:27:16 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[01-Oct-2025 23:27:16 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[01-Oct-2025 23:27:16 UTC] DEBUG formatearFecha - Input: '2025-07-15' (tipo: string)
[01-Oct-2025 23:27:16 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-15 -> 15/07/2025
[01-Oct-2025 23:27:16 UTC] DEBUG formatearFecha - Input: '2025-07-14' (tipo: string)
[01-Oct-2025 23:27:16 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-14 -> 14/07/2025
[01-Oct-2025 23:27:16 UTC] DEBUG formatearFecha - Input: '2025-07-11' (tipo: string)
[01-Oct-2025 23:27:16 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-11 -> 11/07/2025
[01-Oct-2025 23:27:16 UTC] DEBUG formatearFecha - Input: '2025-07-10' (tipo: string)
[01-Oct-2025 23:27:16 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-10 -> 10/07/2025
[01-Oct-2025 23:27:16 UTC] DEBUG formatearFecha - Input: '2025-07-08' (tipo: string)
[01-Oct-2025 23:27:16 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-08 -> 08/07/2025
[01-Oct-2025 23:27:16 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[01-Oct-2025 23:27:16 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[01-Oct-2025 23:27:16 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[01-Oct-2025 23:27:16 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[01-Oct-2025 23:27:16 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[01-Oct-2025 23:27:16 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[01-Oct-2025 23:27:16 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[01-Oct-2025 23:27:16 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[01-Oct-2025 23:27:16 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[01-Oct-2025 23:27:16 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[01-Oct-2025 23:27:16 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[01-Oct-2025 23:27:16 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[01-Oct-2025 23:27:16 UTC] DEBUG formatearFecha - Input: '2025-06-27' (tipo: string)
[01-Oct-2025 23:27:16 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-06-27 -> 27/06/2025
[01-Oct-2025 23:27:16 UTC] DEBUG getCaballosRetirados - Totals raw: {"total_records":16,"total_a_devolver":45310,"total_devuelto":5300,"total_general":50610}
[01-Oct-2025 23:27:16 UTC] DEBUG getCaballosRetirados - Resultado final: {"data":[{"fecha":"29\/07\/2025","nro_caballo":1,"total_apostado":2200,"monto_a_devolver":2200,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"29\/07\/2025","nro_caballo":6,"total_apostado":2000,"monto_a_devolver":2000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"17\/07\/2025","nro_caballo":1,"total_apostado":16000,"monto_a_devolver":16000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"17\/07\/2025","nro_caballo":8,"total_apostado":8000,"monto_a_devolver":8000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"15\/07\/2025","nro_caballo":1,"total_apostado":4000,"monto_a_devolver":4000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"14\/07\/2025","nro_caballo":4,"total_apostado":13000,"monto_a_devolver":13000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"11\/07\/2025","nro_caballo":4,"total_apostado":4000,"monto_a_devolver":0,"monto_devuelto":4000,"estado_devolucion":"Devuelto"},{"fecha":"10\/07\/2025","nro_caballo":7,"total_apostado":800,"monto_a_devolver":0,"monto_devuelto":800,"estado_devolucion":"Devuelto"},{"fecha":"08\/07\/2025","nro_caballo":7,"total_apostado":410,"monto_a_devolver":110,"monto_devuelto":300,"estado_devolucion":"Parcial"},{"fecha":"04\/07\/2025","nro_caballo":1,"total_apostado":100,"monto_a_devolver":0,"monto_devuelto":100,"estado_devolucion":"Devuelto"},{"fecha":"04\/07\/2025","nro_caballo":6,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"02\/07\/2025","nro_caballo":4,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"02\/07\/2025","nro_caballo":8,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"01\/07\/2025","nro_caballo":1,"total_apostado":100,"monto_a_devolver":0,"monto_devuelto":100,"estado_devolucion":"Devuelto"},{"fecha":"01\/07\/2025","nro_caballo":4,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"27\/06\/2025","nro_caballo":12,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"}],"total_records":16,"total_general":50610,"total_a_devolver":45310,"total_devuelto":5300}
[01-Oct-2025 23:27:17 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:27:17 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 23:27:17 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:27:17 UTC] DEBUG - Consulta SQL ejecutada: 
            SELECT 
                cr.fecha,
                cr.nro_caballo,
                COALESCE(SUM(dt.total_apostado), 0) as total_apostado,
                COALESCE(SUM(CASE WHEN crd.devolucion = 0 THEN dt.total_apostado ELSE 0 END), 0) as monto_a_devolver,
                COALESCE(SUM(CASE WHEN crd.devolucion = 1 THEN dt.total_apostado ELSE 0 END), 0) as monto_devuelto,
                CASE 
                    WHEN SUM(dt.total_apostado) IS NULL OR SUM(dt.total_apostado) = 0 THEN 'Sin Apuestas'
                    WHEN SUM(CASE WHEN crd.devolucion = 0 THEN 1 ELSE 0 END) > 0 
                         AND SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Parcial'
                    WHEN SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Devuelto'
                    ELSE 'Pendiente'
                END as estado_devolucion
            FROM 
                tbl_caballos_retirados_ultimo_momento cr
            LEFT JOIN 
                tbl_caballos_retirados_um_detalle crd ON cr.id_caballo_retirado_ultimo_momento = crd.id_caballo_retirado_ultimo_momento
            LEFT JOIN 
                tbl_detalle_tickets dt ON crd.id_detalle_ticket = dt.id_detalle_ticket
            WHERE 1=1
            AND cr.fecha >= :fecha_desde AND cr.fecha <= :fecha_hasta
            GROUP BY
                cr.fecha, cr.nro_caballo, cr.id_carrera
            ORDER BY
                cr.fecha DESC, cr.nro_caballo ASC
            LIMIT :limit OFFSET :offset
        
[01-Oct-2025 23:27:17 UTC] DEBUG - Parámetros: {":fecha_desde":"2025-05-01",":fecha_hasta":"2025-10-01",":limit":50,":offset":0}
[01-Oct-2025 23:27:17 UTC] DEBUG - Registros obtenidos: 16 de 16 totales
[01-Oct-2025 23:27:17 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[01-Oct-2025 23:27:17 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[01-Oct-2025 23:27:17 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[01-Oct-2025 23:27:17 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[01-Oct-2025 23:27:17 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[01-Oct-2025 23:27:17 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[01-Oct-2025 23:27:17 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[01-Oct-2025 23:27:17 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[01-Oct-2025 23:27:17 UTC] DEBUG formatearFecha - Input: '2025-07-15' (tipo: string)
[01-Oct-2025 23:27:17 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-15 -> 15/07/2025
[01-Oct-2025 23:27:17 UTC] DEBUG formatearFecha - Input: '2025-07-14' (tipo: string)
[01-Oct-2025 23:27:17 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-14 -> 14/07/2025
[01-Oct-2025 23:27:17 UTC] DEBUG formatearFecha - Input: '2025-07-11' (tipo: string)
[01-Oct-2025 23:27:17 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-11 -> 11/07/2025
[01-Oct-2025 23:27:17 UTC] DEBUG formatearFecha - Input: '2025-07-10' (tipo: string)
[01-Oct-2025 23:27:17 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-10 -> 10/07/2025
[01-Oct-2025 23:27:17 UTC] DEBUG formatearFecha - Input: '2025-07-08' (tipo: string)
[01-Oct-2025 23:27:17 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-08 -> 08/07/2025
[01-Oct-2025 23:27:17 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[01-Oct-2025 23:27:17 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[01-Oct-2025 23:27:17 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[01-Oct-2025 23:27:17 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[01-Oct-2025 23:27:17 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[01-Oct-2025 23:27:17 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[01-Oct-2025 23:27:17 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[01-Oct-2025 23:27:17 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[01-Oct-2025 23:27:17 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[01-Oct-2025 23:27:17 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[01-Oct-2025 23:27:17 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[01-Oct-2025 23:27:17 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[01-Oct-2025 23:27:17 UTC] DEBUG formatearFecha - Input: '2025-06-27' (tipo: string)
[01-Oct-2025 23:27:17 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-06-27 -> 27/06/2025
[01-Oct-2025 23:27:17 UTC] DEBUG getCaballosRetirados - Totals raw: {"total_records":16,"total_a_devolver":45310,"total_devuelto":5300,"total_general":50610}
[01-Oct-2025 23:27:17 UTC] DEBUG getCaballosRetirados - Resultado final: {"data":[{"fecha":"29\/07\/2025","nro_caballo":1,"total_apostado":2200,"monto_a_devolver":2200,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"29\/07\/2025","nro_caballo":6,"total_apostado":2000,"monto_a_devolver":2000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"17\/07\/2025","nro_caballo":1,"total_apostado":16000,"monto_a_devolver":16000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"17\/07\/2025","nro_caballo":8,"total_apostado":8000,"monto_a_devolver":8000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"15\/07\/2025","nro_caballo":1,"total_apostado":4000,"monto_a_devolver":4000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"14\/07\/2025","nro_caballo":4,"total_apostado":13000,"monto_a_devolver":13000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"11\/07\/2025","nro_caballo":4,"total_apostado":4000,"monto_a_devolver":0,"monto_devuelto":4000,"estado_devolucion":"Devuelto"},{"fecha":"10\/07\/2025","nro_caballo":7,"total_apostado":800,"monto_a_devolver":0,"monto_devuelto":800,"estado_devolucion":"Devuelto"},{"fecha":"08\/07\/2025","nro_caballo":7,"total_apostado":410,"monto_a_devolver":110,"monto_devuelto":300,"estado_devolucion":"Parcial"},{"fecha":"04\/07\/2025","nro_caballo":1,"total_apostado":100,"monto_a_devolver":0,"monto_devuelto":100,"estado_devolucion":"Devuelto"},{"fecha":"04\/07\/2025","nro_caballo":6,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"02\/07\/2025","nro_caballo":4,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"02\/07\/2025","nro_caballo":8,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"01\/07\/2025","nro_caballo":1,"total_apostado":100,"monto_a_devolver":0,"monto_devuelto":100,"estado_devolucion":"Devuelto"},{"fecha":"01\/07\/2025","nro_caballo":4,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"27\/06\/2025","nro_caballo":12,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"}],"total_records":16,"total_general":50610,"total_a_devolver":45310,"total_devuelto":5300}
[01-Oct-2025 23:27:18 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:27:18 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 23:27:18 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:27:18 UTC] DEBUG Tickets Anulados - Filtros recibidos: {"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 23:27:18 UTC] DEBUG Tickets Anulados - WHERE construido: AND STR_TO_DATE(t.fecha, '%d/%m/%Y') >= STR_TO_DATE(:fecha_desde, '%Y-%m-%d') AND STR_TO_DATE(t.fecha, '%d/%m/%Y') <= STR_TO_DATE(:fecha_hasta, '%Y-%m-%d')
[01-Oct-2025 23:27:18 UTC] DEBUG Tickets Anulados - Registros obtenidos: 12
[01-Oct-2025 23:27:18 UTC] DEBUG Tickets Anulados - Primer registro: {"nro_ticket":133,"fecha":"31\/07\/2025","hora":"10:01:20","nombre_usuario":"Agencia 24","nombre_agencia":"Morteros","total_apostado":10000}
[01-Oct-2025 23:27:18 UTC] DEBUG formatearFecha - Input: '31/07/2025' (tipo: string)
[01-Oct-2025 23:27:18 UTC] DEBUG formatearFecha - Ya en formato correcto: 31/07/2025
[01-Oct-2025 23:27:18 UTC] DEBUG formatearFecha - Input: '06/07/2025' (tipo: string)
[01-Oct-2025 23:27:18 UTC] DEBUG formatearFecha - Ya en formato correcto: 06/07/2025
[01-Oct-2025 23:27:18 UTC] DEBUG formatearFecha - Input: '05/07/2025' (tipo: string)
[01-Oct-2025 23:27:18 UTC] DEBUG formatearFecha - Ya en formato correcto: 05/07/2025
[01-Oct-2025 23:27:18 UTC] DEBUG formatearFecha - Input: '04/07/2025' (tipo: string)
[01-Oct-2025 23:27:18 UTC] DEBUG formatearFecha - Ya en formato correcto: 04/07/2025
[01-Oct-2025 23:27:18 UTC] DEBUG formatearFecha - Input: '02/07/2025' (tipo: string)
[01-Oct-2025 23:27:18 UTC] DEBUG formatearFecha - Ya en formato correcto: 02/07/2025
[01-Oct-2025 23:27:18 UTC] DEBUG formatearFecha - Input: '02/07/2025' (tipo: string)
[01-Oct-2025 23:27:18 UTC] DEBUG formatearFecha - Ya en formato correcto: 02/07/2025
[01-Oct-2025 23:27:18 UTC] DEBUG formatearFecha - Input: '02/07/2025' (tipo: string)
[01-Oct-2025 23:27:18 UTC] DEBUG formatearFecha - Ya en formato correcto: 02/07/2025
[01-Oct-2025 23:27:18 UTC] DEBUG formatearFecha - Input: '02/07/2025' (tipo: string)
[01-Oct-2025 23:27:18 UTC] DEBUG formatearFecha - Ya en formato correcto: 02/07/2025
[01-Oct-2025 23:27:18 UTC] DEBUG formatearFecha - Input: '01/07/2025' (tipo: string)
[01-Oct-2025 23:27:18 UTC] DEBUG formatearFecha - Ya en formato correcto: 01/07/2025
[01-Oct-2025 23:27:18 UTC] DEBUG formatearFecha - Input: '01/07/2025' (tipo: string)
[01-Oct-2025 23:27:18 UTC] DEBUG formatearFecha - Ya en formato correcto: 01/07/2025
[01-Oct-2025 23:27:18 UTC] DEBUG formatearFecha - Input: '01/07/2025' (tipo: string)
[01-Oct-2025 23:27:18 UTC] DEBUG formatearFecha - Ya en formato correcto: 01/07/2025
[01-Oct-2025 23:27:18 UTC] DEBUG formatearFecha - Input: '30/06/2025' (tipo: string)
[01-Oct-2025 23:27:18 UTC] DEBUG formatearFecha - Ya en formato correcto: 30/06/2025
[01-Oct-2025 23:27:18 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:27:18 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 23:27:18 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:27:18 UTC] DEBUG Carreras - Filtros recibidos: {"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 23:27:18 UTC] DEBUG Carreras - WHERE SQL: WHERE STR_TO_DATE(c.fecha, '%d/%m/%Y') >= STR_TO_DATE(:fecha_desde, '%Y-%m-%d') AND STR_TO_DATE(c.fecha, '%d/%m/%Y') <= STR_TO_DATE(:fecha_hasta, '%Y-%m-%d')
[01-Oct-2025 23:27:18 UTC] DEBUG Carreras - Parámetros: {":fecha_desde":"2025-05-01",":fecha_hasta":"2025-10-01"}
[01-Oct-2025 23:27:18 UTC] DEBUG Carreras - Registros obtenidos: 50
[01-Oct-2025 23:27:18 UTC] DEBUG Carreras - Primer registro: {"numero_carrera":1,"fecha":"31\/07\/2025","nombre_hipodromo":"San Isidro","estado_carrera":"Apuesta","carrera_interna_id":52}
[01-Oct-2025 23:27:19 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:27:19 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 23:27:19 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:27:19 UTC] Acceso a reporte: usuario=1, reporte=informe-por-agencia, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 23:27:20 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:27:20 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 23:27:20 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:27:20 UTC] DEBUG - Consulta SQL ejecutada: 
            SELECT 
                cr.fecha,
                cr.nro_caballo,
                COALESCE(SUM(dt.total_apostado), 0) as total_apostado,
                COALESCE(SUM(CASE WHEN crd.devolucion = 0 THEN dt.total_apostado ELSE 0 END), 0) as monto_a_devolver,
                COALESCE(SUM(CASE WHEN crd.devolucion = 1 THEN dt.total_apostado ELSE 0 END), 0) as monto_devuelto,
                CASE 
                    WHEN SUM(dt.total_apostado) IS NULL OR SUM(dt.total_apostado) = 0 THEN 'Sin Apuestas'
                    WHEN SUM(CASE WHEN crd.devolucion = 0 THEN 1 ELSE 0 END) > 0 
                         AND SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Parcial'
                    WHEN SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Devuelto'
                    ELSE 'Pendiente'
                END as estado_devolucion
            FROM 
                tbl_caballos_retirados_ultimo_momento cr
            LEFT JOIN 
                tbl_caballos_retirados_um_detalle crd ON cr.id_caballo_retirado_ultimo_momento = crd.id_caballo_retirado_ultimo_momento
            LEFT JOIN 
                tbl_detalle_tickets dt ON crd.id_detalle_ticket = dt.id_detalle_ticket
            WHERE 1=1
            AND cr.fecha >= :fecha_desde AND cr.fecha <= :fecha_hasta
            GROUP BY
                cr.fecha, cr.nro_caballo, cr.id_carrera
            ORDER BY
                cr.fecha DESC, cr.nro_caballo ASC
            LIMIT :limit OFFSET :offset
        
[01-Oct-2025 23:27:20 UTC] DEBUG - Parámetros: {":fecha_desde":"2025-05-01",":fecha_hasta":"2025-10-01",":limit":50,":offset":0}
[01-Oct-2025 23:27:20 UTC] DEBUG - Registros obtenidos: 16 de 16 totales
[01-Oct-2025 23:27:20 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[01-Oct-2025 23:27:20 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[01-Oct-2025 23:27:20 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[01-Oct-2025 23:27:20 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[01-Oct-2025 23:27:20 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[01-Oct-2025 23:27:20 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[01-Oct-2025 23:27:20 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[01-Oct-2025 23:27:20 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[01-Oct-2025 23:27:20 UTC] DEBUG formatearFecha - Input: '2025-07-15' (tipo: string)
[01-Oct-2025 23:27:20 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-15 -> 15/07/2025
[01-Oct-2025 23:27:20 UTC] DEBUG formatearFecha - Input: '2025-07-14' (tipo: string)
[01-Oct-2025 23:27:20 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-14 -> 14/07/2025
[01-Oct-2025 23:27:20 UTC] DEBUG formatearFecha - Input: '2025-07-11' (tipo: string)
[01-Oct-2025 23:27:20 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-11 -> 11/07/2025
[01-Oct-2025 23:27:20 UTC] DEBUG formatearFecha - Input: '2025-07-10' (tipo: string)
[01-Oct-2025 23:27:20 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-10 -> 10/07/2025
[01-Oct-2025 23:27:20 UTC] DEBUG formatearFecha - Input: '2025-07-08' (tipo: string)
[01-Oct-2025 23:27:20 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-08 -> 08/07/2025
[01-Oct-2025 23:27:20 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[01-Oct-2025 23:27:20 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[01-Oct-2025 23:27:20 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[01-Oct-2025 23:27:20 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[01-Oct-2025 23:27:20 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[01-Oct-2025 23:27:20 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[01-Oct-2025 23:27:20 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[01-Oct-2025 23:27:20 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[01-Oct-2025 23:27:20 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[01-Oct-2025 23:27:20 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[01-Oct-2025 23:27:20 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[01-Oct-2025 23:27:20 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[01-Oct-2025 23:27:20 UTC] DEBUG formatearFecha - Input: '2025-06-27' (tipo: string)
[01-Oct-2025 23:27:20 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-06-27 -> 27/06/2025
[01-Oct-2025 23:27:20 UTC] DEBUG getCaballosRetirados - Totals raw: {"total_records":16,"total_a_devolver":45310,"total_devuelto":5300,"total_general":50610}
[01-Oct-2025 23:27:20 UTC] DEBUG getCaballosRetirados - Resultado final: {"data":[{"fecha":"29\/07\/2025","nro_caballo":1,"total_apostado":2200,"monto_a_devolver":2200,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"29\/07\/2025","nro_caballo":6,"total_apostado":2000,"monto_a_devolver":2000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"17\/07\/2025","nro_caballo":1,"total_apostado":16000,"monto_a_devolver":16000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"17\/07\/2025","nro_caballo":8,"total_apostado":8000,"monto_a_devolver":8000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"15\/07\/2025","nro_caballo":1,"total_apostado":4000,"monto_a_devolver":4000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"14\/07\/2025","nro_caballo":4,"total_apostado":13000,"monto_a_devolver":13000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"11\/07\/2025","nro_caballo":4,"total_apostado":4000,"monto_a_devolver":0,"monto_devuelto":4000,"estado_devolucion":"Devuelto"},{"fecha":"10\/07\/2025","nro_caballo":7,"total_apostado":800,"monto_a_devolver":0,"monto_devuelto":800,"estado_devolucion":"Devuelto"},{"fecha":"08\/07\/2025","nro_caballo":7,"total_apostado":410,"monto_a_devolver":110,"monto_devuelto":300,"estado_devolucion":"Parcial"},{"fecha":"04\/07\/2025","nro_caballo":1,"total_apostado":100,"monto_a_devolver":0,"monto_devuelto":100,"estado_devolucion":"Devuelto"},{"fecha":"04\/07\/2025","nro_caballo":6,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"02\/07\/2025","nro_caballo":4,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"02\/07\/2025","nro_caballo":8,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"01\/07\/2025","nro_caballo":1,"total_apostado":100,"monto_a_devolver":0,"monto_devuelto":100,"estado_devolucion":"Devuelto"},{"fecha":"01\/07\/2025","nro_caballo":4,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"27\/06\/2025","nro_caballo":12,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"}],"total_records":16,"total_general":50610,"total_a_devolver":45310,"total_devuelto":5300}
[01-Oct-2025 23:31:09 UTC] PHP Fatal error:  Uncaught Error: Call to undefined method TurfReports\Controllers\AuthController::verify() in /var/www/html/Routes/api.php:121
Stack trace:
#0 {main}
  thrown in /var/www/html/Routes/api.php on line 121
[01-Oct-2025 23:31:59 UTC] DEBUG Login - Usuario encontrado: SÍ
[01-Oct-2025 23:31:59 UTC] DEBUG Login - Login BD: carreras2024
[01-Oct-2025 23:31:59 UTC] DEBUG Login - Login enviado: carreras2024
[01-Oct-2025 23:31:59 UTC] DEBUG Login - Contraseña BD: 0192023a7bbd73250516f069df18b500
[01-Oct-2025 23:31:59 UTC] DEBUG Login - Contraseña enviada: admin123
[01-Oct-2025 23:31:59 UTC] DEBUG Login - Contraseña MD5: 0192023a7bbd73250516f069df18b500
[01-Oct-2025 23:31:59 UTC] DEBUG Login - Coinciden MD5: SÍ
[01-Oct-2025 23:31:59 UTC] DEBUG Login - id_perfil: 1 (tipo: integer)
[01-Oct-2025 23:31:59 UTC] DEBUG Login - Rol asignado: admin
[01-Oct-2025 23:31:59 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:31:59 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 23:31:59 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:32:00 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:32:00 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 23:32:00 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:32:00 UTC] DEBUG Carreras - Filtros recibidos: {"fecha_desde":"2025-09-01","fecha_hasta":"2025-10-01","limit":50,"offset":0}
[01-Oct-2025 23:32:00 UTC] DEBUG Carreras - WHERE SQL: WHERE STR_TO_DATE(c.fecha, '%d/%m/%Y') >= STR_TO_DATE(:fecha_desde, '%Y-%m-%d') AND STR_TO_DATE(c.fecha, '%d/%m/%Y') <= STR_TO_DATE(:fecha_hasta, '%Y-%m-%d')
[01-Oct-2025 23:32:00 UTC] DEBUG Carreras - Parámetros: {":fecha_desde":"2025-09-01",":fecha_hasta":"2025-10-01"}
[01-Oct-2025 23:32:00 UTC] DEBUG Carreras - Registros obtenidos: 0
[01-Oct-2025 23:32:01 UTC] PHP Fatal error:  Uncaught Error: Call to undefined method TurfReports\Controllers\AuthController::verify() in /var/www/html/Routes/api.php:121
Stack trace:
#0 {main}
  thrown in /var/www/html/Routes/api.php on line 121
[01-Oct-2025 23:32:02 UTC] DEBUG Login - Usuario encontrado: SÍ
[01-Oct-2025 23:32:02 UTC] DEBUG Login - Login BD: carreras2024
[01-Oct-2025 23:32:02 UTC] DEBUG Login - Login enviado: carreras2024
[01-Oct-2025 23:32:02 UTC] DEBUG Login - Contraseña BD: 0192023a7bbd73250516f069df18b500
[01-Oct-2025 23:32:02 UTC] DEBUG Login - Contraseña enviada: admin123
[01-Oct-2025 23:32:02 UTC] DEBUG Login - Contraseña MD5: 0192023a7bbd73250516f069df18b500
[01-Oct-2025 23:32:02 UTC] DEBUG Login - Coinciden MD5: SÍ
[01-Oct-2025 23:32:02 UTC] DEBUG Login - id_perfil: 1 (tipo: integer)
[01-Oct-2025 23:32:02 UTC] DEBUG Login - Rol asignado: admin
[01-Oct-2025 23:32:02 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:32:02 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 23:32:02 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:32:03 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:32:03 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 23:32:03 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:32:03 UTC] DEBUG getListaTickets - Summary raw: {"total_vendido":null,"total_ganadores":null,"total_pagados":null,"total_devoluciones":0}
[01-Oct-2025 23:32:03 UTC] DEBUG getListaTickets - Resultado final: {"total_vendido":0,"total_ganadores":0,"total_pagados":0,"total_devoluciones":0,"ganancia":0}
[01-Oct-2025 23:32:03 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-09-01","fecha_hasta":"2025-10-01"}
[01-Oct-2025 23:32:03 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:32:03 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 23:32:03 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:32:03 UTC] DEBUG getListaTickets - Summary raw: {"total_vendido":null,"total_ganadores":null,"total_pagados":null,"total_devoluciones":0}
[01-Oct-2025 23:32:03 UTC] DEBUG getListaTickets - Resultado final: {"total_vendido":0,"total_ganadores":0,"total_pagados":0,"total_devoluciones":0,"ganancia":0}
[01-Oct-2025 23:32:03 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-09-01","fecha_hasta":"2025-10-01"}
[01-Oct-2025 23:32:03 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:32:03 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 23:32:03 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:32:03 UTC] DEBUG getListaTickets - Summary raw: {"total_vendido":null,"total_ganadores":null,"total_pagados":null,"total_devoluciones":0}
[01-Oct-2025 23:32:03 UTC] DEBUG getListaTickets - Resultado final: {"total_vendido":0,"total_ganadores":0,"total_pagados":0,"total_devoluciones":0,"ganancia":0}
[01-Oct-2025 23:32:03 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-09-01","fecha_hasta":"2025-10-01"}
[01-Oct-2025 23:32:03 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:32:03 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 23:32:03 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:32:03 UTC] DEBUG getListaTickets - Summary raw: {"total_vendido":null,"total_ganadores":null,"total_pagados":null,"total_devoluciones":0}
[01-Oct-2025 23:32:03 UTC] DEBUG getListaTickets - Resultado final: {"total_vendido":0,"total_ganadores":0,"total_pagados":0,"total_devoluciones":0,"ganancia":0}
[01-Oct-2025 23:32:03 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-09-01","fecha_hasta":"2025-10-01"}
[01-Oct-2025 23:32:08 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:32:08 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 23:32:08 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:32:08 UTC] DEBUG getListaTickets - Summary raw: {"total_vendido":639780,"total_ganadores":181030.4999847412,"total_pagados":79787.19999694824,"total_devoluciones":0}
[01-Oct-2025 23:32:08 UTC] DEBUG getListaTickets - Resultado final: {"total_vendido":639780,"total_ganadores":181030.4999847412,"total_pagados":79787.19999694824,"total_devoluciones":0,"ganancia":559992.8000030518}
[01-Oct-2025 23:32:08 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01"}
[01-Oct-2025 23:32:10 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:32:10 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 23:32:10 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:32:10 UTC] DEBUG getListaTickets - Summary raw: {"total_vendido":126200,"total_ganadores":12310,"total_pagados":7560,"total_devoluciones":0}
[01-Oct-2025 23:32:10 UTC] DEBUG getListaTickets - Resultado final: {"total_vendido":126200,"total_ganadores":12310,"total_pagados":7560,"total_devoluciones":0,"ganancia":118640}
[01-Oct-2025 23:32:10 UTC] Acceso a reporte: usuario=1, reporte=lista_tickets, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","agencia_id":3}
[01-Oct-2025 23:32:11 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:32:11 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 23:32:11 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:32:11 UTC] DEBUG - Consulta SQL ejecutada: 
            SELECT 
                cr.fecha,
                cr.nro_caballo,
                COALESCE(SUM(dt.total_apostado), 0) as total_apostado,
                COALESCE(SUM(CASE WHEN crd.devolucion = 0 THEN dt.total_apostado ELSE 0 END), 0) as monto_a_devolver,
                COALESCE(SUM(CASE WHEN crd.devolucion = 1 THEN dt.total_apostado ELSE 0 END), 0) as monto_devuelto,
                CASE 
                    WHEN SUM(dt.total_apostado) IS NULL OR SUM(dt.total_apostado) = 0 THEN 'Sin Apuestas'
                    WHEN SUM(CASE WHEN crd.devolucion = 0 THEN 1 ELSE 0 END) > 0 
                         AND SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Parcial'
                    WHEN SUM(CASE WHEN crd.devolucion = 1 THEN 1 ELSE 0 END) > 0 
                    THEN 'Devuelto'
                    ELSE 'Pendiente'
                END as estado_devolucion
            FROM 
                tbl_caballos_retirados_ultimo_momento cr
            LEFT JOIN 
                tbl_caballos_retirados_um_detalle crd ON cr.id_caballo_retirado_ultimo_momento = crd.id_caballo_retirado_ultimo_momento
            LEFT JOIN 
                tbl_detalle_tickets dt ON crd.id_detalle_ticket = dt.id_detalle_ticket
            WHERE 1=1
            AND cr.fecha >= :fecha_desde AND cr.fecha <= :fecha_hasta
            GROUP BY
                cr.fecha, cr.nro_caballo, cr.id_carrera
            ORDER BY
                cr.fecha DESC, cr.nro_caballo ASC
            LIMIT :limit OFFSET :offset
        
[01-Oct-2025 23:32:11 UTC] DEBUG - Parámetros: {":fecha_desde":"2025-05-01",":fecha_hasta":"2025-10-01",":limit":100,":offset":0}
[01-Oct-2025 23:32:11 UTC] DEBUG - Registros obtenidos: 16 de 16 totales
[01-Oct-2025 23:32:11 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[01-Oct-2025 23:32:11 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[01-Oct-2025 23:32:11 UTC] DEBUG formatearFecha - Input: '2025-07-29' (tipo: string)
[01-Oct-2025 23:32:11 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-29 -> 29/07/2025
[01-Oct-2025 23:32:11 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[01-Oct-2025 23:32:11 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[01-Oct-2025 23:32:11 UTC] DEBUG formatearFecha - Input: '2025-07-17' (tipo: string)
[01-Oct-2025 23:32:11 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-17 -> 17/07/2025
[01-Oct-2025 23:32:11 UTC] DEBUG formatearFecha - Input: '2025-07-15' (tipo: string)
[01-Oct-2025 23:32:11 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-15 -> 15/07/2025
[01-Oct-2025 23:32:11 UTC] DEBUG formatearFecha - Input: '2025-07-14' (tipo: string)
[01-Oct-2025 23:32:11 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-14 -> 14/07/2025
[01-Oct-2025 23:32:11 UTC] DEBUG formatearFecha - Input: '2025-07-11' (tipo: string)
[01-Oct-2025 23:32:11 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-11 -> 11/07/2025
[01-Oct-2025 23:32:11 UTC] DEBUG formatearFecha - Input: '2025-07-10' (tipo: string)
[01-Oct-2025 23:32:11 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-10 -> 10/07/2025
[01-Oct-2025 23:32:11 UTC] DEBUG formatearFecha - Input: '2025-07-08' (tipo: string)
[01-Oct-2025 23:32:11 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-08 -> 08/07/2025
[01-Oct-2025 23:32:11 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[01-Oct-2025 23:32:11 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[01-Oct-2025 23:32:11 UTC] DEBUG formatearFecha - Input: '2025-07-04' (tipo: string)
[01-Oct-2025 23:32:11 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-04 -> 04/07/2025
[01-Oct-2025 23:32:11 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[01-Oct-2025 23:32:11 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[01-Oct-2025 23:32:11 UTC] DEBUG formatearFecha - Input: '2025-07-02' (tipo: string)
[01-Oct-2025 23:32:11 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-02 -> 02/07/2025
[01-Oct-2025 23:32:11 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[01-Oct-2025 23:32:11 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[01-Oct-2025 23:32:11 UTC] DEBUG formatearFecha - Input: '2025-07-01' (tipo: string)
[01-Oct-2025 23:32:11 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-07-01 -> 01/07/2025
[01-Oct-2025 23:32:11 UTC] DEBUG formatearFecha - Input: '2025-06-27' (tipo: string)
[01-Oct-2025 23:32:11 UTC] DEBUG formatearFecha - Formato 'Y-m-d' funcionó: 2025-06-27 -> 27/06/2025
[01-Oct-2025 23:32:11 UTC] DEBUG getCaballosRetirados - Totals raw: {"total_records":16,"total_a_devolver":45310,"total_devuelto":5300,"total_general":50610}
[01-Oct-2025 23:32:11 UTC] DEBUG getCaballosRetirados - Resultado final: {"data":[{"fecha":"29\/07\/2025","nro_caballo":1,"total_apostado":2200,"monto_a_devolver":2200,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"29\/07\/2025","nro_caballo":6,"total_apostado":2000,"monto_a_devolver":2000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"17\/07\/2025","nro_caballo":1,"total_apostado":16000,"monto_a_devolver":16000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"17\/07\/2025","nro_caballo":8,"total_apostado":8000,"monto_a_devolver":8000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"15\/07\/2025","nro_caballo":1,"total_apostado":4000,"monto_a_devolver":4000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"14\/07\/2025","nro_caballo":4,"total_apostado":13000,"monto_a_devolver":13000,"monto_devuelto":0,"estado_devolucion":"Pendiente"},{"fecha":"11\/07\/2025","nro_caballo":4,"total_apostado":4000,"monto_a_devolver":0,"monto_devuelto":4000,"estado_devolucion":"Devuelto"},{"fecha":"10\/07\/2025","nro_caballo":7,"total_apostado":800,"monto_a_devolver":0,"monto_devuelto":800,"estado_devolucion":"Devuelto"},{"fecha":"08\/07\/2025","nro_caballo":7,"total_apostado":410,"monto_a_devolver":110,"monto_devuelto":300,"estado_devolucion":"Parcial"},{"fecha":"04\/07\/2025","nro_caballo":1,"total_apostado":100,"monto_a_devolver":0,"monto_devuelto":100,"estado_devolucion":"Devuelto"},{"fecha":"04\/07\/2025","nro_caballo":6,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"02\/07\/2025","nro_caballo":4,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"02\/07\/2025","nro_caballo":8,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"01\/07\/2025","nro_caballo":1,"total_apostado":100,"monto_a_devolver":0,"monto_devuelto":100,"estado_devolucion":"Devuelto"},{"fecha":"01\/07\/2025","nro_caballo":4,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"},{"fecha":"27\/06\/2025","nro_caballo":12,"total_apostado":0,"monto_a_devolver":0,"monto_devuelto":0,"estado_devolucion":"Sin Apuestas"}],"total_records":16,"total_general":50610,"total_a_devolver":45310,"total_devuelto":5300}
[01-Oct-2025 23:32:12 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:32:12 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 23:32:12 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:32:12 UTC] DEBUG Carreras - Filtros recibidos: {"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","agencia_id":3}
[01-Oct-2025 23:32:12 UTC] DEBUG Carreras - WHERE SQL: WHERE STR_TO_DATE(c.fecha, '%d/%m/%Y') >= STR_TO_DATE(:fecha_desde, '%Y-%m-%d') AND STR_TO_DATE(c.fecha, '%d/%m/%Y') <= STR_TO_DATE(:fecha_hasta, '%Y-%m-%d')
[01-Oct-2025 23:32:12 UTC] DEBUG Carreras - Parámetros: {":fecha_desde":"2025-05-01",":fecha_hasta":"2025-10-01"}
[01-Oct-2025 23:32:12 UTC] DEBUG Carreras - Registros obtenidos: 52
[01-Oct-2025 23:32:12 UTC] DEBUG Carreras - Primer registro: {"numero_carrera":1,"fecha":"31\/07\/2025","nombre_hipodromo":"San Isidro","estado_carrera":"Apuesta","carrera_interna_id":52}
[01-Oct-2025 23:32:12 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:32:12 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 23:32:12 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:32:12 UTC] DEBUG Tickets Anulados - Filtros recibidos: {"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","agencia_id":3}
[01-Oct-2025 23:32:12 UTC] DEBUG Tickets Anulados - WHERE construido: AND STR_TO_DATE(t.fecha, '%d/%m/%Y') >= STR_TO_DATE(:fecha_desde, '%Y-%m-%d') AND STR_TO_DATE(t.fecha, '%d/%m/%Y') <= STR_TO_DATE(:fecha_hasta, '%Y-%m-%d') AND u.id_agencia = :agencia_id
[01-Oct-2025 23:32:12 UTC] DEBUG Tickets Anulados - Registros obtenidos: 2
[01-Oct-2025 23:32:12 UTC] DEBUG Tickets Anulados - Primer registro: {"nro_ticket":27,"fecha":"02\/07\/2025","hora":"16:55:53","nombre_usuario":"Martin Cresp\u00edn","nombre_agencia":"C\u00f3rdoba","total_apostado":6600}
[01-Oct-2025 23:32:12 UTC] DEBUG formatearFecha - Input: '02/07/2025' (tipo: string)
[01-Oct-2025 23:32:12 UTC] DEBUG formatearFecha - Ya en formato correcto: 02/07/2025
[01-Oct-2025 23:32:12 UTC] DEBUG formatearFecha - Input: '02/07/2025' (tipo: string)
[01-Oct-2025 23:32:12 UTC] DEBUG formatearFecha - Ya en formato correcto: 02/07/2025
[01-Oct-2025 23:32:13 UTC] ExportService: Creando directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:32:13 UTC] PHP Warning:  mkdir(): Permission denied in /var/www/html/Services/ExportService.php on line 24
[01-Oct-2025 23:32:13 UTC] ExportService: ERROR al crear directorio /var/www/html/Services/../../storage/exports/
[01-Oct-2025 23:32:13 UTC] Acceso a reporte: usuario=1, reporte=informe-por-agencia, filtros={"fecha_desde":"2025-05-01","fecha_hasta":"2025-10-01","agencia_id":3}
